[0m14:38:59.092060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF6E36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF93A1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF93A1D90>]}


============================== 14:38:59.107684 | 20903463-4b82-4a54-b7db-eea3e5aeda22 ==============================
[0m14:38:59.107684 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:38:59.107684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:59.521648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20903463-4b82-4a54-b7db-eea3e5aeda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF96108B0>]}
[0m14:38:59.667610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20903463-4b82-4a54-b7db-eea3e5aeda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF994E4C0>]}
[0m14:38:59.683228 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:38:59.717306 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:38:59.718307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:38:59.720314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20903463-4b82-4a54-b7db-eea3e5aeda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF995CE80>]}
[0m14:39:01.685747 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m14:39:01.685747 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m14:39:01.839139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:39:01.839139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:39:01.839139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:39:01.839139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:39:01.874157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20903463-4b82-4a54-b7db-eea3e5aeda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFA2F5D90>]}
[0m14:39:01.888963 [error] [MainThread]: Encountered an error:
Found a cycle: model.users_project.user_purchases
[0m14:39:01.973712 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 284, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\main.py", line 295, in docs_generate
    results = task.run()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\generate.py", line 211, in run
    compile_results = CompileTask.run(self)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\runnable.py", line 454, in run
    self._runtime_initialize()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\runnable.py", line 143, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\compilation.py", line 455, in compile
    linker.link_graph(manifest)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\compilation.py", line 200, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.users_project.user_purchases

[0m14:39:01.982018 [debug] [MainThread]: Command `dbt docs generate` failed at 14:39:01.982018 after 2.96 seconds
[0m14:39:01.983017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF6E36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF995C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9DFC040>]}
[0m14:39:01.984014 [debug] [MainThread]: Flushing usage events
[0m14:39:19.778945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE94236AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE967D2AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE967B4F40>]}


============================== 14:39:19.778945 | 79b45b72-7eda-4184-a317-5bcba570a811 ==============================
[0m14:39:19.778945 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:39:19.794551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:20.084634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b45b72-7eda-4184-a317-5bcba570a811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE938E9430>]}
[0m14:39:20.240925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b45b72-7eda-4184-a317-5bcba570a811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE96D793D0>]}
[0m14:39:20.240925 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:39:20.240925 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:39:20.337879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:20.337879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:20.337879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b45b72-7eda-4184-a317-5bcba570a811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE97137B20>]}
[0m14:39:20.353588 [error] [MainThread]: Encountered an error:
Found a cycle: model.users_project.user_purchases
[0m14:39:20.353588 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 284, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\main.py", line 371, in compile
    results = task.run()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\runnable.py", line 454, in run
    self._runtime_initialize()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\runnable.py", line 143, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\compilation.py", line 455, in compile
    linker.link_graph(manifest)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\compilation.py", line 200, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.users_project.user_purchases

[0m14:39:20.372706 [debug] [MainThread]: Command `dbt compile` failed at 14:39:20.372706 after 0.66 seconds
[0m14:39:20.373700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE94236AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE96DD6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE96DD6610>]}
[0m14:39:20.375574 [debug] [MainThread]: Flushing usage events
[0m14:43:58.139253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957AB6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A03E640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A03EFA0>]}


============================== 14:43:58.139253 | 10fd9916-18dd-4bad-a1e6-b83f5db30d17 ==============================
[0m14:43:58.139253 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:43:58.139253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:43:58.441112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A0D17F0>]}
[0m14:43:58.586168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A460610>]}
[0m14:43:58.586168 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:43:58.598314 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:43:58.687524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:58.688539 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m14:43:58.892093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295AB66F10>]}
[0m14:43:58.892093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A85DA00>]}
[0m14:43:58.892093 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:43:58.907716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A85DB50>]}
[0m14:43:58.907716 [info ] [MainThread]: 
[0m14:43:58.907716 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:58.915360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m14:43:58.923021 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m14:43:58.923021 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m14:43:58.923021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:58.990758 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:43:58.990758 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m14:43:58.990758 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m14:43:58.998794 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:43:58.998794 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m14:43:59.003635 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m14:43:59.004652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb_userdb, now list_userdb_userdb_staging)
[0m14:43:59.007641 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m14:43:59.008640 [debug] [ThreadPool]: On list_userdb_userdb_staging: BEGIN
[0m14:43:59.009640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:59.036836 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:43:59.036836 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m14:43:59.036836 [debug] [ThreadPool]: On list_userdb_userdb_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb_staging"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb_staging'
  
[0m14:43:59.036836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:43:59.036836 [debug] [ThreadPool]: On list_userdb_userdb_staging: ROLLBACK
[0m14:43:59.036836 [debug] [ThreadPool]: On list_userdb_userdb_staging: Close
[0m14:43:59.036836 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:59.036836 [debug] [MainThread]: On master: BEGIN
[0m14:43:59.036836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:59.083722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:59.084236 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:59.085242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:59.091242 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:43:59.093243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fd9916-18dd-4bad-a1e6-b83f5db30d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A53DB80>]}
[0m14:43:59.094246 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:59.096253 [debug] [MainThread]: On master: Close
[0m14:43:59.097243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:59.098234 [info ] [MainThread]: 
[0m14:43:59.107086 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m14:43:59.107086 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m14:43:59.107086 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m14:43:59.126372 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m14:43:59.126372 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 14:43:59.107086 => 14:43:59.126372
[0m14:43:59.126372 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m14:43:59.126372 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 14:43:59.126372 => 14:43:59.126372
[0m14:43:59.126372 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m14:43:59.126372 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m14:43:59.126372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.products_model, now model.users_project.purchases_model)
[0m14:43:59.126372 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m14:43:59.190247 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m14:43:59.192242 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 14:43:59.126372 => 14:43:59.192242
[0m14:43:59.193259 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m14:43:59.193259 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 14:43:59.193259 => 14:43:59.193259
[0m14:43:59.195247 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m14:43:59.195247 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m14:43:59.196247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.purchases_model, now model.users_project.users_model)
[0m14:43:59.197261 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m14:43:59.200259 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m14:43:59.202241 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 14:43:59.197261 => 14:43:59.202241
[0m14:43:59.203242 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m14:43:59.204247 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 14:43:59.203242 => 14:43:59.203242
[0m14:43:59.205253 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m14:43:59.206248 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m14:43:59.207257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.users_model, now model.users_project.user_purchases)
[0m14:43:59.208262 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m14:43:59.213265 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m14:43:59.215242 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 14:43:59.209257 => 14:43:59.215242
[0m14:43:59.216237 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m14:43:59.216237 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 14:43:59.216237 => 14:43:59.216237
[0m14:43:59.218246 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m14:43:59.219246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:59.220307 [debug] [MainThread]: Connection 'list_userdb_userdb_staging' was properly closed.
[0m14:43:59.220307 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m14:43:59.220307 [debug] [MainThread]: Command end result
[0m14:43:59.220307 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:59.220307 after 1.17 seconds
[0m14:43:59.220307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022957AB6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A9C82B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295A5466D0>]}
[0m14:43:59.220307 [debug] [MainThread]: Flushing usage events
[0m14:49:40.471169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCB9C7AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE14D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE14DCA0>]}


============================== 14:49:40.486781 | a01e3310-a975-4c7b-a687-be13181abe8f ==============================
[0m14:49:40.486781 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:49:40.486781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:40.795542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE1702E0>]}
[0m14:49:40.926645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE4D26A0>]}
[0m14:49:40.926645 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m14:49:40.942270 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:49:41.048870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:41.048870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:41.069424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCEAB6BE0>]}
[0m14:49:41.072430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE7E99D0>]}
[0m14:49:41.073409 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:49:41.074416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE7E9A00>]}
[0m14:49:41.076412 [info ] [MainThread]: 
[0m14:49:41.077407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:41.079416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m14:49:41.086110 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m14:49:41.086110 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m14:49:41.086110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:41.117071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:41.117759 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m14:49:41.117759 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m14:49:41.117759 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:41.117759 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m14:49:41.117759 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m14:49:41.117759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb_userdb, now list_userdb_userdb_staging)
[0m14:49:41.117759 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m14:49:41.117759 [debug] [ThreadPool]: On list_userdb_userdb_staging: BEGIN
[0m14:49:41.117759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:41.134857 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:41.134857 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m14:49:41.134857 [debug] [ThreadPool]: On list_userdb_userdb_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb_staging"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb_staging'
  
[0m14:49:41.150670 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:41.150670 [debug] [ThreadPool]: On list_userdb_userdb_staging: ROLLBACK
[0m14:49:41.150670 [debug] [ThreadPool]: On list_userdb_userdb_staging: Close
[0m14:49:41.150670 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:41.150670 [debug] [MainThread]: On master: BEGIN
[0m14:49:41.150670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:41.197133 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:41.198130 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:41.199130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:41.205142 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:41.206143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01e3310-a975-4c7b-a687-be13181abe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCE6A2A30>]}
[0m14:49:41.207155 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:41.209149 [debug] [MainThread]: On master: Close
[0m14:49:41.211132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:41.211132 [info ] [MainThread]: 
[0m14:49:41.216149 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m14:49:41.217140 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m14:49:41.218197 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m14:49:41.218197 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m14:49:41.218197 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 14:49:41.218197 => 14:49:41.218197
[0m14:49:41.218197 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m14:49:41.218197 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 14:49:41.218197 => 14:49:41.218197
[0m14:49:41.218197 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m14:49:41.218197 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m14:49:41.218197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.products_model, now model.users_project.purchases_model)
[0m14:49:41.218197 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m14:49:41.236848 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m14:49:41.238838 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 14:49:41.218197 => 14:49:41.237835
[0m14:49:41.239840 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m14:49:41.239933 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 14:49:41.239933 => 14:49:41.239933
[0m14:49:41.239933 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m14:49:41.239933 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m14:49:41.239933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.purchases_model, now model.users_project.users_model)
[0m14:49:41.239933 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m14:49:41.239933 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m14:49:41.249725 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 14:49:41.239933 => 14:49:41.249725
[0m14:49:41.250726 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m14:49:41.251722 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 14:49:41.250726 => 14:49:41.250726
[0m14:49:41.252729 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m14:49:41.253722 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m14:49:41.254719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.users_model, now model.users_project.user_purchases)
[0m14:49:41.256523 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m14:49:41.256523 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m14:49:41.256523 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 14:49:41.256523 => 14:49:41.256523
[0m14:49:41.256523 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m14:49:41.256523 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 14:49:41.256523 => 14:49:41.256523
[0m14:49:41.256523 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m14:49:41.267423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:41.268424 [debug] [MainThread]: Connection 'list_userdb_userdb_staging' was properly closed.
[0m14:49:41.268424 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m14:49:41.269281 [debug] [MainThread]: Command end result
[0m14:49:41.506230 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:49:41.506230 [info ] [MainThread]: Building catalog
[0m14:49:41.506230 [debug] [ThreadPool]: Acquiring new postgres connection 'userdb.information_schema'
[0m14:49:41.524052 [debug] [ThreadPool]: Using postgres connection "userdb.information_schema"
[0m14:49:41.525055 [debug] [ThreadPool]: On userdb.information_schema: BEGIN
[0m14:49:41.525055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:41.535472 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:41.535472 [debug] [ThreadPool]: Using postgres connection "userdb.information_schema"
[0m14:49:41.535472 [debug] [ThreadPool]: On userdb.information_schema: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "userdb.information_schema"} */

    
    

    select
        'userdb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('userdb_staging') and
           upper(tbl.relname) = upper('products_model')) or (upper(sch.nspname) = upper('userdb_staging') and
           upper(tbl.relname) = upper('purchases_model')) or (upper(sch.nspname) = upper('userdb_staging') and
           upper(tbl.relname) = upper('user_purchases')) or (upper(sch.nspname) = upper('userdb') and
           upper(tbl.relname) = upper('users_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:49:41.549963 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:49:41.551961 [debug] [ThreadPool]: On userdb.information_schema: ROLLBACK
[0m14:49:41.552526 [debug] [ThreadPool]: On userdb.information_schema: Close
[0m14:49:41.567459 [info ] [MainThread]: Catalog written to C:\Users\raikh\VscodeProjects\dbt_app\users_project\target\catalog.json
[0m14:49:41.569459 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:49:41.569459 after 1.16 seconds
[0m14:49:41.570459 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:49:41.570459 [debug] [MainThread]: Connection 'userdb.information_schema' was properly closed.
[0m14:49:41.571467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCB9C7AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCEB11730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCEB13850>]}
[0m14:49:41.571467 [debug] [MainThread]: Flushing usage events
[0m14:50:27.512909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026897E2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A3BC640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A3BCFA0>]}


============================== 14:50:27.512909 | f5f0117e-1ba3-4113-acaa-970c771d8abe ==============================
[0m14:50:27.512909 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:27.512909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8001', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:27.811925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f0117e-1ba3-4113-acaa-970c771d8abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A44E7F0>]}
[0m14:50:27.968146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f0117e-1ba3-4113-acaa-970c771d8abe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A590F40>]}
[0m14:52:45.115011 [error] [MainThread]: Encountered an error:

[0m14:52:45.175261 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.8_3.8.2800.0_x64__qbz5n2kfra8p0\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.8_3.8.2800.0_x64__qbz5n2kfra8p0\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.8_3.8.2800.0_x64__qbz5n2kfra8p0\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m14:52:45.194427 [debug] [MainThread]: Command `dbt docs serve` failed at 14:52:45.192733 after 137.75 seconds
[0m14:52:45.195451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026897E2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A951250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689A92A310>]}
[0m14:52:45.196451 [debug] [MainThread]: Flushing usage events
[0m15:02:21.934952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F98EDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FBE882B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FBE88CA0>]}


============================== 15:02:21.943774 | 969745ba-e037-435a-ac5d-a57e3b3eabea ==============================
[0m15:02:21.943774 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:02:21.945060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --model user_purchases', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:02:22.352875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FBEBF2E0>]}
[0m15:02:22.527358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC2156A0>]}
[0m15:02:22.529359 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:02:22.541817 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:02:22.679654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:22.680677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:22.686674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC7F5BE0>]}
[0m15:02:22.702723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC732A90>]}
[0m15:02:22.703726 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:02:22.705721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC732B80>]}
[0m15:02:22.706721 [info ] [MainThread]: 
[0m15:02:22.707719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:22.710730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m15:02:22.721444 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m15:02:22.722446 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m15:02:22.722446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:22.772147 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:02:22.774419 [debug] [ThreadPool]: On list_userdb: Close
[0m15:02:22.776419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb, now create_userdb_userdb_staging)
[0m15:02:22.777417 [debug] [ThreadPool]: Creating schema "database: "userdb"
schema: "userdb_staging"
"
[0m15:02:22.783417 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb_staging"
[0m15:02:22.784518 [debug] [ThreadPool]: On create_userdb_userdb_staging: BEGIN
[0m15:02:22.784518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:22.802604 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:22.802604 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb_staging"
[0m15:02:22.803603 [debug] [ThreadPool]: On create_userdb_userdb_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "create_userdb_userdb_staging"} */
create schema if not exists "userdb_staging"
[0m15:02:22.805604 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m15:02:22.806605 [debug] [ThreadPool]: On create_userdb_userdb_staging: COMMIT
[0m15:02:22.807607 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb_staging"
[0m15:02:22.807607 [debug] [ThreadPool]: On create_userdb_userdb_staging: COMMIT
[0m15:02:22.812669 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m15:02:22.813679 [debug] [ThreadPool]: On create_userdb_userdb_staging: Close
[0m15:02:22.815672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb_staging'
[0m15:02:22.822689 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m15:02:22.823692 [debug] [ThreadPool]: On list_userdb_userdb_staging: BEGIN
[0m15:02:22.824691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:22.840414 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:22.841408 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m15:02:22.841408 [debug] [ThreadPool]: On list_userdb_userdb_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb_staging"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb_staging'
  
[0m15:02:22.845413 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:22.847534 [debug] [ThreadPool]: On list_userdb_userdb_staging: ROLLBACK
[0m15:02:22.849408 [debug] [ThreadPool]: On list_userdb_userdb_staging: Close
[0m15:02:22.850408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb_userdb_staging, now list_userdb_userdb)
[0m15:02:22.852996 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:02:22.853994 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m15:02:22.854996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:22.883248 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:22.884248 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:02:22.885238 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m15:02:22.890120 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:22.891130 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m15:02:22.893696 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m15:02:22.899806 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:22.899806 [debug] [MainThread]: On master: BEGIN
[0m15:02:22.900889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:22.934747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:22.935747 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:22.935747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:02:22.940933 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:22.942939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC854190>]}
[0m15:02:22.943930 [debug] [MainThread]: On master: ROLLBACK
[0m15:02:22.945492 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:22.946494 [debug] [MainThread]: On master: BEGIN
[0m15:02:22.949508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:22.950504 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.951496 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:22.951496 [debug] [MainThread]: On master: COMMIT
[0m15:02:22.954114 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:02:22.955117 [debug] [MainThread]: On master: Close
[0m15:02:22.956119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:22.957121 [info ] [MainThread]: 
[0m15:02:22.963262 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m15:02:22.964259 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb_staging.user_purchases ...................... [RUN]
[0m15:02:22.966395 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m15:02:22.966395 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m15:02:22.976979 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m15:02:22.980506 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 15:02:22.967399 => 15:02:22.979511
[0m15:02:22.981514 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m15:02:23.024774 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m15:02:23.028169 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:02:23.029162 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m15:02:23.029162 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:02:23.047333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:02:23.047333 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:02:23.048334 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb_staging"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb_staging"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb_staging"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:02:23.050334 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "userdb.users_model" does not exist
LINE 19:     select * from "userdb"."userdb"."users_model"
                           ^

[0m15:02:23.051335 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m15:02:23.053334 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 15:02:22.981514 => 15:02:23.052335
[0m15:02:23.054332 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m15:02:23.315667 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:02:23.316664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969745ba-e037-435a-ac5d-a57e3b3eabea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC892EE0>]}
[0m15:02:23.317668 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb_staging.user_purchases ............. [[31mERROR[0m in 0.35s]
[0m15:02:23.319669 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m15:02:23.321676 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:23.322674 [debug] [MainThread]: On master: BEGIN
[0m15:02:23.323669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:23.358467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:23.358467 [debug] [MainThread]: On master: COMMIT
[0m15:02:23.359467 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:23.360473 [debug] [MainThread]: On master: COMMIT
[0m15:02:23.361468 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:02:23.362466 [debug] [MainThread]: On master: Close
[0m15:02:23.363463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:23.364466 [debug] [MainThread]: Connection 'create_userdb_userdb_staging' was properly closed.
[0m15:02:23.364466 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m15:02:23.365464 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m15:02:23.366464 [info ] [MainThread]: 
[0m15:02:23.366464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:02:23.368874 [debug] [MainThread]: Command end result
[0m15:02:23.381623 [info ] [MainThread]: 
[0m15:02:23.382624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:23.383623 [info ] [MainThread]: 
[0m15:02:23.384623 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:02:23.385628 [info ] [MainThread]: 
[0m15:02:23.386624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:02:23.389624 [debug] [MainThread]: Command `dbt run` failed at 15:02:23.389624 after 1.54 seconds
[0m15:02:23.390624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F98EDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC3CB220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FC8921C0>]}
[0m15:02:23.391626 [debug] [MainThread]: Flushing usage events
[0m15:47:56.039379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD66ECAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD8C4CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD8C3AF40>]}


============================== 15:47:56.055014 | dbf28282-f6b6-4c88-b39b-127934c086a8 ==============================
[0m15:47:56.055014 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:47:56.055014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:56.665354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD5D89400>]}
[0m15:47:56.806003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD91F3430>]}
[0m15:47:56.821629 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:47:56.821629 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:47:57.623144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:57.623144 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m15:47:57.826056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD9765EB0>]}
[0m15:47:57.857310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD94F19A0>]}
[0m15:47:57.857310 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:47:57.857310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD94F1AF0>]}
[0m15:47:57.857310 [info ] [MainThread]: 
[0m15:47:57.857310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:57.857310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m15:47:57.875150 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m15:47:57.875150 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:57.875150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:57.925900 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:47:57.925900 [debug] [ThreadPool]: On list_userdb: Close
[0m15:47:57.925900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb_staging'
[0m15:47:57.925900 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m15:47:57.942257 [debug] [ThreadPool]: On list_userdb_userdb_staging: BEGIN
[0m15:47:57.942699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:57.959118 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:47:57.959118 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb_staging"
[0m15:47:57.959118 [debug] [ThreadPool]: On list_userdb_userdb_staging: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb_staging"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb_staging'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb_staging'
  
[0m15:47:57.959118 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:47:57.959118 [debug] [ThreadPool]: On list_userdb_userdb_staging: ROLLBACK
[0m15:47:57.959118 [debug] [ThreadPool]: On list_userdb_userdb_staging: Close
[0m15:47:57.975202 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:57.976193 [debug] [MainThread]: On master: BEGIN
[0m15:47:57.976193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:58.004689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:58.004689 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:58.005689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:58.008939 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:47:58.008939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD9765E20>]}
[0m15:47:58.008939 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:58.008939 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:58.008939 [debug] [MainThread]: On master: BEGIN
[0m15:47:58.008939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:58.008939 [debug] [MainThread]: On master: COMMIT
[0m15:47:58.008939 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:58.008939 [debug] [MainThread]: On master: COMMIT
[0m15:47:58.008939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:58.008939 [debug] [MainThread]: On master: Close
[0m15:47:58.024624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:58.024624 [info ] [MainThread]: 
[0m15:47:58.034671 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m15:47:58.034671 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb_staging.user_purchases ...................... [RUN]
[0m15:47:58.034671 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m15:47:58.038406 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m15:47:58.043393 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m15:47:58.043393 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 15:47:58.039406 => 15:47:58.043393
[0m15:47:58.043393 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m15:47:58.144892 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m15:47:58.147901 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:47:58.148885 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m15:47:58.148885 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:47:58.174940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:47:58.174940 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:47:58.174940 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb_staging"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb_staging"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb_staging"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb_staging"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:47:58.190579 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "userdb_staging.users_model" does not exist
LINE 19:     select * from "userdb"."userdb_staging"."users_model"
                           ^

[0m15:47:58.190579 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m15:47:58.190579 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 15:47:58.043393 => 15:47:58.190579
[0m15:47:58.190579 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m15:47:58.284351 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb_staging.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb_staging"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:47:58.284351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbf28282-f6b6-4c88-b39b-127934c086a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD95C9A90>]}
[0m15:47:58.284351 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb_staging.user_purchases ............. [[31mERROR[0m in 0.25s]
[0m15:47:58.284351 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m15:47:58.284351 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:58.284351 [debug] [MainThread]: On master: BEGIN
[0m15:47:58.284351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:58.313708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:47:58.314718 [debug] [MainThread]: On master: COMMIT
[0m15:47:58.314718 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:58.315717 [debug] [MainThread]: On master: COMMIT
[0m15:47:58.316711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:47:58.317718 [debug] [MainThread]: On master: Close
[0m15:47:58.318717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:58.319729 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m15:47:58.320713 [debug] [MainThread]: Connection 'list_userdb_userdb_staging' was properly closed.
[0m15:47:58.321720 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m15:47:58.321720 [info ] [MainThread]: 
[0m15:47:58.323715 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:47:58.324718 [debug] [MainThread]: Command end result
[0m15:47:58.327771 [info ] [MainThread]: 
[0m15:47:58.327771 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:58.327771 [info ] [MainThread]: 
[0m15:47:58.327771 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb_staging.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb_staging"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:47:58.327771 [info ] [MainThread]: 
[0m15:47:58.341763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:47:58.341763 [debug] [MainThread]: Command `dbt run` failed at 15:47:58.341763 after 2.40 seconds
[0m15:47:58.341763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD66ECAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD9A15EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD97ABEB0>]}
[0m15:47:58.341763 [debug] [MainThread]: Flushing usage events
[0m15:49:03.133397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B8D76AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB2CCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB2B0F70>]}


============================== 15:49:03.133397 | 0bd23534-0dba-47f0-8801-5c3fada5ed52 ==============================
[0m15:49:03.133397 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:49:03.133397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:03.441280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B841A430>]}
[0m15:49:03.590349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB7A4160>]}
[0m15:49:03.591347 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:49:03.602330 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:49:03.703793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:49:03.703793 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m15:49:03.703793 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\products_model.sql
[0m15:49:03.703793 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\purchases_model.sql
[0m15:49:03.703793 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m15:49:03.922543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BC0330D0>]}
[0m15:49:03.938152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB9BCA00>]}
[0m15:49:03.938152 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:49:03.938152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB9BCAC0>]}
[0m15:49:03.938152 [info ] [MainThread]: 
[0m15:49:03.938152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:03.938152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m15:49:03.957438 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m15:49:03.958465 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m15:49:03.959447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:03.976312 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:49:03.976312 [debug] [ThreadPool]: On list_userdb: Close
[0m15:49:03.976312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb, now create_userdb_userdb)
[0m15:49:03.987017 [debug] [ThreadPool]: Creating schema "database: "userdb"
schema: "userdb"
"
[0m15:49:03.990272 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb"
[0m15:49:03.990272 [debug] [ThreadPool]: On create_userdb_userdb: BEGIN
[0m15:49:03.990272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:04.020319 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.020319 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb"
[0m15:49:04.021324 [debug] [ThreadPool]: On create_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "create_userdb_userdb"} */
create schema if not exists "userdb"
[0m15:49:04.023316 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m15:49:04.024324 [debug] [ThreadPool]: On create_userdb_userdb: COMMIT
[0m15:49:04.025342 [debug] [ThreadPool]: Using postgres connection "create_userdb_userdb"
[0m15:49:04.025342 [debug] [ThreadPool]: On create_userdb_userdb: COMMIT
[0m15:49:04.029324 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m15:49:04.029324 [debug] [ThreadPool]: On create_userdb_userdb: Close
[0m15:49:04.032335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m15:49:04.039323 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:49:04.040342 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m15:49:04.040342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:04.055417 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.055417 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:49:04.055417 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m15:49:04.071062 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:49:04.071062 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m15:49:04.071062 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m15:49:04.071062 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.071062 [debug] [MainThread]: On master: BEGIN
[0m15:49:04.071062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:04.086678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.102302 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.102302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:04.102302 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:49:04.102302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB8C4460>]}
[0m15:49:04.102302 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:04.102302 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.102302 [debug] [MainThread]: On master: BEGIN
[0m15:49:04.102302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.102302 [debug] [MainThread]: On master: COMMIT
[0m15:49:04.102302 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.117926 [debug] [MainThread]: On master: COMMIT
[0m15:49:04.120797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:04.121814 [debug] [MainThread]: On master: Close
[0m15:49:04.122813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:04.122813 [info ] [MainThread]: 
[0m15:49:04.172168 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m15:49:04.172168 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m15:49:04.172168 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m15:49:04.172168 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m15:49:04.188498 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m15:49:04.188498 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 15:49:04.172168 => 15:49:04.188498
[0m15:49:04.188498 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m15:49:04.222011 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m15:49:04.222011 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:49:04.222011 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m15:49:04.222011 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:49:04.238589 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.238589 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:49:04.238589 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:49:04.254840 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "userdb.users_model" does not exist
LINE 19:     select * from "userdb"."userdb"."users_model"
                           ^

[0m15:49:04.254840 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m15:49:04.254840 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 15:49:04.188498 => 15:49:04.254840
[0m15:49:04.254840 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m15:49:04.254840 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:49:04.254840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd23534-0dba-47f0-8801-5c3fada5ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BAE239D0>]}
[0m15:49:04.254840 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.08s]
[0m15:49:04.254840 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m15:49:04.254840 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.254840 [debug] [MainThread]: On master: BEGIN
[0m15:49:04.254840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:04.304628 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:04.304628 [debug] [MainThread]: On master: COMMIT
[0m15:49:04.305618 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:04.306095 [debug] [MainThread]: On master: COMMIT
[0m15:49:04.306095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:04.306095 [debug] [MainThread]: On master: Close
[0m15:49:04.306095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:04.306095 [debug] [MainThread]: Connection 'create_userdb_userdb' was properly closed.
[0m15:49:04.306095 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m15:49:04.306095 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m15:49:04.306095 [info ] [MainThread]: 
[0m15:49:04.306095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:49:04.306095 [debug] [MainThread]: Command end result
[0m15:49:04.324647 [info ] [MainThread]: 
[0m15:49:04.326655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:04.327739 [info ] [MainThread]: 
[0m15:49:04.327739 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:49:04.327739 [info ] [MainThread]: 
[0m15:49:04.327739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:49:04.327739 [debug] [MainThread]: Command `dbt run` failed at 15:49:04.327739 after 1.27 seconds
[0m15:49:04.327739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188B8D76AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BB7A4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BC060D00>]}
[0m15:49:04.327739 [debug] [MainThread]: Flushing usage events
[0m15:59:29.951887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191754F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019177A45AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019177A3DF70>]}


============================== 15:59:29.967511 | 024048b2-4ff4-45e4-920e-714c30d2b3ff ==============================
[0m15:59:29.967511 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:59:29.967511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:30.329085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019174B9A460>]}
[0m15:59:30.485381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019177F27160>]}
[0m15:59:30.485381 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:59:30.485381 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:59:30.630549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:30.630549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:30.646172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191783F2B50>]}
[0m15:59:30.661794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001917833FA00>]}
[0m15:59:30.661794 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:59:30.661794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001917833FA60>]}
[0m15:59:30.661794 [info ] [MainThread]: 
[0m15:59:30.661794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:30.661794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m15:59:30.680745 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:59:30.680745 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m15:59:30.681744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:30.718584 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:59:30.718584 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:59:30.718584 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m15:59:30.718584 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:59:30.734188 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m15:59:30.735168 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m15:59:30.735168 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:30.735168 [debug] [MainThread]: On master: BEGIN
[0m15:59:30.735168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:30.756779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:30.766159 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:30.766159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:30.772187 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:59:30.774158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024048b2-4ff4-45e4-920e-714c30d2b3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019177F7E370>]}
[0m15:59:30.774158 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:30.777156 [debug] [MainThread]: On master: Close
[0m15:59:30.778159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:30.779161 [info ] [MainThread]: 
[0m15:59:30.787889 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m15:59:30.789909 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m15:59:30.790892 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m15:59:30.798891 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m15:59:30.800886 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 15:59:30.790892 => 15:59:30.799882
[0m15:59:30.801886 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m15:59:30.801886 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 15:59:30.801886 => 15:59:30.801886
[0m15:59:30.803881 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m15:59:30.803881 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m15:59:30.804662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.products_model, now model.users_project.purchases_model)
[0m15:59:30.804662 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m15:59:30.804662 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m15:59:30.804662 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 15:59:30.804662 => 15:59:30.804662
[0m15:59:30.804662 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m15:59:30.804662 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 15:59:30.804662 => 15:59:30.804662
[0m15:59:30.804662 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m15:59:30.804662 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m15:59:30.804662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.purchases_model, now model.users_project.users_model)
[0m15:59:30.804662 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m15:59:30.818977 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m15:59:30.821972 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 15:59:30.804662 => 15:59:30.820977
[0m15:59:30.822191 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m15:59:30.822191 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 15:59:30.822191 => 15:59:30.822191
[0m15:59:30.822191 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m15:59:30.822191 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m15:59:30.822191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.users_model, now model.users_project.user_purchases)
[0m15:59:30.822191 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m15:59:30.822191 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m15:59:30.822191 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 15:59:30.822191 => 15:59:30.822191
[0m15:59:30.833150 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m15:59:30.834145 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 15:59:30.833150 => 15:59:30.833150
[0m15:59:30.835143 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m15:59:30.835853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:30.835853 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m15:59:30.835853 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m15:59:30.835853 [debug] [MainThread]: Command end result
[0m15:59:30.835853 [debug] [MainThread]: Command `dbt compile` succeeded at 15:59:30.835853 after 0.97 seconds
[0m15:59:30.850484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191754F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019177F27160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191783DEFA0>]}
[0m15:59:30.851476 [debug] [MainThread]: Flushing usage events
[0m15:59:50.346462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B72E36A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B753B5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B753B5FD0>]}


============================== 15:59:50.362098 | cea20b23-fac0-470e-b1cc-694d3257f042 ==============================
[0m15:59:50.362098 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:59:50.362098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --model user_purchases', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:50.660168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B7535AB50>]}
[0m15:59:50.816582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75586190>]}
[0m15:59:50.816582 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m15:59:50.816582 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:59:50.909984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:50.909984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:50.915965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75D34BB0>]}
[0m15:59:50.927611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75C67A30>]}
[0m15:59:50.928679 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:59:50.929716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75C67AC0>]}
[0m15:59:50.930778 [info ] [MainThread]: 
[0m15:59:50.931785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:50.931785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m15:59:50.931785 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m15:59:50.931785 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m15:59:50.931785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:50.968971 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:59:50.970785 [debug] [ThreadPool]: On list_userdb: Close
[0m15:59:50.970785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m15:59:50.970785 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:59:50.970785 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m15:59:50.981996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:51.015003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:59:51.016013 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m15:59:51.016013 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m15:59:51.021021 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:59:51.023010 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m15:59:51.026021 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m15:59:51.032009 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.033021 [debug] [MainThread]: On master: BEGIN
[0m15:59:51.033021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:51.079694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:51.079694 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.079694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:51.079694 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:59:51.079694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75D72BB0>]}
[0m15:59:51.079694 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:51.079694 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.079694 [debug] [MainThread]: On master: BEGIN
[0m15:59:51.095326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:51.095755 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.096304 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.096304 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.098372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:51.099381 [debug] [MainThread]: On master: Close
[0m15:59:51.100381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:51.102389 [info ] [MainThread]: 
[0m15:59:51.106690 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m15:59:51.107700 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m15:59:51.108701 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m15:59:51.110694 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m15:59:51.117204 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m15:59:51.117204 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 15:59:51.110694 => 15:59:51.117204
[0m15:59:51.117204 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m15:59:51.151009 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m15:59:51.151009 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:59:51.151009 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m15:59:51.151009 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:59:51.167698 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:59:51.167698 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m15:59:51.167698 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:59:51.184262 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "userdb.users_model" does not exist
LINE 19:     select * from "userdb"."userdb"."users_model"
                           ^

[0m15:59:51.185262 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m15:59:51.188263 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 15:59:51.117204 => 15:59:51.187273
[0m15:59:51.188263 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m15:59:51.196269 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:59:51.197275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea20b23-fac0-470e-b1cc-694d3257f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75DE5DC0>]}
[0m15:59:51.198258 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.09s]
[0m15:59:51.200256 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m15:59:51.202264 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.203262 [debug] [MainThread]: On master: BEGIN
[0m15:59:51.203262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:51.229263 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:59:51.229263 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.230264 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.230264 [debug] [MainThread]: On master: COMMIT
[0m15:59:51.232766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:59:51.232766 [debug] [MainThread]: On master: Close
[0m15:59:51.233770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:51.234762 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m15:59:51.234762 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m15:59:51.235769 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m15:59:51.236759 [info ] [MainThread]: 
[0m15:59:51.238040 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:59:51.238040 [debug] [MainThread]: Command end result
[0m15:59:51.249343 [info ] [MainThread]: 
[0m15:59:51.250728 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:51.250728 [info ] [MainThread]: 
[0m15:59:51.250728 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.users_model" does not exist
  LINE 19:     select * from "userdb"."userdb"."users_model"
                             ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m15:59:51.250728 [info ] [MainThread]: 
[0m15:59:51.250728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:51.250728 [debug] [MainThread]: Command `dbt run` failed at 15:59:51.250728 after 0.97 seconds
[0m15:59:51.250728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B72E36A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75D72820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B75C67100>]}
[0m15:59:51.250728 [debug] [MainThread]: Flushing usage events
[0m16:01:09.183301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4DC36AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A501CEAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A501BAF70>]}


============================== 16:01:09.183301 | 52d55f26-f6f2-4b95-aaa6-24ced133fccc ==============================
[0m16:01:09.183301 [info ] [MainThread]: Running with dbt=1.7.2
[0m16:01:09.183301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --model users_model', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:01:09.492742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4D2E9430>]}
[0m16:01:09.638696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5064A160>]}
[0m16:01:09.638696 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m16:01:09.638696 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m16:01:09.727231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:09.727231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:09.727231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50B35B50>]}
[0m16:01:09.742896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50A67A00>]}
[0m16:01:09.749421 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:01:09.750460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50A67A60>]}
[0m16:01:09.751507 [info ] [MainThread]: 
[0m16:01:09.752551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:09.754586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m16:01:09.754586 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m16:01:09.754586 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m16:01:09.754586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:09.783714 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:01:09.783714 [debug] [ThreadPool]: On list_userdb: Close
[0m16:01:09.795830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m16:01:09.796789 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m16:01:09.796789 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m16:01:09.796789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:09.812181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:01:09.826915 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m16:01:09.827834 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m16:01:09.827834 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:01:09.827834 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m16:01:09.827834 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m16:01:09.843956 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:09.843956 [debug] [MainThread]: On master: BEGIN
[0m16:01:09.845133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:09.873973 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:09.874969 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:09.874969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:09.881968 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:01:09.883964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50A670A0>]}
[0m16:01:09.883964 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:09.886439 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:09.886439 [debug] [MainThread]: On master: BEGIN
[0m16:01:09.889470 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:09.889470 [debug] [MainThread]: On master: COMMIT
[0m16:01:09.890474 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:09.890474 [debug] [MainThread]: On master: COMMIT
[0m16:01:09.892830 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:09.893731 [debug] [MainThread]: On master: Close
[0m16:01:09.894746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:09.895741 [info ] [MainThread]: 
[0m16:01:09.900392 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m16:01:09.901393 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.users_model ................................. [RUN]
[0m16:01:09.902393 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.users_model'
[0m16:01:09.904389 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m16:01:09.914139 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m16:01:09.916013 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 16:01:09.904389 => 16:01:09.915143
[0m16:01:09.916013 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m16:01:09.946829 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.users_model"
[0m16:01:09.946829 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m16:01:09.946829 [debug] [Thread-1  ]: On model.users_project.users_model: BEGIN
[0m16:01:09.946829 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:01:09.976915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:01:09.976915 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m16:01:09.977921 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */

  create view "userdb"."userdb"."users_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select u.user_id, u.first_name, u.last_name, ph.mobile, cr.model, cr.price
    from users
    inner join user_phones ph on u.user_id = ph.user_id
    inner join user_cars cr on u.user_id = cr.user_id

), trans_data as (

    select source_data.user_id, CONCAT(source_data.first_name, '  ', source_data.last_name) as username, 
            CONCAT('mobile ', ' ' , source_data.mobile) as userphone, CONCAT('car ', ' ', source_data.model)
    from source_data        
)

select * from trans_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:01:09.980927 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "u"
LINE 21:     inner join user_phones ph on u.user_id = ph.user_id
                                          ^

[0m16:01:09.981921 [debug] [Thread-1  ]: On model.users_project.users_model: ROLLBACK
[0m16:01:09.983922 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 16:01:09.916013 => 16:01:09.983922
[0m16:01:09.984923 [debug] [Thread-1  ]: On model.users_project.users_model: Close
[0m16:01:09.989917 [debug] [Thread-1  ]: Database Error in model users_model (models\example\users_model.sql)
  missing FROM-clause entry for table "u"
  LINE 21:     inner join user_phones ph on u.user_id = ph.user_id
                                            ^
  compiled Code at target\run\users_project\models\example\users_model.sql
[0m16:01:09.990915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d55f26-f6f2-4b95-aaa6-24ced133fccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50BBBAC0>]}
[0m16:01:09.990915 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.users_model ........................ [[31mERROR[0m in 0.09s]
[0m16:01:09.993915 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m16:01:09.995914 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:09.995914 [debug] [MainThread]: On master: BEGIN
[0m16:01:09.996914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:10.010531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:10.010531 [debug] [MainThread]: On master: COMMIT
[0m16:01:10.010531 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:10.026162 [debug] [MainThread]: On master: COMMIT
[0m16:01:10.026994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:10.028019 [debug] [MainThread]: On master: Close
[0m16:01:10.029026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:10.030004 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m16:01:10.030004 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m16:01:10.031007 [debug] [MainThread]: Connection 'model.users_project.users_model' was properly closed.
[0m16:01:10.031007 [info ] [MainThread]: 
[0m16:01:10.032155 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m16:01:10.032155 [debug] [MainThread]: Command end result
[0m16:01:10.044165 [info ] [MainThread]: 
[0m16:01:10.046158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:01:10.046158 [info ] [MainThread]: 
[0m16:01:10.046158 [error] [MainThread]:   Database Error in model users_model (models\example\users_model.sql)
  missing FROM-clause entry for table "u"
  LINE 21:     inner join user_phones ph on u.user_id = ph.user_id
                                            ^
  compiled Code at target\run\users_project\models\example\users_model.sql
[0m16:01:10.046158 [info ] [MainThread]: 
[0m16:01:10.046158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:01:10.046158 [debug] [MainThread]: Command `dbt run` failed at 16:01:10.046158 after 0.94 seconds
[0m16:01:10.046158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4DC36AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A506DC8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50A67B50>]}
[0m16:01:10.046158 [debug] [MainThread]: Flushing usage events
[0m17:17:50.983915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E454FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E6CEA670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E6CEAFD0>]}


============================== 17:17:50.983915 | 163a3928-4d7c-4e43-b0cf-3db568b62b4a ==============================
[0m17:17:50.983915 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:17:50.999540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model users_model', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:51.400273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E6C9AB50>]}
[0m17:17:51.558259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E6ECE190>]}
[0m17:17:51.559259 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:17:51.571270 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:17:51.713268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:51.714272 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m17:17:51.927267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E7828F40>]}
[0m17:17:51.941267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E71A7A30>]}
[0m17:17:51.942260 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:17:51.943250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E71A7AC0>]}
[0m17:17:51.945253 [info ] [MainThread]: 
[0m17:17:51.947374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:51.949396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:17:51.960396 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:17:51.961392 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:17:51.961392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:52.006390 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:17:52.008387 [debug] [ThreadPool]: On list_userdb: Close
[0m17:17:52.012388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:17:52.019387 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:17:52.019387 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:17:52.020387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:52.052393 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:17:52.053396 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:17:52.053396 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:17:52.058390 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:17:52.059409 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:17:52.061392 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:17:52.067408 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.067408 [debug] [MainThread]: On master: BEGIN
[0m17:17:52.068410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:52.099388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:52.100388 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.100388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:52.106393 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:17:52.108385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E7828FD0>]}
[0m17:17:52.109396 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:52.112390 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.112390 [debug] [MainThread]: On master: BEGIN
[0m17:17:52.115389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:52.116389 [debug] [MainThread]: On master: COMMIT
[0m17:17:52.116389 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.117397 [debug] [MainThread]: On master: COMMIT
[0m17:17:52.119407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:52.119407 [debug] [MainThread]: On master: Close
[0m17:17:52.121393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:52.122390 [info ] [MainThread]: 
[0m17:17:52.129390 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m17:17:52.130386 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.users_model ................................. [RUN]
[0m17:17:52.131388 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.users_model'
[0m17:17:52.132394 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m17:17:52.143392 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m17:17:52.145388 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 17:17:52.133394 => 17:17:52.145388
[0m17:17:52.146390 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m17:17:52.235407 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.users_model"
[0m17:17:52.237407 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m17:17:52.238390 [debug] [Thread-1  ]: On model.users_project.users_model: BEGIN
[0m17:17:52.239399 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:17:52.273417 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:17:52.273417 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m17:17:52.273417 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */

  create view "userdb"."userdb"."users_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select u.user_id, u.first_name, u.last_name, ph.mobile, cr.model, cr.price
    from users u
    inner join user_phones ph on u.user_id = ph.user_id
    inner join user_cars cr on u.user_id = cr.user_id

), trans_data as (

    select source_data.user_id, CONCAT(source_data.first_name, '  ', source_data.last_name) as username, 
            CONCAT('mobile ', ' ' , source_data.mobile) as userphone, CONCAT('car ', ' ', source_data.model)
    from source_data        
)

select * from trans_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:17:52.273417 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:17:52.273417 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m17:17:52.273417 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */
alter table "userdb"."userdb"."users_model__dbt_tmp" rename to "users_model"
[0m17:17:52.289145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:52.304678 [debug] [Thread-1  ]: On model.users_project.users_model: COMMIT
[0m17:17:52.304678 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m17:17:52.304678 [debug] [Thread-1  ]: On model.users_project.users_model: COMMIT
[0m17:17:52.304678 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:17:52.304678 [debug] [Thread-1  ]: Applying DROP to: "userdb"."userdb"."users_model__dbt_backup"
[0m17:17:52.320466 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m17:17:52.320466 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */
drop view if exists "userdb"."userdb"."users_model__dbt_backup" cascade
[0m17:17:52.320466 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:52.320466 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 17:17:52.146390 => 17:17:52.320466
[0m17:17:52.320466 [debug] [Thread-1  ]: On model.users_project.users_model: Close
[0m17:17:52.320466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '163a3928-4d7c-4e43-b0cf-3db568b62b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E74834C0>]}
[0m17:17:52.320466 [info ] [Thread-1  ]: 1 of 1 OK created sql view model userdb.users_model ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m17:17:52.320466 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m17:17:52.320466 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.335924 [debug] [MainThread]: On master: BEGIN
[0m17:17:52.335924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:52.359193 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:52.359193 [debug] [MainThread]: On master: COMMIT
[0m17:17:52.359193 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:52.359193 [debug] [MainThread]: On master: COMMIT
[0m17:17:52.359193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:52.359193 [debug] [MainThread]: On master: Close
[0m17:17:52.359193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:52.359193 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:17:52.359193 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:17:52.359193 [debug] [MainThread]: Connection 'model.users_project.users_model' was properly closed.
[0m17:17:52.359193 [info ] [MainThread]: 
[0m17:17:52.374820 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m17:17:52.376315 [debug] [MainThread]: Command end result
[0m17:17:52.376315 [info ] [MainThread]: 
[0m17:17:52.376315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:52.376315 [info ] [MainThread]: 
[0m17:17:52.391686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:17:52.392640 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:52.392640 after 1.48 seconds
[0m17:17:52.392640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E454FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E74852E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224E7483160>]}
[0m17:17:52.392640 [debug] [MainThread]: Flushing usage events
[0m17:44:17.805002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196BEAF6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C104CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C1035F70>]}


============================== 17:44:17.814001 | 786d4d12-72a3-4d75-8d19-aecf7f263819 ==============================
[0m17:44:17.814001 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:44:17.815000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model user_purchases', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:18.184430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196BE19A430>]}
[0m17:44:18.337309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C151E160>]}
[0m17:44:18.339310 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:44:18.351289 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:44:18.532448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:18.533452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:18.539448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C19F5B50>]}
[0m17:44:18.553449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C1927A00>]}
[0m17:44:18.554453 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:44:18.555453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C1927A60>]}
[0m17:44:18.557450 [info ] [MainThread]: 
[0m17:44:18.558452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:18.560450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:44:18.571448 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:44:18.572451 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:44:18.573453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:18.619451 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:44:18.621451 [debug] [ThreadPool]: On list_userdb: Close
[0m17:44:18.624451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:44:18.630450 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:44:18.631453 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:44:18.632456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:18.662074 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:18.663073 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:44:18.663073 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:44:18.668069 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:44:18.669064 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:44:18.671066 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:44:18.678068 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.679071 [debug] [MainThread]: On master: BEGIN
[0m17:44:18.679071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:18.708207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:18.709218 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.709218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:18.716227 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:44:18.717228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C19270A0>]}
[0m17:44:18.718218 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:18.720672 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.720672 [debug] [MainThread]: On master: BEGIN
[0m17:44:18.723770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:18.723770 [debug] [MainThread]: On master: COMMIT
[0m17:44:18.724792 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.724792 [debug] [MainThread]: On master: COMMIT
[0m17:44:18.727039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:18.728039 [debug] [MainThread]: On master: Close
[0m17:44:18.729028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:18.730034 [info ] [MainThread]: 
[0m17:44:18.737028 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m17:44:18.737028 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m17:44:18.739048 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m17:44:18.740021 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m17:44:18.749022 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m17:44:18.751728 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 17:44:18.740021 => 17:44:18.750710
[0m17:44:18.752731 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m17:44:18.791748 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m17:44:18.794645 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:44:18.795644 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m17:44:18.795644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:44:18.832339 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:44:18.833335 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:44:18.834334 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:44:18.837334 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "userdb.purchases_model" does not exist
LINE 27:     inner join "userdb"."userdb"."purchases_model" up on s.u...
                        ^

[0m17:44:18.837334 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m17:44:18.839296 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 17:44:18.752731 => 17:44:18.839296
[0m17:44:18.840330 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m17:44:18.856219 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.purchases_model" does not exist
  LINE 27:     inner join "userdb"."userdb"."purchases_model" up on s.u...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:44:18.856219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '786d4d12-72a3-4d75-8d19-aecf7f263819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C1A83250>]}
[0m17:44:18.857221 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.12s]
[0m17:44:18.860229 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m17:44:18.862452 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.862452 [debug] [MainThread]: On master: BEGIN
[0m17:44:18.863449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:18.897465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:18.898456 [debug] [MainThread]: On master: COMMIT
[0m17:44:18.899459 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:18.899459 [debug] [MainThread]: On master: COMMIT
[0m17:44:18.901456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:18.902462 [debug] [MainThread]: On master: Close
[0m17:44:18.903465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:18.903465 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:44:18.904473 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:44:18.904473 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m17:44:18.905455 [info ] [MainThread]: 
[0m17:44:18.906455 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:44:18.907456 [debug] [MainThread]: Command end result
[0m17:44:18.918455 [info ] [MainThread]: 
[0m17:44:18.919460 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:44:18.920466 [info ] [MainThread]: 
[0m17:44:18.921464 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  relation "userdb.purchases_model" does not exist
  LINE 27:     inner join "userdb"."userdb"."purchases_model" up on s.u...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:44:18.923463 [info ] [MainThread]: 
[0m17:44:18.924462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:44:18.926463 [debug] [MainThread]: Command `dbt run` failed at 17:44:18.926463 after 1.20 seconds
[0m17:44:18.927466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196BEAF6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C151E160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196C19272E0>]}
[0m17:44:18.927466 [debug] [MainThread]: Flushing usage events
[0m17:44:55.748183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F7B6CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA10CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA0FCF70>]}


============================== 17:44:55.748183 | 5b5e8e3a-a30f-4eb6-98a9-22a475e59730 ==============================
[0m17:44:55.748183 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:44:55.763784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --model user_purchases', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:56.062894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b5e8e3a-a30f-4eb6-98a9-22a475e59730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F7229430>]}
[0m17:44:56.203497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b5e8e3a-a30f-4eb6-98a9-22a475e59730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA59B160>]}
[0m17:44:56.203497 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:44:56.203497 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:44:56.294869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:56.294869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:56.294869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b5e8e3a-a30f-4eb6-98a9-22a475e59730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FAA75B50>]}
[0m17:44:56.310504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b5e8e3a-a30f-4eb6-98a9-22a475e59730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA7BCA00>]}
[0m17:44:56.310504 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:44:56.310504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5e8e3a-a30f-4eb6-98a9-22a475e59730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA7BCA60>]}
[0m17:44:56.310504 [info ] [MainThread]: 
[0m17:44:56.310504 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:44:56.310504 [debug] [MainThread]: Command end result
[0m17:44:56.330446 [debug] [MainThread]: Command `dbt test` succeeded at 17:44:56.330446 after 0.65 seconds
[0m17:44:56.330446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F7B6CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA59B160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6FA60E070>]}
[0m17:44:56.330446 [debug] [MainThread]: Flushing usage events
[0m17:45:37.933593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022629C36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C1BA640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C1BAFA0>]}


============================== 17:45:37.937591 | 1d71c1f4-7b72-42ca-b682-b1e0f4de770e ==============================
[0m17:45:37.937591 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:45:37.938594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --model products_model', 'send_anonymous_usage_stats': 'True'}
[0m17:45:38.231050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C2487F0>]}
[0m17:45:38.379359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C3E2610>]}
[0m17:45:38.379359 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:45:38.379359 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:45:38.470259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:38.471262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:38.477504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262CB33B80>]}
[0m17:45:38.477504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262CA67A00>]}
[0m17:45:38.477504 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:45:38.477504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262CA67A90>]}
[0m17:45:38.493132 [info ] [MainThread]: 
[0m17:45:38.493132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:38.493132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:45:38.493132 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:45:38.508761 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:45:38.508761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:38.531842 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:45:38.531842 [debug] [ThreadPool]: On list_userdb: Close
[0m17:45:38.531842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:45:38.543602 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:45:38.544603 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:45:38.544603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:38.575559 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:38.576564 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:45:38.577563 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:45:38.582581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:45:38.583564 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:45:38.586393 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:45:38.592389 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.593397 [debug] [MainThread]: On master: BEGIN
[0m17:45:38.593397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:38.609538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:38.609538 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.609538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:38.609538 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:45:38.609538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C6E31F0>]}
[0m17:45:38.609538 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:38.609538 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.609538 [debug] [MainThread]: On master: BEGIN
[0m17:45:38.625236 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:38.625236 [debug] [MainThread]: On master: COMMIT
[0m17:45:38.625236 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.625236 [debug] [MainThread]: On master: COMMIT
[0m17:45:38.625236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:38.625236 [debug] [MainThread]: On master: Close
[0m17:45:38.625236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:38.625236 [info ] [MainThread]: 
[0m17:45:38.625236 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m17:45:38.625236 [info ] [Thread-1  ]: 1 of 1 START sql table model userdb.products_model ............................. [RUN]
[0m17:45:38.625236 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m17:45:38.640778 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m17:45:38.646133 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m17:45:38.646133 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 17:45:38.640778 => 17:45:38.646133
[0m17:45:38.646133 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m17:45:38.692665 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.products_model"
[0m17:45:38.694092 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m17:45:38.694092 [debug] [Thread-1  ]: On model.users_project.products_model: BEGIN
[0m17:45:38.694092 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:45:38.710274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:38.725533 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m17:45:38.725533 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */

  
    

  create  table "userdb"."userdb"."products_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models





with source_data as (
    select
    
        product_id,
        item,
        price
    from products    
)


select * from source_data
  );
  
[0m17:45:38.726727 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.0 seconds
[0m17:45:38.726727 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m17:45:38.726727 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */
alter table "userdb"."userdb"."products_model__dbt_tmp" rename to "products_model"
[0m17:45:38.744223 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:38.763233 [debug] [Thread-1  ]: On model.users_project.products_model: COMMIT
[0m17:45:38.764238 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m17:45:38.764238 [debug] [Thread-1  ]: On model.users_project.products_model: COMMIT
[0m17:45:38.768222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:38.775234 [debug] [Thread-1  ]: Applying DROP to: "userdb"."userdb"."products_model__dbt_backup"
[0m17:45:38.777420 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m17:45:38.777420 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */
drop table if exists "userdb"."userdb"."products_model__dbt_backup" cascade
[0m17:45:38.777420 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:45:38.777420 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 17:45:38.646133 => 17:45:38.777420
[0m17:45:38.777420 [debug] [Thread-1  ]: On model.users_project.products_model: Close
[0m17:45:38.777420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d71c1f4-7b72-42ca-b682-b1e0f4de770e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262CBB84C0>]}
[0m17:45:38.777420 [info ] [Thread-1  ]: 1 of 1 OK created sql table model userdb.products_model ........................ [[32mSELECT 4[0m in 0.15s]
[0m17:45:38.777420 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m17:45:38.777420 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.777420 [debug] [MainThread]: On master: BEGIN
[0m17:45:38.777420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:38.815481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:38.815481 [debug] [MainThread]: On master: COMMIT
[0m17:45:38.815481 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:38.815481 [debug] [MainThread]: On master: COMMIT
[0m17:45:38.826552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:38.827543 [debug] [MainThread]: On master: Close
[0m17:45:38.828220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:38.828220 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:45:38.828220 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:45:38.828220 [debug] [MainThread]: Connection 'model.users_project.products_model' was properly closed.
[0m17:45:38.828220 [info ] [MainThread]: 
[0m17:45:38.828220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:45:38.828220 [debug] [MainThread]: Command end result
[0m17:45:38.845360 [info ] [MainThread]: 
[0m17:45:38.845360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:38.845360 [info ] [MainThread]: 
[0m17:45:38.845360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:38.845360 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:38.845360 after 0.99 seconds
[0m17:45:38.845360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022629C36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C3E2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262CB33F10>]}
[0m17:45:38.845360 [debug] [MainThread]: Flushing usage events
[0m17:45:59.485038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265737D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026575F35670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026575F35FD0>]}


============================== 17:45:59.485038 | f593dbc3-12db-4948-ac06-270ce616092d ==============================
[0m17:45:59.485038 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:45:59.485038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model purchases_model', 'send_anonymous_usage_stats': 'True'}
[0m17:45:59.773892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026575EDAB50>]}
[0m17:45:59.930172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576314190>]}
[0m17:45:59.930172 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:45:59.930172 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:46:00.025673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:00.025673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:00.025673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265768F4BB0>]}
[0m17:46:00.041305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576827A30>]}
[0m17:46:00.041305 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:46:00.041305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576827AC0>]}
[0m17:46:00.041305 [info ] [MainThread]: 
[0m17:46:00.041305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:46:00.041305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:46:00.063497 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:46:00.063497 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:46:00.063497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:00.091885 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:46:00.093377 [debug] [ThreadPool]: On list_userdb: Close
[0m17:46:00.093377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:46:00.093377 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:46:00.093377 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:46:00.093377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:00.110051 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:46:00.124248 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:46:00.124248 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:46:00.129268 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:46:00.131267 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:46:00.133267 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:46:00.140267 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.140267 [debug] [MainThread]: On master: BEGIN
[0m17:46:00.141250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:00.158341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:00.174399 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.174975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:00.174975 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:46:00.174975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576933BB0>]}
[0m17:46:00.174975 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:00.174975 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.174975 [debug] [MainThread]: On master: BEGIN
[0m17:46:00.174975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:00.174975 [debug] [MainThread]: On master: COMMIT
[0m17:46:00.174975 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.190626 [debug] [MainThread]: On master: COMMIT
[0m17:46:00.192305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:00.192305 [debug] [MainThread]: On master: Close
[0m17:46:00.193297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:00.194294 [info ] [MainThread]: 
[0m17:46:00.199305 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m17:46:00.200313 [info ] [Thread-1  ]: 1 of 1 START sql table model userdb.purchases_model ............................ [RUN]
[0m17:46:00.201305 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.purchases_model'
[0m17:46:00.202315 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m17:46:00.211634 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m17:46:00.213460 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 17:46:00.202315 => 17:46:00.212647
[0m17:46:00.213460 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m17:46:00.244256 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.purchases_model"
[0m17:46:00.257852 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m17:46:00.258852 [debug] [Thread-1  ]: On model.users_project.purchases_model: BEGIN
[0m17:46:00.259858 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:46:00.288317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:46:00.289315 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m17:46:00.289315 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */

  
    

  create  table "userdb"."userdb"."purchases_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models





with source_data as (
    select
        purchase_id,
        product_id,
        user_id,
        count,
        dt as purchase_date,
        st as purchase_state
    from user_purchases    
)


select * from source_data
  );
  
[0m17:46:00.298125 [debug] [Thread-1  ]: SQL status: SELECT 11 in 0.0 seconds
[0m17:46:00.305282 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m17:46:00.306143 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */
alter table "userdb"."userdb"."purchases_model__dbt_tmp" rename to "purchases_model"
[0m17:46:00.309135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:46:00.325217 [debug] [Thread-1  ]: On model.users_project.purchases_model: COMMIT
[0m17:46:00.325217 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m17:46:00.325217 [debug] [Thread-1  ]: On model.users_project.purchases_model: COMMIT
[0m17:46:00.325217 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:46:00.325217 [debug] [Thread-1  ]: Applying DROP to: "userdb"."userdb"."purchases_model__dbt_backup"
[0m17:46:00.340973 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m17:46:00.340973 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */
drop table if exists "userdb"."userdb"."purchases_model__dbt_backup" cascade
[0m17:46:00.340973 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:46:00.340973 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 17:46:00.213460 => 17:46:00.340973
[0m17:46:00.340973 [debug] [Thread-1  ]: On model.users_project.purchases_model: Close
[0m17:46:00.340973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f593dbc3-12db-4948-ac06-270ce616092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002657694C880>]}
[0m17:46:00.340973 [info ] [Thread-1  ]: 1 of 1 OK created sql table model userdb.purchases_model ....................... [[32mSELECT 11[0m in 0.14s]
[0m17:46:00.340973 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m17:46:00.340973 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.340973 [debug] [MainThread]: On master: BEGIN
[0m17:46:00.340973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:00.379151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:00.379151 [debug] [MainThread]: On master: COMMIT
[0m17:46:00.379151 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:00.379151 [debug] [MainThread]: On master: COMMIT
[0m17:46:00.379151 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:00.379151 [debug] [MainThread]: On master: Close
[0m17:46:00.391912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:00.392900 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:46:00.393455 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:46:00.393455 [debug] [MainThread]: Connection 'model.users_project.purchases_model' was properly closed.
[0m17:46:00.393455 [info ] [MainThread]: 
[0m17:46:00.393455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:46:00.393455 [debug] [MainThread]: Command end result
[0m17:46:00.407560 [info ] [MainThread]: 
[0m17:46:00.409563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:00.409790 [info ] [MainThread]: 
[0m17:46:00.409790 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:46:00.409790 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:00.409790 after 1.00 seconds
[0m17:46:00.409790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265737D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002657645FA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576454BB0>]}
[0m17:46:00.409790 [debug] [MainThread]: Flushing usage events
[0m17:46:12.831249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C31A96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5950A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C593DF10>]}


============================== 17:46:12.831249 | cdac43f8-409b-4666-bcd0-d525307c6d41 ==============================
[0m17:46:12.831249 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:46:12.831249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --model user_purchases', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:13.121755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdac43f8-409b-4666-bcd0-d525307c6d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C58DAA90>]}
[0m17:46:13.279408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdac43f8-409b-4666-bcd0-d525307c6d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5DCAB20>]}
[0m17:46:13.279408 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:46:13.279408 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:46:13.367483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:13.367483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:13.373540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdac43f8-409b-4666-bcd0-d525307c6d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C62B5AF0>]}
[0m17:46:13.373540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdac43f8-409b-4666-bcd0-d525307c6d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5FFB9A0>]}
[0m17:46:13.373540 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:46:13.373540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdac43f8-409b-4666-bcd0-d525307c6d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5FFBA00>]}
[0m17:46:13.373540 [info ] [MainThread]: 
[0m17:46:13.373540 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:46:13.389176 [debug] [MainThread]: Command end result
[0m17:46:13.389176 [debug] [MainThread]: Command `dbt test` succeeded at 17:46:13.389176 after 0.64 seconds
[0m17:46:13.399883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C31A96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5ED2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C5DB2EB0>]}
[0m17:46:13.400930 [debug] [MainThread]: Flushing usage events
[0m17:46:26.862396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2AB86A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D2F5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D2F5FD0>]}


============================== 17:46:26.878022 | 6c91eb27-6861-499c-8d20-0b546e63ce0f ==============================
[0m17:46:26.878022 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:46:26.878022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model user_purchases', 'send_anonymous_usage_stats': 'True'}
[0m17:46:27.184591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D29AB50>]}
[0m17:46:27.317836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D6C9190>]}
[0m17:46:27.317836 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:46:27.333461 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:46:27.422204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:27.422204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:27.422204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2DC74BB0>]}
[0m17:46:27.437806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D9A7A30>]}
[0m17:46:27.437806 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:46:27.437806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D9A7AC0>]}
[0m17:46:27.437806 [info ] [MainThread]: 
[0m17:46:27.437806 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:46:27.437806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:46:27.458263 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:46:27.458263 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:46:27.459249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:27.473295 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:46:27.473295 [debug] [ThreadPool]: On list_userdb: Close
[0m17:46:27.473295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:46:27.490128 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:46:27.490128 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:46:27.490128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:27.507872 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:46:27.507872 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:46:27.507872 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:46:27.523749 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:46:27.523749 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:46:27.523749 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:46:27.523749 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.523749 [debug] [MainThread]: On master: BEGIN
[0m17:46:27.539615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:27.568611 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:27.568611 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.569614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:27.573699 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:46:27.573699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2DCB3BB0>]}
[0m17:46:27.573699 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:27.573699 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.573699 [debug] [MainThread]: On master: BEGIN
[0m17:46:27.573699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:27.573699 [debug] [MainThread]: On master: COMMIT
[0m17:46:27.573699 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.573699 [debug] [MainThread]: On master: COMMIT
[0m17:46:27.573699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:27.589326 [debug] [MainThread]: On master: Close
[0m17:46:27.589326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:27.589326 [info ] [MainThread]: 
[0m17:46:27.589326 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m17:46:27.589326 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m17:46:27.589326 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m17:46:27.599374 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m17:46:27.608915 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m17:46:27.610912 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 17:46:27.599374 => 17:46:27.609920
[0m17:46:27.610912 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m17:46:27.642320 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m17:46:27.642320 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:46:27.642320 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m17:46:27.642320 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:46:27.657942 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:46:27.657942 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:46:27.657942 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:46:27.674048 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.usercar does not exist
LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                        ^
HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".

[0m17:46:27.675055 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m17:46:27.677045 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 17:46:27.612108 => 17:46:27.677045
[0m17:46:27.678059 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m17:46:27.682059 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column s.usercar does not exist
  LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                          ^
  HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:46:27.683052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c91eb27-6861-499c-8d20-0b546e63ce0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2DD33B80>]}
[0m17:46:27.684073 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.09s]
[0m17:46:27.685046 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m17:46:27.687051 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.688053 [debug] [MainThread]: On master: BEGIN
[0m17:46:27.688053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:27.705049 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:27.705049 [debug] [MainThread]: On master: COMMIT
[0m17:46:27.706194 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:27.706194 [debug] [MainThread]: On master: COMMIT
[0m17:46:27.708206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:27.709199 [debug] [MainThread]: On master: Close
[0m17:46:27.710877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:27.710877 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:46:27.710877 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:46:27.710877 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m17:46:27.710877 [info ] [MainThread]: 
[0m17:46:27.710877 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:46:27.710877 [debug] [MainThread]: Command end result
[0m17:46:27.725621 [info ] [MainThread]: 
[0m17:46:27.725621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:27.725621 [info ] [MainThread]: 
[0m17:46:27.725621 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column s.usercar does not exist
  LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                          ^
  HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:46:27.725621 [info ] [MainThread]: 
[0m17:46:27.725621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:46:27.725621 [debug] [MainThread]: Command `dbt run` failed at 17:46:27.725621 after 0.93 seconds
[0m17:46:27.725621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2AB86A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2D6C9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F2DC7E220>]}
[0m17:46:27.725621 [debug] [MainThread]: Flushing usage events
[0m17:48:29.564429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F7376A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F98BD670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F98BDFD0>]}


============================== 17:48:29.572429 | cc005b92-d58e-4c5b-b99e-989e7efa3afb ==============================
[0m17:48:29.572429 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:48:29.573439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:29.941955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F985AB50>]}
[0m17:48:30.088933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F9C83190>]}
[0m17:48:30.090936 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:48:30.101934 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:48:30.225412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:30.225412 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m17:48:30.434636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA3E8F40>]}
[0m17:48:30.446639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA167A30>]}
[0m17:48:30.447638 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:48:30.448644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA167AC0>]}
[0m17:48:30.449636 [info ] [MainThread]: 
[0m17:48:30.452645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:30.454644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:48:30.465657 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:48:30.465657 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:48:30.466654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:30.508638 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:48:30.510638 [debug] [ThreadPool]: On list_userdb: Close
[0m17:48:30.513646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:48:30.520653 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:48:30.521661 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:48:30.521661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:30.563062 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:48:30.564069 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:48:30.564069 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:48:30.568099 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:48:30.570120 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:48:30.573283 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:48:30.580308 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.580308 [debug] [MainThread]: On master: BEGIN
[0m17:48:30.581306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:30.607613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:48:30.607613 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.608614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:30.614689 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:48:30.617612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA3E8FD0>]}
[0m17:48:30.617612 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:30.619613 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.620610 [debug] [MainThread]: On master: BEGIN
[0m17:48:30.623621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:48:30.624611 [debug] [MainThread]: On master: COMMIT
[0m17:48:30.624611 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.625619 [debug] [MainThread]: On master: COMMIT
[0m17:48:30.627622 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:48:30.628614 [debug] [MainThread]: On master: Close
[0m17:48:30.629611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:30.631620 [info ] [MainThread]: 
[0m17:48:30.639282 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m17:48:30.639282 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m17:48:30.641283 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m17:48:30.642293 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m17:48:30.652301 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m17:48:30.653289 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 17:48:30.642293 => 17:48:30.653289
[0m17:48:30.654280 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m17:48:30.742301 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m17:48:30.744538 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:48:30.745284 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m17:48:30.745284 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:48:30.781287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:48:30.782291 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:48:30.783292 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select * from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:48:30.786282 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.usercar does not exist
LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                        ^
HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".

[0m17:48:30.786282 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m17:48:30.789290 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 17:48:30.654280 => 17:48:30.788290
[0m17:48:30.790290 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m17:48:30.798281 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column s.usercar does not exist
  LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                          ^
  HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:48:30.799287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc005b92-d58e-4c5b-b99e-989e7efa3afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA24CF10>]}
[0m17:48:30.800287 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.16s]
[0m17:48:30.801136 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m17:48:30.803166 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.804167 [debug] [MainThread]: On master: BEGIN
[0m17:48:30.804167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:30.843925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:48:30.844906 [debug] [MainThread]: On master: COMMIT
[0m17:48:30.845906 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:30.845906 [debug] [MainThread]: On master: COMMIT
[0m17:48:30.847916 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:48:30.848916 [debug] [MainThread]: On master: Close
[0m17:48:30.849908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:30.850908 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:48:30.850908 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:48:30.851917 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m17:48:30.852915 [info ] [MainThread]: 
[0m17:48:30.853907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:48:30.854906 [debug] [MainThread]: Command end result
[0m17:48:30.866925 [info ] [MainThread]: 
[0m17:48:30.868910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:30.870512 [info ] [MainThread]: 
[0m17:48:30.871546 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column s.usercar does not exist
  LINE 23:     select s.username, s.user_id, s.userphone, s.usercar, up...
                                                          ^
  HINT:  Perhaps you meant to reference the column "s.user_id" or the column "s.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:48:30.873536 [info ] [MainThread]: 
[0m17:48:30.874536 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:30.876533 [debug] [MainThread]: Command `dbt run` failed at 17:48:30.876533 after 1.40 seconds
[0m17:48:30.877525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F7376A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F9C83190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295FA698940>]}
[0m17:48:30.878533 [debug] [MainThread]: Flushing usage events
[0m17:50:04.751909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D22536AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D24ACCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D24ABDF70>]}


============================== 17:50:04.761855 | e2019f45-4e02-42e3-85ff-6a5a3c311a51 ==============================
[0m17:50:04.761855 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:50:04.763863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model user_purchases', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:05.050300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D21BE9430>]}
[0m17:50:05.206722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D24F5E160>]}
[0m17:50:05.206722 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:50:05.222188 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:50:05.357205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:05.357205 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m17:50:05.575955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D255EEEE0>]}
[0m17:50:05.575955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D253679D0>]}
[0m17:50:05.575955 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:50:05.575955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D25367B20>]}
[0m17:50:05.591592 [info ] [MainThread]: 
[0m17:50:05.591592 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:05.591592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m17:50:05.591592 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m17:50:05.591592 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m17:50:05.591592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.626990 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:50:05.626990 [debug] [ThreadPool]: On list_userdb: Close
[0m17:50:05.626990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:50:05.644221 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:50:05.644221 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:50:05.644221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.660672 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:50:05.660672 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:50:05.660672 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:50:05.660672 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:50:05.660672 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:50:05.676240 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:50:05.677224 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.677224 [debug] [MainThread]: On master: BEGIN
[0m17:50:05.677224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:05.706073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:05.706073 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.707073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:05.713066 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:50:05.715065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D255EEE50>]}
[0m17:50:05.716086 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:05.718084 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.718084 [debug] [MainThread]: On master: BEGIN
[0m17:50:05.721073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:05.721073 [debug] [MainThread]: On master: COMMIT
[0m17:50:05.722073 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.722073 [debug] [MainThread]: On master: COMMIT
[0m17:50:05.724064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:05.725065 [debug] [MainThread]: On master: Close
[0m17:50:05.726064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:05.727127 [info ] [MainThread]: 
[0m17:50:05.727127 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m17:50:05.727127 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m17:50:05.727127 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m17:50:05.734027 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m17:50:05.744869 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m17:50:05.746858 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 17:50:05.734027 => 17:50:05.745864
[0m17:50:05.746858 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m17:50:05.836675 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m17:50:05.838687 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:50:05.839675 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m17:50:05.840674 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:50:05.858740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:50:05.858740 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m17:50:05.858740 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone, usercar from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:50:05.874342 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "usercar" does not exist
LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                  ^
HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".

[0m17:50:05.874342 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m17:50:05.874342 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 17:50:05.747866 => 17:50:05.874342
[0m17:50:05.874342 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m17:50:05.874342 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:50:05.874342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2019f45-4e02-42e3-85ff-6a5a3c311a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D254432B0>]}
[0m17:50:05.874342 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.15s]
[0m17:50:05.874342 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m17:50:05.874342 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.874342 [debug] [MainThread]: On master: BEGIN
[0m17:50:05.889958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:05.912285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:05.912285 [debug] [MainThread]: On master: COMMIT
[0m17:50:05.912285 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.912285 [debug] [MainThread]: On master: COMMIT
[0m17:50:05.912285 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:05.912285 [debug] [MainThread]: On master: Close
[0m17:50:05.912285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:05.912285 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m17:50:05.926264 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:50:05.927310 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m17:50:05.927310 [info ] [MainThread]: 
[0m17:50:05.927310 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:50:05.927310 [debug] [MainThread]: Command end result
[0m17:50:05.927310 [info ] [MainThread]: 
[0m17:50:05.927310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:05.943887 [info ] [MainThread]: 
[0m17:50:05.943987 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m17:50:05.943987 [info ] [MainThread]: 
[0m17:50:05.943987 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:05.943987 [debug] [MainThread]: Command `dbt run` failed at 17:50:05.943987 after 1.27 seconds
[0m17:50:05.943987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D22536AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D24F5E160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D25817760>]}
[0m17:50:05.943987 [debug] [MainThread]: Flushing usage events
[0m17:51:51.403941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98A4F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98CA90AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98CA74F70>]}


============================== 17:51:51.403941 | 23e481ab-5285-4b18-9a2a-8de5092fd184 ==============================
[0m17:51:51.403941 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:51:51.403941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:51.726376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B989BAA460>]}
[0m17:51:51.866988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98CF23190>]}
[0m17:51:51.866988 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m17:51:51.882633 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m17:51:51.976591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:51.976591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:51.982591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98D3F3B50>]}
[0m17:51:51.988648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98D33FA00>]}
[0m17:51:51.988648 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:51:51.988648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98D33FAF0>]}
[0m17:51:51.988648 [info ] [MainThread]: 
[0m17:51:51.988648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:51.988648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m17:51:52.010506 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:51:52.010506 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m17:51:52.010506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:52.043280 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:52.053215 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m17:51:52.053215 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m17:51:52.055607 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:51:52.055607 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m17:51:52.055607 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m17:51:52.055607 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:52.055607 [debug] [MainThread]: On master: BEGIN
[0m17:51:52.070710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:52.088418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:52.089425 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:52.090425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:52.095436 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:51:52.097436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e481ab-5285-4b18-9a2a-8de5092fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98CF7E250>]}
[0m17:51:52.098425 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:52.100436 [debug] [MainThread]: On master: Close
[0m17:51:52.101425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:52.102420 [info ] [MainThread]: 
[0m17:51:52.107440 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m17:51:52.108428 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m17:51:52.109432 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m17:51:52.117429 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m17:51:52.118446 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 17:51:52.109432 => 17:51:52.118446
[0m17:51:52.120120 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 17:51:52.120120 => 17:51:52.120120
[0m17:51:52.120120 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.products_model, now model.users_project.purchases_model)
[0m17:51:52.120120 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m17:51:52.120120 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 17:51:52.120120 => 17:51:52.120120
[0m17:51:52.120120 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 17:51:52.120120 => 17:51:52.120120
[0m17:51:52.120120 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m17:51:52.120120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.purchases_model, now model.users_project.users_model)
[0m17:51:52.120120 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m17:51:52.139618 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m17:51:52.141601 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 17:51:52.135746 => 17:51:52.140618
[0m17:51:52.142176 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m17:51:52.142176 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 17:51:52.142176 => 17:51:52.142176
[0m17:51:52.142176 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m17:51:52.142176 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m17:51:52.142176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.users_model, now model.users_project.user_purchases)
[0m17:51:52.142176 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m17:51:52.142176 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m17:51:52.154822 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 17:51:52.142176 => 17:51:52.153820
[0m17:51:52.155946 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m17:51:52.155946 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 17:51:52.155946 => 17:51:52.155946
[0m17:51:52.155946 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m17:51:52.155946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:52.155946 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m17:51:52.155946 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m17:51:52.155946 [debug] [MainThread]: Command end result
[0m17:51:52.172134 [debug] [MainThread]: Command `dbt compile` succeeded at 17:51:52.172134 after 0.83 seconds
[0m17:51:52.172134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98A4F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98CF23190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98D3DEFA0>]}
[0m17:51:52.172134 [debug] [MainThread]: Flushing usage events
[0m17:54:34.987564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1EEF6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2143F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2143FDF0>]}


============================== 17:54:34.987564 | c0fe292a-8e87-4f46-a179-30f8419bc9c9 ==============================
[0m17:54:34.987564 [info ] [MainThread]: Running with dbt=1.7.2
[0m17:54:35.003021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:54:35.171648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0fe292a-8e87-4f46-a179-30f8419bc9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2143F4C0>]}
[0m17:54:35.196980 [debug] [MainThread]: Command `dbt clean` succeeded at 17:54:35.195973 after 0.27 seconds
[0m17:54:35.196980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1EEF6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B21559100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2150F730>]}
[0m17:54:35.197980 [debug] [MainThread]: Flushing usage events
[0m18:05:16.505360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FE9B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98114DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98113AF70>]}


============================== 18:05:16.520975 | eea94c61-b485-46b6-afd2-3a5113bc27e0 ==============================
[0m18:05:16.520975 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:05:16.520975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:16.912948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FE26A430>]}
[0m18:05:17.053554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9815F4160>]}
[0m18:05:17.069183 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:05:17.069183 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:05:17.069183 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:05:17.069183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98171C460>]}
[0m18:05:18.159859 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:05:18.159859 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:05:18.323943 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:05:18.323943 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:05:18.323943 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:05:18.323943 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:05:18.370494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9822B4CD0>]}
[0m18:05:18.389495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F981654250>]}
[0m18:05:18.391350 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:05:18.391350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F981595FA0>]}
[0m18:05:18.391350 [info ] [MainThread]: 
[0m18:05:18.391350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:18.391350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:05:18.411697 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:05:18.411697 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:05:18.411697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:18.458695 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:05:18.458695 [debug] [ThreadPool]: On list_userdb: Close
[0m18:05:18.458695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:05:18.473262 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:05:18.474232 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:05:18.475240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:18.502829 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:05:18.502829 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:05:18.503857 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:05:18.507852 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:05:18.509852 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:05:18.512113 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:05:18.518093 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.518093 [debug] [MainThread]: On master: BEGIN
[0m18:05:18.519095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:18.538482 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:18.538482 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.538482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:18.554112 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:05:18.554112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9822AB2E0>]}
[0m18:05:18.554112 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:18.554112 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.554112 [debug] [MainThread]: On master: BEGIN
[0m18:05:18.554112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:18.554112 [debug] [MainThread]: On master: COMMIT
[0m18:05:18.554112 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.554112 [debug] [MainThread]: On master: COMMIT
[0m18:05:18.554112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:05:18.554112 [debug] [MainThread]: On master: Close
[0m18:05:18.554112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:18.554112 [info ] [MainThread]: 
[0m18:05:18.569746 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:05:18.569746 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:05:18.569746 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:05:18.578699 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:05:18.583685 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:05:18.591938 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:05:18.579697 => 18:05:18.591938
[0m18:05:18.592935 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:05:18.625477 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:05:18.625477 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:05:18.625477 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:05:18.625477 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:05:18.671936 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:05:18.672942 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:05:18.672942 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone, usercar from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:05:18.675938 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "usercar" does not exist
LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                  ^
HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".

[0m18:05:18.676953 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m18:05:18.679657 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:05:18.592935 => 18:05:18.678614
[0m18:05:18.679657 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:05:18.689705 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:05:18.689705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea94c61-b485-46b6-afd2-3a5113bc27e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9823993A0>]}
[0m18:05:18.689705 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.12s]
[0m18:05:18.689705 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:05:18.689705 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.689705 [debug] [MainThread]: On master: BEGIN
[0m18:05:18.689705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:18.711260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:05:18.711260 [debug] [MainThread]: On master: COMMIT
[0m18:05:18.711260 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:18.711260 [debug] [MainThread]: On master: COMMIT
[0m18:05:18.721845 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:05:18.722860 [debug] [MainThread]: On master: Close
[0m18:05:18.724633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:18.724633 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:05:18.724633 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:05:18.724633 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:05:18.724633 [info ] [MainThread]: 
[0m18:05:18.724633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:05:18.724633 [debug] [MainThread]: Command end result
[0m18:05:18.741862 [info ] [MainThread]: 
[0m18:05:18.741862 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:18.741862 [info ] [MainThread]: 
[0m18:05:18.741862 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:05:18.741862 [info ] [MainThread]: 
[0m18:05:18.741862 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:05:18.741862 [debug] [MainThread]: Command `dbt run` failed at 18:05:18.741862 after 2.31 seconds
[0m18:05:18.741862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FE9B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9815F4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F981654400>]}
[0m18:05:18.741862 [debug] [MainThread]: Flushing usage events
[0m18:15:58.414373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775C0B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775E60CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775E5FAF70>]}


============================== 18:15:58.414373 | a761c3bb-3ca2-477b-a2cf-49e92f61673e ==============================
[0m18:15:58.414373 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:15:58.429999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model user_purchases', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:15:58.823686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775B74A430>]}
[0m18:15:58.979942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EAA4160>]}
[0m18:15:58.979942 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:15:58.979942 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:15:59.246394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:59.246394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:59.246394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EF76B50>]}
[0m18:15:59.262019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EEAFA00>]}
[0m18:15:59.262019 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:15:59.262019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EEAFAF0>]}
[0m18:15:59.262019 [info ] [MainThread]: 
[0m18:15:59.277640 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:59.279710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:15:59.290708 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:15:59.291708 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:15:59.292708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:59.338707 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:15:59.339710 [debug] [ThreadPool]: On list_userdb: Close
[0m18:15:59.342713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:15:59.349708 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:15:59.349708 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:15:59.350714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:59.366711 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:15:59.367712 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:15:59.367712 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:15:59.371707 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:15:59.373706 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:15:59.374709 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:15:59.381707 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.382708 [debug] [MainThread]: On master: BEGIN
[0m18:15:59.383712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:59.420007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:59.421012 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.421012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:15:59.428012 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:15:59.429006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EEAF0A0>]}
[0m18:15:59.430008 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:59.432094 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.433140 [debug] [MainThread]: On master: BEGIN
[0m18:15:59.436139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:59.437121 [debug] [MainThread]: On master: COMMIT
[0m18:15:59.437121 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.438120 [debug] [MainThread]: On master: COMMIT
[0m18:15:59.440083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:15:59.440083 [debug] [MainThread]: On master: Close
[0m18:15:59.442190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:59.443124 [info ] [MainThread]: 
[0m18:15:59.451281 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:15:59.452279 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:15:59.454276 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:15:59.454276 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:15:59.464294 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:15:59.467277 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:15:59.455270 => 18:15:59.466272
[0m18:15:59.468274 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:15:59.506299 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:15:59.508522 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:15:59.509300 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:15:59.509300 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:15:59.542481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:15:59.543490 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:15:59.543490 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone, usercar from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:15:59.547081 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "usercar" does not exist
LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                  ^
HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".

[0m18:15:59.547081 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m18:15:59.550076 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:15:59.469284 => 18:15:59.549089
[0m18:15:59.551085 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:15:59.560655 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:15:59.560655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a761c3bb-3ca2-477b-a2cf-49e92f61673e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EFFA7F0>]}
[0m18:15:59.561682 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.11s]
[0m18:15:59.563671 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:15:59.566674 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.566674 [debug] [MainThread]: On master: BEGIN
[0m18:15:59.567672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:59.605662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:15:59.606665 [debug] [MainThread]: On master: COMMIT
[0m18:15:59.606665 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:59.607665 [debug] [MainThread]: On master: COMMIT
[0m18:15:59.609662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:15:59.609662 [debug] [MainThread]: On master: Close
[0m18:15:59.610665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:59.611667 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:15:59.611667 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:15:59.612665 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:15:59.612665 [info ] [MainThread]: 
[0m18:15:59.613664 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:15:59.615664 [debug] [MainThread]: Command end result
[0m18:15:59.628666 [info ] [MainThread]: 
[0m18:15:59.630667 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:15:59.631666 [info ] [MainThread]: 
[0m18:15:59.632664 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:15:59.633666 [info ] [MainThread]: 
[0m18:15:59.635667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:15:59.637662 [debug] [MainThread]: Command `dbt run` failed at 18:15:59.636665 after 1.30 seconds
[0m18:15:59.637662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775C0B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EAA4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EB6C730>]}
[0m18:15:59.638665 [debug] [MainThread]: Flushing usage events
[0m18:16:37.340903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF4111AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF668CAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6669F40>]}


============================== 18:16:37.344925 | 39398976-bc6f-408c-b904-aeac688d1475 ==============================
[0m18:16:37.344925 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:16:37.345926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model user_purchases', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:37.655914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF37C9400>]}
[0m18:16:37.806904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6E3D3D0>]}
[0m18:16:37.808908 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:16:37.818923 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:16:37.924934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:37.925945 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m18:16:38.142926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF71A7EB0>]}
[0m18:16:38.154928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6F2E9A0>]}
[0m18:16:38.154928 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:16:38.155940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6F2EAF0>]}
[0m18:16:38.158944 [info ] [MainThread]: 
[0m18:16:38.159933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:38.161936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:16:38.172945 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:16:38.173946 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:16:38.174945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:38.196933 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:16:38.198937 [debug] [ThreadPool]: On list_userdb: Close
[0m18:16:38.201939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:16:38.209952 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:16:38.209952 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:16:38.210952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:38.239858 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:16:38.239858 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:16:38.240857 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:16:38.244860 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:16:38.246857 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:16:38.248870 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:16:38.255868 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.256873 [debug] [MainThread]: On master: BEGIN
[0m18:16:38.256873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:38.282654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:38.282654 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.282654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:38.282654 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:16:38.282654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF71A7E20>]}
[0m18:16:38.282654 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:38.298302 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.298302 [debug] [MainThread]: On master: BEGIN
[0m18:16:38.298302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:38.298302 [debug] [MainThread]: On master: COMMIT
[0m18:16:38.298302 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.298302 [debug] [MainThread]: On master: COMMIT
[0m18:16:38.298302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:38.298302 [debug] [MainThread]: On master: Close
[0m18:16:38.298302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:38.298302 [info ] [MainThread]: 
[0m18:16:38.313915 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:16:38.313915 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:16:38.313915 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:16:38.317904 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:16:38.322427 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:16:38.322427 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:16:38.317904 => 18:16:38.322427
[0m18:16:38.322427 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:16:38.418147 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:16:38.420371 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:16:38.421133 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:16:38.421133 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:16:38.463539 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:16:38.463539 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:16:38.463539 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone, usercar from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, s.usercar, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:16:38.463539 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "usercar" does not exist
LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                  ^
HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".

[0m18:16:38.463539 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m18:16:38.463539 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:16:38.322427 => 18:16:38.463539
[0m18:16:38.463539 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:16:38.463539 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:16:38.463539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39398976-bc6f-408c-b904-aeac688d1475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF700CE80>]}
[0m18:16:38.463539 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.15s]
[0m18:16:38.463539 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:16:38.479173 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.479173 [debug] [MainThread]: On master: BEGIN
[0m18:16:38.479173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:38.508974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:38.509979 [debug] [MainThread]: On master: COMMIT
[0m18:16:38.509979 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:38.510979 [debug] [MainThread]: On master: COMMIT
[0m18:16:38.511977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:38.512979 [debug] [MainThread]: On master: Close
[0m18:16:38.513980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:38.513980 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:16:38.515097 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:16:38.515097 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:16:38.515097 [info ] [MainThread]: 
[0m18:16:38.515097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:16:38.515097 [debug] [MainThread]: Command end result
[0m18:16:38.515097 [info ] [MainThread]: 
[0m18:16:38.530724 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:16:38.531105 [info ] [MainThread]: 
[0m18:16:38.532374 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:16:38.532374 [info ] [MainThread]: 
[0m18:16:38.532374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:16:38.532374 [debug] [MainThread]: Command `dbt run` failed at 18:16:38.532374 after 1.28 seconds
[0m18:16:38.532374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF4111AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF71E9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF71DF700>]}
[0m18:16:38.532374 [debug] [MainThread]: Flushing usage events
[0m18:17:01.262317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63F986AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64210CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6420EAF70>]}


============================== 18:17:01.262317 | 319bd9f8-6527-4735-9b44-8bcc1ce21ad3 ==============================
[0m18:17:01.262317 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:17:01.277947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model user_purchases', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:17:01.560393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63F249430>]}
[0m18:17:01.723008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64259E160>]}
[0m18:17:01.723008 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:17:01.723008 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:17:01.844604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:01.844604 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m18:17:02.063285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A642E37EE0>]}
[0m18:17:02.063285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6427A79D0>]}
[0m18:17:02.063285 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:17:02.063285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6427A7B20>]}
[0m18:17:02.078912 [info ] [MainThread]: 
[0m18:17:02.078912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:02.078912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:17:02.078912 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:17:02.078912 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:17:02.094570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:02.114318 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:17:02.114318 [debug] [ThreadPool]: On list_userdb: Close
[0m18:17:02.114318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:17:02.114318 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:17:02.114318 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:17:02.114318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:02.147809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:02.147809 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:17:02.147809 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:17:02.147809 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:17:02.147809 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:17:02.147809 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:17:02.164217 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.164217 [debug] [MainThread]: On master: BEGIN
[0m18:17:02.164217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:02.193160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:02.194160 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.194160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:02.201171 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:17:02.203160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A642E37E50>]}
[0m18:17:02.203160 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:02.206171 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.206171 [debug] [MainThread]: On master: BEGIN
[0m18:17:02.209161 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:02.210160 [debug] [MainThread]: On master: COMMIT
[0m18:17:02.210160 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.210160 [debug] [MainThread]: On master: COMMIT
[0m18:17:02.212149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:02.213160 [debug] [MainThread]: On master: Close
[0m18:17:02.214223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:02.214223 [info ] [MainThread]: 
[0m18:17:02.214223 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:17:02.214223 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:17:02.214223 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:17:02.224273 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:17:02.234510 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:17:02.234510 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:17:02.224273 => 18:17:02.234510
[0m18:17:02.234510 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:17:02.326292 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:17:02.328279 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:17:02.329271 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:17:02.329271 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:17:02.347070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:02.347070 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:17:02.347070 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone, usercar from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:17:02.362674 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "usercar" does not exist
LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                  ^
HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".

[0m18:17:02.362674 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m18:17:02.362674 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:17:02.234510 => 18:17:02.362674
[0m18:17:02.362674 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:17:02.362674 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:17:02.362674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319bd9f8-6527-4735-9b44-8bcc1ce21ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A642A83310>]}
[0m18:17:02.362674 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.15s]
[0m18:17:02.362674 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:17:02.378316 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.378316 [debug] [MainThread]: On master: BEGIN
[0m18:17:02.378316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:02.407487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:02.408497 [debug] [MainThread]: On master: COMMIT
[0m18:17:02.408497 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:02.409486 [debug] [MainThread]: On master: COMMIT
[0m18:17:02.411497 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:02.411497 [debug] [MainThread]: On master: Close
[0m18:17:02.412486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:02.413558 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:17:02.413558 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:17:02.413558 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:17:02.413558 [info ] [MainThread]: 
[0m18:17:02.413558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:17:02.413558 [debug] [MainThread]: Command end result
[0m18:17:02.430893 [info ] [MainThread]: 
[0m18:17:02.430893 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:17:02.430893 [info ] [MainThread]: 
[0m18:17:02.430893 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "usercar" does not exist
  LINE 19:     select username, user_id, userphone, usercar from "userd...
                                                    ^
  HINT:  Perhaps you meant to reference the column "users_model.user_id" or the column "users_model.username".
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:17:02.430893 [info ] [MainThread]: 
[0m18:17:02.430893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:17:02.430893 [debug] [MainThread]: Command `dbt run` failed at 18:17:02.430893 after 1.24 seconds
[0m18:17:02.430893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63F986AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64259E160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A642E57760>]}
[0m18:17:02.430893 [debug] [MainThread]: Flushing usage events
[0m18:17:51.072168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0CF86A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F6F8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F6F8FD0>]}


============================== 18:17:51.087792 | f1acdd88-935d-4e41-9143-7667be2c3c98 ==============================
[0m18:17:51.087792 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:17:51.087792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --model user_purchases', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:51.386409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F69AB50>]}
[0m18:17:51.533145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FAC3190>]}
[0m18:17:51.533145 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:17:51.548770 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:17:51.645237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:51.645237 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m18:17:51.856219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B10437F40>]}
[0m18:17:51.871827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FDA7970>]}
[0m18:17:51.871827 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:17:51.871827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FDA7C40>]}
[0m18:17:51.871827 [info ] [MainThread]: 
[0m18:17:51.871827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:51.871827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:17:51.889050 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:17:51.890059 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:17:51.890059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:51.911754 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:17:51.911754 [debug] [ThreadPool]: On list_userdb: Close
[0m18:17:51.911754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:17:51.911754 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:17:51.911754 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:17:51.926826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:51.945480 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:51.960043 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:17:51.960043 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:17:51.960961 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:17:51.960961 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:17:51.960961 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:17:51.960961 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:51.977210 [debug] [MainThread]: On master: BEGIN
[0m18:17:51.977210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:52.006754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:52.007745 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.008744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:52.010819 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:17:52.010819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FDA7130>]}
[0m18:17:52.010819 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:52.010819 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.010819 [debug] [MainThread]: On master: BEGIN
[0m18:17:52.010819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:52.010819 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.010819 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.010819 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.026459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:52.026459 [debug] [MainThread]: On master: Close
[0m18:17:52.026459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:52.026459 [info ] [MainThread]: 
[0m18:17:52.026459 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:17:52.026459 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:17:52.035958 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:17:52.036962 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:17:52.046361 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:17:52.048347 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:17:52.036962 => 18:17:52.047352
[0m18:17:52.049185 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:17:52.136486 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:17:52.138471 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:17:52.138471 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:17:52.139471 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:17:52.159062 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:17:52.159062 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:17:52.159062 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY userspent) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:17:52.174661 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "userspent" does not exist
LINE 24: ...K() OVER (PARTITION BY up.purchase_state ORDER BY userspent)...
                                                              ^

[0m18:17:52.174661 [debug] [Thread-1  ]: On model.users_project.user_purchases: ROLLBACK
[0m18:17:52.174661 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:17:52.049185 => 18:17:52.174661
[0m18:17:52.174661 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:17:52.174661 [debug] [Thread-1  ]: Database Error in model user_purchases (models\example\user_purchases.sql)
  column "userspent" does not exist
  LINE 24: ...K() OVER (PARTITION BY up.purchase_state ORDER BY userspent)...
                                                                ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:17:52.174661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1acdd88-935d-4e41-9143-7667be2c3c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B10083370>]}
[0m18:17:52.174661 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model userdb.user_purchases ..................... [[31mERROR[0m in 0.15s]
[0m18:17:52.174661 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:17:52.174661 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.190297 [debug] [MainThread]: On master: BEGIN
[0m18:17:52.190297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:52.212252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:52.212252 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.212252 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.212252 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.212252 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:52.212252 [debug] [MainThread]: On master: Close
[0m18:17:52.226777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:52.227865 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:17:52.227865 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:17:52.227865 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:17:52.227865 [info ] [MainThread]: 
[0m18:17:52.227865 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:17:52.227865 [debug] [MainThread]: Command end result
[0m18:17:52.244963 [info ] [MainThread]: 
[0m18:17:52.244963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:17:52.244963 [info ] [MainThread]: 
[0m18:17:52.244963 [error] [MainThread]:   Database Error in model user_purchases (models\example\user_purchases.sql)
  column "userspent" does not exist
  LINE 24: ...K() OVER (PARTITION BY up.purchase_state ORDER BY userspent)...
                                                                ^
  compiled Code at target\run\users_project\models\example\user_purchases.sql
[0m18:17:52.244963 [info ] [MainThread]: 
[0m18:17:52.244963 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:17:52.244963 [debug] [MainThread]: Command `dbt run` failed at 18:17:52.244963 after 1.24 seconds
[0m18:17:52.244963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0CF86A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0FAC3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1044FAF0>]}
[0m18:17:52.244963 [debug] [MainThread]: Flushing usage events
[0m18:18:19.056217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113382DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135D812B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135D81CA0>]}


============================== 18:18:19.060216 | 4199f98b-2462-442c-aeee-79011ff65a3d ==============================
[0m18:18:19.060216 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:18:19.062218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model user_purchases', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:18:19.361232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135DBE310>]}
[0m18:18:19.511233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211361146A0>]}
[0m18:18:19.512233 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:18:19.524215 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:18:19.639269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:19.640272 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\user_purchases.sql
[0m18:18:19.846273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021136AA8EE0>]}
[0m18:18:19.857275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021136627A60>]}
[0m18:18:19.858280 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:18:19.859280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021136627BB0>]}
[0m18:18:19.860272 [info ] [MainThread]: 
[0m18:18:19.862272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:18:19.864278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:18:19.875287 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:18:19.876288 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:18:19.877278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:19.900270 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:18:19.901272 [debug] [ThreadPool]: On list_userdb: Close
[0m18:18:19.904279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:18:19.912268 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:18:19.912268 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:18:19.913267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:19.928779 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:18:19.929785 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:18:19.929785 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:18:19.934781 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:18:19.936796 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:18:19.939757 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:18:19.946811 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:19.946811 [debug] [MainThread]: On master: BEGIN
[0m18:18:19.947803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:19.975440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:19.976436 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:19.976436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:19.982632 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m18:18:19.984633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211361AC7C0>]}
[0m18:18:19.985653 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:19.987816 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:19.988795 [debug] [MainThread]: On master: BEGIN
[0m18:18:19.991795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:19.991795 [debug] [MainThread]: On master: COMMIT
[0m18:18:19.992795 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:19.992795 [debug] [MainThread]: On master: COMMIT
[0m18:18:19.995807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:19.995807 [debug] [MainThread]: On master: Close
[0m18:18:19.997797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:19.998800 [info ] [MainThread]: 
[0m18:18:20.003653 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases
[0m18:18:20.004674 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases .............................. [RUN]
[0m18:18:20.006658 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases'
[0m18:18:20.007654 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases
[0m18:18:20.017655 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases"
[0m18:18:20.018657 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (compile): 18:18:20.007654 => 18:18:20.018657
[0m18:18:20.019657 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases
[0m18:18:20.107671 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases"
[0m18:18:20.109657 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:18:20.109657 [debug] [Thread-1  ]: On model.users_project.user_purchases: BEGIN
[0m18:18:20.110655 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:18:20.150658 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:18:20.151657 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:18:20.151657 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */

  create view "userdb"."userdb"."user_purchases__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:18:20.155657 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:18:20.162672 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:18:20.163678 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */
alter table "userdb"."userdb"."user_purchases__dbt_tmp" rename to "user_purchases"
[0m18:18:20.166659 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:20.181671 [debug] [Thread-1  ]: On model.users_project.user_purchases: COMMIT
[0m18:18:20.182676 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:18:20.182676 [debug] [Thread-1  ]: On model.users_project.user_purchases: COMMIT
[0m18:18:20.188488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:18:20.195485 [debug] [Thread-1  ]: Applying DROP to: "userdb"."userdb"."user_purchases__dbt_backup"
[0m18:18:20.200485 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases"
[0m18:18:20.201487 [debug] [Thread-1  ]: On model.users_project.user_purchases: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases"} */
drop view if exists "userdb"."userdb"."user_purchases__dbt_backup" cascade
[0m18:18:20.203493 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:18:20.205485 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases (execute): 18:18:20.020656 => 18:18:20.205485
[0m18:18:20.206484 [debug] [Thread-1  ]: On model.users_project.user_purchases: Close
[0m18:18:20.207485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4199f98b-2462-442c-aeee-79011ff65a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211366BA310>]}
[0m18:18:20.208487 [info ] [Thread-1  ]: 1 of 1 OK created sql view model userdb.user_purchases ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m18:18:20.209492 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases
[0m18:18:20.211486 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:20.212491 [debug] [MainThread]: On master: BEGIN
[0m18:18:20.212491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:20.246493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:20.247491 [debug] [MainThread]: On master: COMMIT
[0m18:18:20.248489 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:20.248489 [debug] [MainThread]: On master: COMMIT
[0m18:18:20.250492 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:20.250492 [debug] [MainThread]: On master: Close
[0m18:18:20.252485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:20.252485 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:18:20.253488 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:18:20.254492 [debug] [MainThread]: Connection 'model.users_project.user_purchases' was properly closed.
[0m18:18:20.255483 [info ] [MainThread]: 
[0m18:18:20.256487 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m18:18:20.257489 [debug] [MainThread]: Command end result
[0m18:18:20.268492 [info ] [MainThread]: 
[0m18:18:20.269486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:20.270503 [info ] [MainThread]: 
[0m18:18:20.271492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:18:20.273497 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:20.272503 after 1.29 seconds
[0m18:18:20.273497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113382DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211366EB820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211366E0AC0>]}
[0m18:18:20.274493 [debug] [MainThread]: Flushing usage events
[0m18:20:45.335372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066BB86A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066E2FB580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066E2FBDF0>]}


============================== 18:20:45.335372 | 58ba09f5-0972-405c-a1af-e6ab25103863 ==============================
[0m18:20:45.335372 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:20:45.335372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:20:45.522335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ba09f5-0972-405c-a1af-e6ab25103863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066E2FB4C0>]}
[0m18:20:45.550415 [debug] [MainThread]: Command `dbt clean` succeeded at 18:20:45.549419 after 0.29 seconds
[0m18:20:45.550415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066BB86A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066E631100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066E3CF730>]}
[0m18:20:45.551425 [debug] [MainThread]: Flushing usage events
[0m18:20:55.759748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6DEEDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A704432E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70443FD0>]}


============================== 18:20:55.759748 | f9303453-4304-401c-a2f4-6c293daebd87 ==============================
[0m18:20:55.759748 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:20:55.776591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases_model', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:56.055465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70478D00>]}
[0m18:20:56.207077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7081FFA0>]}
[0m18:20:56.216078 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:20:56.226079 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:20:56.228142 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:20:56.229285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70C464F0>]}
[0m18:20:57.280721 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:20:57.280721 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m18:20:57.427465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:20:57.427465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:20:57.427465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:20:57.427465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:20:57.468787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A713B5D90>]}
[0m18:20:57.485595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70D81640>]}
[0m18:20:57.485595 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:20:57.485595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A708F2D60>]}
[0m18:20:57.485595 [info ] [MainThread]: 
[0m18:20:57.485595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:57.499202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m18:20:57.500917 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m18:20:57.500917 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m18:20:57.500917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:57.533414 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:20:57.535148 [debug] [ThreadPool]: On list_userdb: Close
[0m18:20:57.535148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:20:57.535148 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:20:57.535148 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:20:57.535148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:57.551209 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:20:57.551209 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:20:57.551209 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:20:57.567709 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:20:57.569711 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:20:57.570718 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:20:57.577709 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.577709 [debug] [MainThread]: On master: BEGIN
[0m18:20:57.578711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:57.599426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:57.599426 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.599426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:57.615054 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:20:57.615054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A713AB970>]}
[0m18:20:57.615054 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:57.615054 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.615054 [debug] [MainThread]: On master: BEGIN
[0m18:20:57.615054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:57.615054 [debug] [MainThread]: On master: COMMIT
[0m18:20:57.615054 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.615054 [debug] [MainThread]: On master: COMMIT
[0m18:20:57.630686 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:57.630686 [debug] [MainThread]: On master: Close
[0m18:20:57.630686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:57.630686 [info ] [MainThread]: 
[0m18:20:57.630686 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m18:20:57.630686 [info ] [Thread-1  ]: 1 of 1 START sql view model userdb.user_purchases_model ........................ [RUN]
[0m18:20:57.639715 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m18:20:57.639715 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m18:20:57.649424 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m18:20:57.651263 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 18:20:57.640712 => 18:20:57.651263
[0m18:20:57.651263 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m18:20:57.684715 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m18:20:57.684715 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m18:20:57.684715 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m18:20:57.684715 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:20:57.711861 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:20:57.711861 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m18:20:57.712860 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."userdb"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."userdb"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."userdb"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."userdb"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:20:57.716860 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:20:57.723860 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m18:20:57.723860 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */
alter table "userdb"."userdb"."user_purchases_model__dbt_tmp" rename to "user_purchases_model"
[0m18:20:57.726860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:57.733040 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: COMMIT
[0m18:20:57.733040 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m18:20:57.733040 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: COMMIT
[0m18:20:57.733040 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:20:57.750302 [debug] [Thread-1  ]: Applying DROP to: "userdb"."userdb"."user_purchases_model__dbt_backup"
[0m18:20:57.750302 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m18:20:57.750302 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */
drop view if exists "userdb"."userdb"."user_purchases_model__dbt_backup" cascade
[0m18:20:57.750302 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:20:57.765687 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 18:20:57.651263 => 18:20:57.750302
[0m18:20:57.765687 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m18:20:57.767687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9303453-4304-401c-a2f4-6c293daebd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7164CBB0>]}
[0m18:20:57.768687 [info ] [Thread-1  ]: 1 of 1 OK created sql view model userdb.user_purchases_model ................... [[32mCREATE VIEW[0m in 0.14s]
[0m18:20:57.770688 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m18:20:57.771689 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.772689 [debug] [MainThread]: On master: BEGIN
[0m18:20:57.772689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:57.782403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:57.782403 [debug] [MainThread]: On master: COMMIT
[0m18:20:57.782403 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:57.782403 [debug] [MainThread]: On master: COMMIT
[0m18:20:57.782403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:57.782403 [debug] [MainThread]: On master: Close
[0m18:20:57.782403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:57.782403 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m18:20:57.782403 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:20:57.782403 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m18:20:57.782403 [info ] [MainThread]: 
[0m18:20:57.782403 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:20:57.798027 [debug] [MainThread]: Command end result
[0m18:20:57.800807 [info ] [MainThread]: 
[0m18:20:57.800807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:57.800807 [info ] [MainThread]: 
[0m18:20:57.800807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:20:57.800807 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:57.800807 after 2.12 seconds
[0m18:20:57.815654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6DEEDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70D81640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70984880>]}
[0m18:20:57.815654 [debug] [MainThread]: Flushing usage events
[0m18:24:32.225237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E06B6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E2C21310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E2C21D90>]}


============================== 18:24:32.234240 | 0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5 ==============================
[0m18:24:32.234240 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:24:32.236219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:32.585581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E2C8E8B0>]}
[0m18:24:32.735559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E31A74C0>]}
[0m18:24:32.736561 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:24:32.749042 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:24:32.878296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:32.879296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:32.884296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E3575C40>]}
[0m18:24:32.889299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E34AEA30>]}
[0m18:24:32.890303 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:24:32.891298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E34AEA60>]}
[0m18:24:32.892294 [info ] [MainThread]: 
[0m18:24:32.894296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:32.896297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:24:32.908318 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:24:32.908318 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:24:32.909317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:32.945299 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:24:32.946308 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:24:32.946308 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:24:32.950318 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:24:32.952317 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:24:32.955304 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:24:32.961316 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:32.962318 [debug] [MainThread]: On master: BEGIN
[0m18:24:32.962318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:32.993305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:32.994297 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:32.995298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:33.001311 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:24:33.004297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a4a1bf4-4aff-4a77-b0a6-de7f9a7f98a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E355A910>]}
[0m18:24:33.005301 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:33.007305 [debug] [MainThread]: On master: Close
[0m18:24:33.008297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:33.009307 [info ] [MainThread]: 
[0m18:24:33.016700 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m18:24:33.017699 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m18:24:33.017699 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m18:24:33.025699 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m18:24:33.028696 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 18:24:33.018702 => 18:24:33.027715
[0m18:24:33.028696 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m18:24:33.029692 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 18:24:33.029692 => 18:24:33.029692
[0m18:24:33.030702 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m18:24:33.031702 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m18:24:33.032699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.products_model, now model.users_project.purchases_model)
[0m18:24:33.033700 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m18:24:33.037701 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m18:24:33.039699 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 18:24:33.033700 => 18:24:33.039699
[0m18:24:33.040700 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m18:24:33.041710 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 18:24:33.040700 => 18:24:33.040700
[0m18:24:33.042712 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m18:24:33.042712 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m18:24:33.043711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.purchases_model, now model.users_project.users_model)
[0m18:24:33.044712 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m18:24:33.049692 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m18:24:33.050692 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 18:24:33.045695 => 18:24:33.050692
[0m18:24:33.051694 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m18:24:33.051694 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 18:24:33.051694 => 18:24:33.051694
[0m18:24:33.053700 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m18:24:33.054692 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m18:24:33.055693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.users_project.users_model, now model.users_project.user_purchases_model)
[0m18:24:33.056707 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m18:24:33.060710 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m18:24:33.062885 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 18:24:33.056707 => 18:24:33.061870
[0m18:24:33.062885 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m18:24:33.063884 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 18:24:33.063884 => 18:24:33.063884
[0m18:24:33.064884 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m18:24:33.065916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:33.066949 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:24:33.066949 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m18:24:33.068937 [debug] [MainThread]: Command end result
[0m18:24:33.501487 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:24:33.502488 [info ] [MainThread]: Building catalog
[0m18:24:33.505489 [debug] [ThreadPool]: Acquiring new postgres connection 'userdb.information_schema'
[0m18:24:33.512514 [debug] [ThreadPool]: Using postgres connection "userdb.information_schema"
[0m18:24:33.513516 [debug] [ThreadPool]: On userdb.information_schema: BEGIN
[0m18:24:33.513516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:33.543491 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:24:33.544489 [debug] [ThreadPool]: Using postgres connection "userdb.information_schema"
[0m18:24:33.545490 [debug] [ThreadPool]: On userdb.information_schema: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "userdb.information_schema"} */

    
    

    select
        'userdb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('userdb') and
           upper(tbl.relname) = upper('purchases_model')) or (upper(sch.nspname) = upper('userdb') and
           upper(tbl.relname) = upper('users_model')) or (upper(sch.nspname) = upper('userdb') and
           upper(tbl.relname) = upper('user_purchases_model')) or (upper(sch.nspname) = upper('userdb') and
           upper(tbl.relname) = upper('products_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:24:33.550516 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m18:24:33.556488 [debug] [ThreadPool]: On userdb.information_schema: ROLLBACK
[0m18:24:33.559497 [debug] [ThreadPool]: On userdb.information_schema: Close
[0m18:24:33.573514 [info ] [MainThread]: Catalog written to C:\Users\raikh\VscodeProjects\dbt_app\users_project\target\catalog.json
[0m18:24:33.576502 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:24:33.576502 after 1.43 seconds
[0m18:24:33.576502 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:24:33.577512 [debug] [MainThread]: Connection 'userdb.information_schema' was properly closed.
[0m18:24:33.577512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E06B6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E31A74C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0E35C6E20>]}
[0m18:24:33.578510 [debug] [MainThread]: Flushing usage events
[0m18:24:52.690737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDFD291AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDFF84DA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDFF836EE0>]}


============================== 18:24:52.699743 | 63398ce5-6a64-4e13-8966-b91856bb461d ==============================
[0m18:24:52.699743 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:24:52.700743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8001', 'send_anonymous_usage_stats': 'True'}
[0m18:24:53.063765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63398ce5-6a64-4e13-8966-b91856bb461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDFF872EB0>]}
[0m18:24:53.225762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63398ce5-6a64-4e13-8966-b91856bb461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD80007D90>]}
[0m18:45:14.252720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EB2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274210B8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274210B8FD0>]}


============================== 18:45:14.252720 | 59fceb0e-95f3-4fa2-bb59-1b54665ddfa3 ==============================
[0m18:45:14.252720 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:45:14.252720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:14.616669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59fceb0e-95f3-4fa2-bb59-1b54665ddfa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742105AB80>]}
[0m18:45:14.755030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59fceb0e-95f3-4fa2-bb59-1b54665ddfa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027421487190>]}
[0m18:45:14.755030 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:45:14.770697 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:45:14.924606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:14.924606 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\schema.yml
[0m18:45:15.002732 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'user_purchases' in the 'models' section of file 'models\example\schema.yml'
[0m18:45:15.002732 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'user_models' in the 'models' section of file 'models\example\schema.yml'
[0m18:45:15.163393 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_user_purchases_purchase_id.6349f2f5b1' (models\example\schema.yml) depends on a node named 'user_purchases' in package '' which was not found
[0m18:45:15.163393 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_user_purchases_purchase_id.3f18311f4c' (models\example\schema.yml) depends on a node named 'user_purchases' in package '' which was not found
[0m18:45:15.163393 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.unique_user_models_user_id.ed9934b93a' (models\example\schema.yml) depends on a node named 'user_models' in package '' which was not found
[0m18:45:15.178624 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.users_project.not_null_user_models_user_id.c69fe2a637' (models\example\schema.yml) depends on a node named 'user_models' in package '' which was not found
[0m18:45:15.191622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59fceb0e-95f3-4fa2-bb59-1b54665ddfa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027421E702E0>]}
[0m18:45:15.195677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59fceb0e-95f3-4fa2-bb59-1b54665ddfa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274218D7B50>]}
[0m18:45:15.195677 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:45:15.211310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59fceb0e-95f3-4fa2-bb59-1b54665ddfa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274218D7C40>]}
[0m18:45:15.211310 [info ] [MainThread]: 
[0m18:45:15.211310 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:45:15.211310 [debug] [MainThread]: Command end result
[0m18:45:15.273805 [debug] [MainThread]: Command `dbt test` succeeded at 18:45:15.273805 after 1.11 seconds
[0m18:45:15.273805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EB2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027421522880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742159ABE0>]}
[0m18:45:15.273805 [debug] [MainThread]: Flushing usage events
[0m18:45:53.295902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053B836A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053DDB8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053DDB8FA0>]}


============================== 18:45:53.295902 | 254f1dae-cdef-4f80-9b53-4ccf73737f07 ==============================
[0m18:45:53.295902 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:45:53.295902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:53.599597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E04B7F0>]}
[0m18:45:53.746462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E1E1610>]}
[0m18:45:53.746462 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:45:53.746462 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:45:53.890236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:53.890236 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\schema.yml
[0m18:45:54.112138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E973310>]}
[0m18:45:54.127761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E3CFA30>]}
[0m18:45:54.127761 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:45:54.127761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E3CFD00>]}
[0m18:45:54.143373 [info ] [MainThread]: 
[0m18:45:54.143373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:54.143373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:45:54.212476 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:45:54.212476 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:45:54.212476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:54.276295 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.276295 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:45:54.276295 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:45:54.291909 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:45:54.291909 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:45:54.291909 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:45:54.291909 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.291909 [debug] [MainThread]: On master: BEGIN
[0m18:45:54.291909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:54.323417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.338784 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.338784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:54.338784 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:45:54.338784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254f1dae-cdef-4f80-9b53-4ccf73737f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E3CF2E0>]}
[0m18:45:54.338784 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:54.338784 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.338784 [debug] [MainThread]: On master: BEGIN
[0m18:45:54.354418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.354418 [debug] [MainThread]: On master: COMMIT
[0m18:45:54.354418 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.354418 [debug] [MainThread]: On master: COMMIT
[0m18:45:54.354418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:54.354418 [debug] [MainThread]: On master: Close
[0m18:45:54.354418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:54.354418 [info ] [MainThread]: 
[0m18:45:54.372106 [debug] [Thread-1  ]: Began running node test.users_project.not_null_user_purchases_model_purchase_id.71b4825914
[0m18:45:54.373108 [info ] [Thread-1  ]: 1 of 4 START test not_null_user_purchases_model_purchase_id .................... [RUN]
[0m18:45:54.375107 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.users_project.not_null_user_purchases_model_purchase_id.71b4825914'
[0m18:45:54.375807 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_user_purchases_model_purchase_id.71b4825914
[0m18:45:54.379099 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_user_purchases_model_purchase_id.71b4825914"
[0m18:45:54.395941 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_purchase_id.71b4825914 (compile): 18:45:54.376352 => 18:45:54.395941
[0m18:45:54.395941 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_user_purchases_model_purchase_id.71b4825914
[0m18:45:54.414907 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_user_purchases_model_purchase_id.71b4825914"
[0m18:45:54.416346 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_purchase_id.71b4825914"
[0m18:45:54.416346 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_purchase_id.71b4825914: BEGIN
[0m18:45:54.416346 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:45:54.428838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.428838 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_purchase_id.71b4825914"
[0m18:45:54.442936 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_purchase_id.71b4825914: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_user_purchases_model_purchase_id.71b4825914"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select purchase_id
from "userdb"."userdb"."user_purchases_model"
where purchase_id is null



      
    ) dbt_internal_test
[0m18:45:54.445206 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "purchase_id" does not exist
LINE 13: select purchase_id
                ^

[0m18:45:54.445206 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_purchase_id.71b4825914: ROLLBACK
[0m18:45:54.445206 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_purchase_id.71b4825914 (execute): 18:45:54.395941 => 18:45:54.445206
[0m18:45:54.445206 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_purchase_id.71b4825914: Close
[0m18:45:54.508729 [debug] [Thread-1  ]: Database Error in test not_null_user_purchases_model_purchase_id (models\example\schema.yml)
  column "purchase_id" does not exist
  LINE 13: select purchase_id
                  ^
  compiled Code at target\run\users_project\models\example\schema.yml\not_null_user_purchases_model_purchase_id.sql
[0m18:45:54.508729 [error] [Thread-1  ]: 1 of 4 ERROR not_null_user_purchases_model_purchase_id ......................... [[31mERROR[0m in 0.13s]
[0m18:45:54.508729 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_user_purchases_model_purchase_id.71b4825914
[0m18:45:54.508729 [debug] [Thread-1  ]: Began running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:45:54.508729 [info ] [Thread-1  ]: 2 of 4 START test not_null_users_model_user_id ................................. [RUN]
[0m18:45:54.508729 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.not_null_user_purchases_model_purchase_id.71b4825914, now test.users_project.not_null_users_model_user_id.d83807949e)
[0m18:45:54.508729 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:45:54.508729 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:45:54.508729 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (compile): 18:45:54.508729 => 18:45:54.508729
[0m18:45:54.508729 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:45:54.526406 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:45:54.528395 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:45:54.528395 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: BEGIN
[0m18:45:54.529408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:54.561511 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.561511 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:45:54.561511 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_users_model_user_id.d83807949e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "userdb"."userdb"."users_model"
where user_id is null



      
    ) dbt_internal_test
[0m18:45:54.577732 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:45:54.577732 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (execute): 18:45:54.508729 => 18:45:54.577732
[0m18:45:54.577732 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: ROLLBACK
[0m18:45:54.577732 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: Close
[0m18:45:54.577732 [info ] [Thread-1  ]: 2 of 4 PASS not_null_users_model_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m18:45:54.577732 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:45:54.577732 [debug] [Thread-1  ]: Began running node test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884
[0m18:45:54.577732 [info ] [Thread-1  ]: 3 of 4 START test unique_user_purchases_model_purchase_id ...................... [RUN]
[0m18:45:54.577732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.not_null_users_model_user_id.d83807949e, now test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884)
[0m18:45:54.577732 [debug] [Thread-1  ]: Began compiling node test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884
[0m18:45:54.594614 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884"
[0m18:45:54.594614 [debug] [Thread-1  ]: Timing info for test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884 (compile): 18:45:54.577732 => 18:45:54.594614
[0m18:45:54.594614 [debug] [Thread-1  ]: Began executing node test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884
[0m18:45:54.594614 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884"
[0m18:45:54.594614 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884"
[0m18:45:54.610619 [debug] [Thread-1  ]: On test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884: BEGIN
[0m18:45:54.610619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:54.645868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.646973 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884"
[0m18:45:54.646973 [debug] [Thread-1  ]: On test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    purchase_id as unique_field,
    count(*) as n_records

from "userdb"."userdb"."user_purchases_model"
where purchase_id is not null
group by purchase_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:54.646973 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "purchase_id" does not exist
LINE 12:     purchase_id as unique_field,
             ^

[0m18:45:54.646973 [debug] [Thread-1  ]: On test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884: ROLLBACK
[0m18:45:54.646973 [debug] [Thread-1  ]: Timing info for test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884 (execute): 18:45:54.594614 => 18:45:54.646973
[0m18:45:54.646973 [debug] [Thread-1  ]: On test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884: Close
[0m18:45:54.646973 [debug] [Thread-1  ]: Database Error in test unique_user_purchases_model_purchase_id (models\example\schema.yml)
  column "purchase_id" does not exist
  LINE 12:     purchase_id as unique_field,
               ^
  compiled Code at target\run\users_project\models\example\schema.yml\unique_user_purchases_model_purchase_id.sql
[0m18:45:54.646973 [error] [Thread-1  ]: 3 of 4 ERROR unique_user_purchases_model_purchase_id ........................... [[31mERROR[0m in 0.07s]
[0m18:45:54.646973 [debug] [Thread-1  ]: Finished running node test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884
[0m18:45:54.660049 [debug] [Thread-1  ]: Began running node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:45:54.661047 [info ] [Thread-1  ]: 4 of 4 START test unique_users_model_user_id ................................... [RUN]
[0m18:45:54.661772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.unique_user_purchases_model_purchase_id.bda9ea7884, now test.users_project.unique_users_model_user_id.5c49f9b29e)
[0m18:45:54.661772 [debug] [Thread-1  ]: Began compiling node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:45:54.661772 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:45:54.661772 [debug] [Thread-1  ]: Timing info for test.users_project.unique_users_model_user_id.5c49f9b29e (compile): 18:45:54.661772 => 18:45:54.661772
[0m18:45:54.661772 [debug] [Thread-1  ]: Began executing node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:45:54.661772 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:45:54.676278 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:45:54.677273 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: BEGIN
[0m18:45:54.677273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:54.713869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.713869 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:45:54.713869 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.unique_users_model_user_id.5c49f9b29e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "userdb"."userdb"."users_model"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:54.713869 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:45:54.713869 [debug] [Thread-1  ]: Timing info for test.users_project.unique_users_model_user_id.5c49f9b29e (execute): 18:45:54.661772 => 18:45:54.713869
[0m18:45:54.713869 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: ROLLBACK
[0m18:45:54.713869 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: Close
[0m18:45:54.713869 [error] [Thread-1  ]: 4 of 4 FAIL 1 unique_users_model_user_id ....................................... [[31mFAIL 1[0m in 0.05s]
[0m18:45:54.726470 [debug] [Thread-1  ]: Finished running node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:45:54.729471 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.730473 [debug] [MainThread]: On master: BEGIN
[0m18:45:54.730473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:54.764571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:54.765583 [debug] [MainThread]: On master: COMMIT
[0m18:45:54.765583 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:54.766649 [debug] [MainThread]: On master: COMMIT
[0m18:45:54.766649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:54.766649 [debug] [MainThread]: On master: Close
[0m18:45:54.766649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:54.766649 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:45:54.766649 [debug] [MainThread]: Connection 'test.users_project.unique_users_model_user_id.5c49f9b29e' was properly closed.
[0m18:45:54.766649 [info ] [MainThread]: 
[0m18:45:54.766649 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m18:45:54.766649 [debug] [MainThread]: Command end result
[0m18:45:54.781000 [info ] [MainThread]: 
[0m18:45:54.781000 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:45:54.781000 [info ] [MainThread]: 
[0m18:45:54.781000 [error] [MainThread]:   Database Error in test not_null_user_purchases_model_purchase_id (models\example\schema.yml)
  column "purchase_id" does not exist
  LINE 13: select purchase_id
                  ^
  compiled Code at target\run\users_project\models\example\schema.yml\not_null_user_purchases_model_purchase_id.sql
[0m18:45:54.781000 [info ] [MainThread]: 
[0m18:45:54.781000 [error] [MainThread]:   Database Error in test unique_user_purchases_model_purchase_id (models\example\schema.yml)
  column "purchase_id" does not exist
  LINE 12:     purchase_id as unique_field,
               ^
  compiled Code at target\run\users_project\models\example\schema.yml\unique_user_purchases_model_purchase_id.sql
[0m18:45:54.781000 [info ] [MainThread]: 
[0m18:45:54.793865 [error] [MainThread]: [31mFailure in test unique_users_model_user_id (models\example\schema.yml)[0m
[0m18:45:54.794857 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:45:54.795867 [info ] [MainThread]: 
[0m18:45:54.795867 [info ] [MainThread]:   compiled Code at target\compiled\users_project\models\example\schema.yml\unique_users_model_user_id.sql
[0m18:45:54.796866 [info ] [MainThread]: 
[0m18:45:54.797865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m18:45:54.799640 [debug] [MainThread]: Command `dbt test` failed at 18:45:54.799640 after 1.58 seconds
[0m18:45:54.799640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053B836A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E2A4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053E719FD0>]}
[0m18:45:54.799640 [debug] [MainThread]: Flushing usage events
[0m18:47:05.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026265E36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002626858FAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026268569F70>]}


============================== 18:47:05.157853 | 75f9afaf-76d8-428e-83fa-b17fe79b2376 ==============================
[0m18:47:05.157853 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:47:05.158843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:47:05.462115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262654D9460>]}
[0m18:47:05.612906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026268832190>]}
[0m18:47:05.613906 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:47:05.626836 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:47:05.744290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:05.745295 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\schema.yml
[0m18:47:06.231619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262694F1190>]}
[0m18:47:06.245327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262689A7BE0>]}
[0m18:47:06.246328 [info ] [MainThread]: Found 4 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:47:06.247326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262689A7D30>]}
[0m18:47:06.248329 [info ] [MainThread]: 
[0m18:47:06.250327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:47:06.252336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:47:06.266918 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:47:06.267918 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:47:06.267918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:06.303893 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.304900 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:47:06.305901 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:47:06.310899 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:47:06.311918 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:47:06.313918 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:47:06.320910 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.322092 [debug] [MainThread]: On master: BEGIN
[0m18:47:06.322895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:06.350227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.350227 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.351225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:47:06.358224 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:47:06.361224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f9afaf-76d8-428e-83fa-b17fe79b2376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026268D1B940>]}
[0m18:47:06.361224 [debug] [MainThread]: On master: ROLLBACK
[0m18:47:06.364013 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.364013 [debug] [MainThread]: On master: BEGIN
[0m18:47:06.367580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.367580 [debug] [MainThread]: On master: COMMIT
[0m18:47:06.368579 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.368579 [debug] [MainThread]: On master: COMMIT
[0m18:47:06.371598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:47:06.371598 [debug] [MainThread]: On master: Close
[0m18:47:06.372580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:06.373598 [info ] [MainThread]: 
[0m18:47:06.378315 [debug] [Thread-1  ]: Began running node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:47:06.379363 [info ] [Thread-1  ]: 1 of 3 START test not_null_user_purchases_model_username ....................... [RUN]
[0m18:47:06.381347 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.users_project.not_null_user_purchases_model_username.caea0178cf'
[0m18:47:06.382355 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:47:06.400356 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:47:06.402341 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_username.caea0178cf (compile): 18:47:06.382355 => 18:47:06.401362
[0m18:47:06.402341 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:47:06.419356 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:47:06.421348 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:47:06.421348 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: BEGIN
[0m18:47:06.422344 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:47:06.459342 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.460345 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:47:06.461344 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_user_purchases_model_username.caea0178cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select username
from "userdb"."userdb"."user_purchases_model"
where username is null



      
    ) dbt_internal_test
[0m18:47:06.464344 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:47:06.467345 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_username.caea0178cf (execute): 18:47:06.403344 => 18:47:06.466355
[0m18:47:06.467345 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: ROLLBACK
[0m18:47:06.470355 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: Close
[0m18:47:06.471344 [info ] [Thread-1  ]: 1 of 3 PASS not_null_user_purchases_model_username ............................. [[32mPASS[0m in 0.09s]
[0m18:47:06.473342 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:47:06.475345 [debug] [Thread-1  ]: Began running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:47:06.475345 [info ] [Thread-1  ]: 2 of 3 START test not_null_users_model_user_id ................................. [RUN]
[0m18:47:06.476837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.not_null_user_purchases_model_username.caea0178cf, now test.users_project.not_null_users_model_user_id.d83807949e)
[0m18:47:06.477872 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:47:06.482873 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:47:06.483879 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (compile): 18:47:06.477872 => 18:47:06.483879
[0m18:47:06.484855 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:47:06.487861 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:47:06.489859 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:47:06.490865 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: BEGIN
[0m18:47:06.491860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:06.522751 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.523760 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:47:06.524753 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_users_model_user_id.d83807949e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "userdb"."userdb"."users_model"
where user_id is null



      
    ) dbt_internal_test
[0m18:47:06.528758 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:47:06.530756 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (execute): 18:47:06.484855 => 18:47:06.530756
[0m18:47:06.531775 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: ROLLBACK
[0m18:47:06.533775 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: Close
[0m18:47:06.535748 [info ] [Thread-1  ]: 2 of 3 PASS not_null_users_model_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m18:47:06.537750 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:47:06.538749 [debug] [Thread-1  ]: Began running node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:47:06.539750 [info ] [Thread-1  ]: 3 of 3 START test unique_users_model_user_id ................................... [RUN]
[0m18:47:06.541759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.not_null_users_model_user_id.d83807949e, now test.users_project.unique_users_model_user_id.5c49f9b29e)
[0m18:47:06.541759 [debug] [Thread-1  ]: Began compiling node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:47:06.548775 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:47:06.550936 [debug] [Thread-1  ]: Timing info for test.users_project.unique_users_model_user_id.5c49f9b29e (compile): 18:47:06.542756 => 18:47:06.549775
[0m18:47:06.550936 [debug] [Thread-1  ]: Began executing node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:47:06.553756 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:47:06.555752 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:47:06.556758 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: BEGIN
[0m18:47:06.557765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:47:06.587833 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.588833 [debug] [Thread-1  ]: Using postgres connection "test.users_project.unique_users_model_user_id.5c49f9b29e"
[0m18:47:06.589835 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.unique_users_model_user_id.5c49f9b29e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "userdb"."userdb"."users_model"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:47:06.593842 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:47:06.596850 [debug] [Thread-1  ]: Timing info for test.users_project.unique_users_model_user_id.5c49f9b29e (execute): 18:47:06.551775 => 18:47:06.595842
[0m18:47:06.596850 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: ROLLBACK
[0m18:47:06.599831 [debug] [Thread-1  ]: On test.users_project.unique_users_model_user_id.5c49f9b29e: Close
[0m18:47:06.600831 [error] [Thread-1  ]: 3 of 3 FAIL 1 unique_users_model_user_id ....................................... [[31mFAIL 1[0m in 0.06s]
[0m18:47:06.602841 [debug] [Thread-1  ]: Finished running node test.users_project.unique_users_model_user_id.5c49f9b29e
[0m18:47:06.604832 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.605837 [debug] [MainThread]: On master: BEGIN
[0m18:47:06.606834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:47:06.635197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:06.635197 [debug] [MainThread]: On master: COMMIT
[0m18:47:06.636201 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:06.636201 [debug] [MainThread]: On master: COMMIT
[0m18:47:06.639203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:47:06.640200 [debug] [MainThread]: On master: Close
[0m18:47:06.642198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:06.643207 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:47:06.643207 [debug] [MainThread]: Connection 'test.users_project.unique_users_model_user_id.5c49f9b29e' was properly closed.
[0m18:47:06.644208 [info ] [MainThread]: 
[0m18:47:06.645200 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m18:47:06.647199 [debug] [MainThread]: Command end result
[0m18:47:06.658212 [info ] [MainThread]: 
[0m18:47:06.660198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:47:06.661198 [info ] [MainThread]: 
[0m18:47:06.661736 [error] [MainThread]: [31mFailure in test unique_users_model_user_id (models\example\schema.yml)[0m
[0m18:47:06.662758 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:47:06.662758 [info ] [MainThread]: 
[0m18:47:06.663757 [info ] [MainThread]:   compiled Code at target\compiled\users_project\models\example\schema.yml\unique_users_model_user_id.sql
[0m18:47:06.664753 [info ] [MainThread]: 
[0m18:47:06.665749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:47:06.668757 [debug] [MainThread]: Command `dbt test` failed at 18:47:06.668757 after 1.59 seconds
[0m18:47:06.669776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026265E36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026268832190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262689A71C0>]}
[0m18:47:06.670777 [debug] [MainThread]: Flushing usage events
[0m18:51:46.089784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62F3F6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B631B36640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B631B36FA0>]}


============================== 18:51:46.089784 | 0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15 ==============================
[0m18:51:46.089784 [info ] [MainThread]: Running with dbt=1.7.2
[0m18:51:46.089784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:51:46.388937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B631BCB7F0>]}
[0m18:51:46.535999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B631D71610>]}
[0m18:51:46.551788 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m18:51:46.551788 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m18:51:46.656021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:46.656021 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\schema.yml
[0m18:51:47.172148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B632AB6E20>]}
[0m18:51:47.187770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6324068B0>]}
[0m18:51:47.187770 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:51:47.187770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B632406B50>]}
[0m18:51:47.203393 [info ] [MainThread]: 
[0m18:51:47.203393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:47.203393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_userdb'
[0m18:51:47.220238 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:51:47.221238 [debug] [ThreadPool]: On list_userdb_userdb: BEGIN
[0m18:51:47.222238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:47.240340 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.240340 [debug] [ThreadPool]: Using postgres connection "list_userdb_userdb"
[0m18:51:47.240340 [debug] [ThreadPool]: On list_userdb_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_userdb"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'userdb'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'userdb'
  
[0m18:51:47.240340 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:51:47.240340 [debug] [ThreadPool]: On list_userdb_userdb: ROLLBACK
[0m18:51:47.240340 [debug] [ThreadPool]: On list_userdb_userdb: Close
[0m18:51:47.256345 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.256345 [debug] [MainThread]: On master: BEGIN
[0m18:51:47.256345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:47.274004 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.274004 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.274004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:47.290000 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:51:47.290000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0f0ae4-f00f-4a4b-8dde-9fecd897bf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6324D9700>]}
[0m18:51:47.290000 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:47.290000 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.290000 [debug] [MainThread]: On master: BEGIN
[0m18:51:47.290000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.290000 [debug] [MainThread]: On master: COMMIT
[0m18:51:47.305182 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.306192 [debug] [MainThread]: On master: COMMIT
[0m18:51:47.307188 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:47.308190 [debug] [MainThread]: On master: Close
[0m18:51:47.309184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:47.310188 [info ] [MainThread]: 
[0m18:51:47.315182 [debug] [Thread-1  ]: Began running node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:51:47.316189 [info ] [Thread-1  ]: 1 of 2 START test not_null_user_purchases_model_username ....................... [RUN]
[0m18:51:47.317181 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.users_project.not_null_user_purchases_model_username.caea0178cf'
[0m18:51:47.318188 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:51:47.322893 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:51:47.339597 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_username.caea0178cf (compile): 18:51:47.318188 => 18:51:47.339597
[0m18:51:47.339597 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:51:47.356346 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:51:47.356346 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:51:47.356346 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: BEGIN
[0m18:51:47.356346 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:51:47.373700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.373700 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_user_purchases_model_username.caea0178cf"
[0m18:51:47.373700 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_user_purchases_model_username.caea0178cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select username
from "userdb"."userdb"."user_purchases_model"
where username is null



      
    ) dbt_internal_test
[0m18:51:47.389606 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:51:47.389606 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_user_purchases_model_username.caea0178cf (execute): 18:51:47.339597 => 18:51:47.389606
[0m18:51:47.389606 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: ROLLBACK
[0m18:51:47.389606 [debug] [Thread-1  ]: On test.users_project.not_null_user_purchases_model_username.caea0178cf: Close
[0m18:51:47.389606 [info ] [Thread-1  ]: 1 of 2 PASS not_null_user_purchases_model_username ............................. [[32mPASS[0m in 0.07s]
[0m18:51:47.389606 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_user_purchases_model_username.caea0178cf
[0m18:51:47.389606 [debug] [Thread-1  ]: Began running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:51:47.389606 [info ] [Thread-1  ]: 2 of 2 START test not_null_users_model_user_id ................................. [RUN]
[0m18:51:47.405183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.users_project.not_null_user_purchases_model_username.caea0178cf, now test.users_project.not_null_users_model_user_id.d83807949e)
[0m18:51:47.405183 [debug] [Thread-1  ]: Began compiling node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:51:47.410190 [debug] [Thread-1  ]: Writing injected SQL for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:51:47.412188 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (compile): 18:51:47.406191 => 18:51:47.412188
[0m18:51:47.413179 [debug] [Thread-1  ]: Began executing node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:51:47.416189 [debug] [Thread-1  ]: Writing runtime sql for node "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:51:47.417201 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:51:47.418183 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: BEGIN
[0m18:51:47.419179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:47.435190 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.436189 [debug] [Thread-1  ]: Using postgres connection "test.users_project.not_null_users_model_user_id.d83807949e"
[0m18:51:47.437188 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "test.users_project.not_null_users_model_user_id.d83807949e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "userdb"."userdb"."users_model"
where user_id is null



      
    ) dbt_internal_test
[0m18:51:47.440578 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:51:47.442593 [debug] [Thread-1  ]: Timing info for test.users_project.not_null_users_model_user_id.d83807949e (execute): 18:51:47.413179 => 18:51:47.442593
[0m18:51:47.443790 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: ROLLBACK
[0m18:51:47.443790 [debug] [Thread-1  ]: On test.users_project.not_null_users_model_user_id.d83807949e: Close
[0m18:51:47.443790 [info ] [Thread-1  ]: 2 of 2 PASS not_null_users_model_user_id ....................................... [[32mPASS[0m in 0.05s]
[0m18:51:47.443790 [debug] [Thread-1  ]: Finished running node test.users_project.not_null_users_model_user_id.d83807949e
[0m18:51:47.443790 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.443790 [debug] [MainThread]: On master: BEGIN
[0m18:51:47.443790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:47.458005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:47.471842 [debug] [MainThread]: On master: COMMIT
[0m18:51:47.472859 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:47.472859 [debug] [MainThread]: On master: COMMIT
[0m18:51:47.474839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:47.475857 [debug] [MainThread]: On master: Close
[0m18:51:47.477297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:47.477297 [debug] [MainThread]: Connection 'list_userdb_userdb' was properly closed.
[0m18:51:47.477297 [debug] [MainThread]: Connection 'test.users_project.not_null_users_model_user_id.d83807949e' was properly closed.
[0m18:51:47.477297 [info ] [MainThread]: 
[0m18:51:47.477297 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:51:47.477297 [debug] [MainThread]: Command end result
[0m18:51:47.491614 [info ] [MainThread]: 
[0m18:51:47.491614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:47.491614 [info ] [MainThread]: 
[0m18:51:47.491614 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:51:47.491614 [debug] [MainThread]: Command `dbt test` succeeded at 18:51:47.491614 after 1.48 seconds
[0m18:51:47.491614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62F3F6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B631CD2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6320C17C0>]}
[0m18:51:47.491614 [debug] [MainThread]: Flushing usage events
[0m19:10:50.365747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DB3EDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DDB50AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DDB3AEB0>]}


============================== 19:10:50.370593 | 8c14d20d-b0ca-4aab-a316-eaab1a1a59cd ==============================
[0m19:10:50.370593 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:10:50.370593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:50.595405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c14d20d-b0ca-4aab-a316-eaab1a1a59cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DDB3A550>]}
[0m19:10:50.631777 [debug] [MainThread]: Command `dbt clean` succeeded at 19:10:50.631777 after 0.34 seconds
[0m19:10:50.631777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DB3EDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DDBFA2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229DDB65A30>]}
[0m19:10:50.631777 [debug] [MainThread]: Flushing usage events
[0m19:11:28.039863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1A511AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CA882E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CA88FD0>]}


============================== 19:11:28.039863 | 336deb90-e4f7-4fcb-8ca5-d3aab715c179 ==============================
[0m19:11:28.039863 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:11:28.039863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model user_purchases_model', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:11:28.355999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CABED00>]}
[0m19:11:28.496532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CE4CFA0>]}
[0m19:11:28.496532 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:11:28.522162 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:11:28.522162 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:11:28.522162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CE695B0>]}
[0m19:11:29.787389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1D9F47F0>]}
[0m19:11:29.803049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1D9F4940>]}
[0m19:11:29.803049 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:11:29.818665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CA880A0>]}
[0m19:11:29.818665 [info ] [MainThread]: 
[0m19:11:29.818665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:11:29.818665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:11:29.834290 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:11:29.834290 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:11:29.835856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:29.887953 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:11:29.887953 [debug] [ThreadPool]: On list_userdb: Close
[0m19:11:29.887953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_userdb, now create_userdb_dbt)
[0m19:11:29.887953 [debug] [ThreadPool]: Creating schema "database: "userdb"
schema: "dbt"
"
[0m19:11:29.901596 [debug] [ThreadPool]: Using postgres connection "create_userdb_dbt"
[0m19:11:29.902611 [debug] [ThreadPool]: On create_userdb_dbt: BEGIN
[0m19:11:29.902611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:29.934010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:11:29.935081 [debug] [ThreadPool]: Using postgres connection "create_userdb_dbt"
[0m19:11:29.935081 [debug] [ThreadPool]: On create_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "create_userdb_dbt"} */
create schema if not exists "dbt"
[0m19:11:29.935081 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:11:29.935081 [debug] [ThreadPool]: On create_userdb_dbt: COMMIT
[0m19:11:29.935081 [debug] [ThreadPool]: Using postgres connection "create_userdb_dbt"
[0m19:11:29.935081 [debug] [ThreadPool]: On create_userdb_dbt: COMMIT
[0m19:11:29.935081 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:11:29.935081 [debug] [ThreadPool]: On create_userdb_dbt: Close
[0m19:11:29.935081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:11:29.950722 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:11:29.950722 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:11:29.950722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:29.966588 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:11:29.966588 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:11:29.966588 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:11:29.986567 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:11:29.988582 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:11:29.989561 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:11:29.995568 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:29.995568 [debug] [MainThread]: On master: BEGIN
[0m19:11:29.996573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:30.017144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:11:30.017144 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:30.017144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:30.032522 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:11:30.032522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1DC14430>]}
[0m19:11:30.032522 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:30.032522 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:30.032522 [debug] [MainThread]: On master: BEGIN
[0m19:11:30.032522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:11:30.032522 [debug] [MainThread]: On master: COMMIT
[0m19:11:30.032522 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:30.032522 [debug] [MainThread]: On master: COMMIT
[0m19:11:30.048158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:11:30.048158 [debug] [MainThread]: On master: Close
[0m19:11:30.048158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:30.048158 [info ] [MainThread]: 
[0m19:11:30.048158 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m19:11:30.048158 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.user_purchases_model ........................... [RUN]
[0m19:11:30.048158 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m19:11:30.063020 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m19:11:30.072770 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m19:11:30.073817 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 19:11:30.063020 => 19:11:30.073817
[0m19:11:30.073817 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m19:11:30.104106 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m19:11:30.104106 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:11:30.117910 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m19:11:30.117910 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:11:30.148921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:11:30.149924 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:11:30.149924 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."dbt"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."dbt"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."dbt"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."dbt"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:11:30.151324 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt.users_model" does not exist
LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                      ^

[0m19:11:30.151324 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: ROLLBACK
[0m19:11:30.151324 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 19:11:30.073817 => 19:11:30.151324
[0m19:11:30.151324 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m19:11:30.151324 [debug] [Thread-1  ]: Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.users_model" does not exist
  LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                        ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:11:30.151324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '336deb90-e4f7-4fcb-8ca5-d3aab715c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1DC89EB0>]}
[0m19:11:30.151324 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.user_purchases_model .................. [[31mERROR[0m in 0.10s]
[0m19:11:30.166957 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m19:11:30.166957 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:30.166957 [debug] [MainThread]: On master: BEGIN
[0m19:11:30.166957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:30.182838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:11:30.198206 [debug] [MainThread]: On master: COMMIT
[0m19:11:30.198206 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:30.198206 [debug] [MainThread]: On master: COMMIT
[0m19:11:30.198206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:11:30.198206 [debug] [MainThread]: On master: Close
[0m19:11:30.198206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:30.198206 [debug] [MainThread]: Connection 'create_userdb_dbt' was properly closed.
[0m19:11:30.198206 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:11:30.198206 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m19:11:30.198206 [info ] [MainThread]: 
[0m19:11:30.198206 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:11:30.198206 [debug] [MainThread]: Command end result
[0m19:11:30.218695 [info ] [MainThread]: 
[0m19:11:30.218695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:11:30.218695 [info ] [MainThread]: 
[0m19:11:30.218695 [error] [MainThread]:   Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.users_model" does not exist
  LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                        ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:11:30.218695 [info ] [MainThread]: 
[0m19:11:30.218695 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:11:30.218695 [debug] [MainThread]: Command `dbt run` failed at 19:11:30.218695 after 2.26 seconds
[0m19:11:30.218695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1A511AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1CE4CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1D25B490>]}
[0m19:11:30.218695 [debug] [MainThread]: Flushing usage events
[0m19:12:47.241647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90476AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92A0CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB929FAF70>]}


============================== 19:12:47.241647 | 0d1fa495-e474-4399-b7a5-e400ff2ee40a ==============================
[0m19:12:47.241647 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:12:47.241647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model users_model', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:12:47.537511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8FB39430>]}
[0m19:12:47.677969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92EA8190>]}
[0m19:12:47.677969 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:12:47.693594 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:12:47.812035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:47.812035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:47.812035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB93378790>]}
[0m19:12:47.827643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB932BD520>]}
[0m19:12:47.827643 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:12:47.827643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB932BD700>]}
[0m19:12:47.827643 [info ] [MainThread]: 
[0m19:12:47.827643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:12:47.827643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:12:47.849667 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:12:47.849667 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:12:47.849667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:47.879716 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:12:47.881141 [debug] [ThreadPool]: On list_userdb: Close
[0m19:12:47.881141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:12:47.881141 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:12:47.881141 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:12:47.881141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:47.897825 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:12:47.897825 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:12:47.897825 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:12:47.914575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:12:47.914575 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:12:47.914575 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:12:47.914575 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:47.914575 [debug] [MainThread]: On master: BEGIN
[0m19:12:47.914575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:47.945260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:47.946273 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:47.946273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:12:47.952399 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:12:47.954268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB932BD130>]}
[0m19:12:47.954268 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:47.957264 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:47.957264 [debug] [MainThread]: On master: BEGIN
[0m19:12:47.960265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:47.961267 [debug] [MainThread]: On master: COMMIT
[0m19:12:47.962268 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:47.962268 [debug] [MainThread]: On master: COMMIT
[0m19:12:47.964374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:47.964374 [debug] [MainThread]: On master: Close
[0m19:12:47.964374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:47.964374 [info ] [MainThread]: 
[0m19:12:47.964374 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m19:12:47.964374 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.users_model .................................... [RUN]
[0m19:12:47.964374 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.users_model'
[0m19:12:47.975572 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m19:12:47.981900 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m19:12:47.981900 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 19:12:47.976582 => 19:12:47.981900
[0m19:12:47.981900 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m19:12:48.016447 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.users_model"
[0m19:12:48.016447 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:12:48.016447 [debug] [Thread-1  ]: On model.users_project.users_model: BEGIN
[0m19:12:48.016447 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:12:48.042089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.046705 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:12:48.047713 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */

  create view "userdb"."dbt"."users_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select u.user_id, u.first_name, u.last_name, ph.mobile, cr.model, cr.price
    from users u
    inner join user_phones ph on u.user_id = ph.user_id
    inner join user_cars cr on u.user_id = cr.user_id

), trans_data as (

    select source_data.user_id, CONCAT(source_data.first_name, '  ', source_data.last_name) as username, 
            CONCAT('mobile ', ' ' , source_data.mobile) as userphone
    from source_data        
)

select * from trans_data


    
select u.user_id, u.first_name, u.last_name, ph.mobile, cr.model, cr.rice from users u inner join user_phones ph on u.user_ierd = ph.us_id inner join user_cars cr on u.user_id = cr.user_id;
    
    

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:12:48.049702 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 35: select u.user_id, u.first_name, u.last_name, ph.mobile, cr.m...
         ^

[0m19:12:48.050705 [debug] [Thread-1  ]: On model.users_project.users_model: ROLLBACK
[0m19:12:48.053702 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 19:12:47.981900 => 19:12:48.052704
[0m19:12:48.053702 [debug] [Thread-1  ]: On model.users_project.users_model: Close
[0m19:12:48.058706 [debug] [Thread-1  ]: Database Error in model users_model (models\example\users_model.sql)
  syntax error at or near "select"
  LINE 35: select u.user_id, u.first_name, u.last_name, ph.mobile, cr.m...
           ^
  compiled Code at target\run\users_project\models\example\users_model.sql
[0m19:12:48.058706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1fa495-e474-4399-b7a5-e400ff2ee40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB933F7DC0>]}
[0m19:12:48.059705 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.users_model ........................... [[31mERROR[0m in 0.09s]
[0m19:12:48.062712 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m19:12:48.064712 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.065710 [debug] [MainThread]: On master: BEGIN
[0m19:12:48.066710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:48.093450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.094450 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.094450 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.095448 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.097115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:48.098116 [debug] [MainThread]: On master: Close
[0m19:12:48.099118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:48.100127 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:12:48.100127 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:12:48.101119 [debug] [MainThread]: Connection 'model.users_project.users_model' was properly closed.
[0m19:12:48.101119 [info ] [MainThread]: 
[0m19:12:48.102962 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:12:48.102962 [debug] [MainThread]: Command end result
[0m19:12:48.114249 [info ] [MainThread]: 
[0m19:12:48.115975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:48.115975 [info ] [MainThread]: 
[0m19:12:48.115975 [error] [MainThread]:   Database Error in model users_model (models\example\users_model.sql)
  syntax error at or near "select"
  LINE 35: select u.user_id, u.first_name, u.last_name, ph.mobile, cr.m...
           ^
  compiled Code at target\run\users_project\models\example\users_model.sql
[0m19:12:48.115975 [info ] [MainThread]: 
[0m19:12:48.115975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:48.115975 [debug] [MainThread]: Command `dbt run` failed at 19:12:48.115975 after 0.96 seconds
[0m19:12:48.115975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90476AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92EA8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92BD58E0>]}
[0m19:12:48.115975 [debug] [MainThread]: Flushing usage events
[0m19:13:19.816648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C584F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5AA3A640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5AA3AFA0>]}


============================== 19:13:19.816648 | 46d97ae0-583c-496f-997d-5163df8c442e ==============================
[0m19:13:19.816648 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:13:19.832275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model user_purchases_model', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:20.116829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5AACEAF0>]}
[0m19:13:20.273053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B23B3D0>]}
[0m19:13:20.273053 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:13:20.288670 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:13:20.378082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:13:20.378082 [debug] [MainThread]: Partial parsing: updated file: users_project://models\example\users_model.sql
[0m19:13:20.854008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B9B5D90>]}
[0m19:13:20.869781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B338550>]}
[0m19:13:20.869781 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:13:20.869781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B338700>]}
[0m19:13:20.869781 [info ] [MainThread]: 
[0m19:13:20.869781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:20.885259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:13:20.885259 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:13:20.885259 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:13:20.885259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:20.916961 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:13:20.916961 [debug] [ThreadPool]: On list_userdb: Close
[0m19:13:20.916961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:13:20.930368 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:20.930368 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:13:20.930368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:20.947632 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:20.947632 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:20.947632 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:13:20.947632 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:13:20.947632 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:13:20.947632 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:13:20.967352 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:20.967352 [debug] [MainThread]: On master: BEGIN
[0m19:13:20.968352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:20.994333 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:20.994333 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:20.995425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:20.995425 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:13:20.995425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5AF9BC40>]}
[0m19:13:20.995425 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:20.995425 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:20.995425 [debug] [MainThread]: On master: BEGIN
[0m19:13:21.011058 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:21.011058 [debug] [MainThread]: On master: COMMIT
[0m19:13:21.011058 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:21.011058 [debug] [MainThread]: On master: COMMIT
[0m19:13:21.011058 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:21.011058 [debug] [MainThread]: On master: Close
[0m19:13:21.011058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:21.011058 [info ] [MainThread]: 
[0m19:13:21.011058 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m19:13:21.011058 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.user_purchases_model ........................... [RUN]
[0m19:13:21.011058 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m19:13:21.024770 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m19:13:21.029298 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m19:13:21.029298 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 19:13:21.024770 => 19:13:21.029298
[0m19:13:21.029298 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m19:13:21.062560 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m19:13:21.062560 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:13:21.062560 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m19:13:21.077851 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:13:21.096791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:13:21.096791 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:13:21.111203 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."dbt"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."dbt"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."dbt"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."dbt"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:13:21.113222 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt.users_model" does not exist
LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                      ^

[0m19:13:21.114222 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: ROLLBACK
[0m19:13:21.116221 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 19:13:21.029298 => 19:13:21.115213
[0m19:13:21.116221 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m19:13:21.121211 [debug] [Thread-1  ]: Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.users_model" does not exist
  LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                        ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:13:21.121211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d97ae0-583c-496f-997d-5163df8c442e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B9E3550>]}
[0m19:13:21.122211 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.user_purchases_model .................. [[31mERROR[0m in 0.11s]
[0m19:13:21.124229 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m19:13:21.126211 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:21.126211 [debug] [MainThread]: On master: BEGIN
[0m19:13:21.127211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:21.149309 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:21.149309 [debug] [MainThread]: On master: COMMIT
[0m19:13:21.149309 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:21.149309 [debug] [MainThread]: On master: COMMIT
[0m19:13:21.149309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:21.161227 [debug] [MainThread]: On master: Close
[0m19:13:21.162244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:21.163226 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:13:21.164104 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:13:21.164104 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m19:13:21.164104 [info ] [MainThread]: 
[0m19:13:21.164104 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m19:13:21.164104 [debug] [MainThread]: Command end result
[0m19:13:21.179191 [info ] [MainThread]: 
[0m19:13:21.180603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:21.180603 [info ] [MainThread]: 
[0m19:13:21.180603 [error] [MainThread]:   Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.users_model" does not exist
  LINE 19:     select username, user_id, userphone from "userdb"."dbt"....
                                                        ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:13:21.180603 [info ] [MainThread]: 
[0m19:13:21.180603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:13:21.180603 [debug] [MainThread]: Command `dbt run` failed at 19:13:21.180603 after 1.44 seconds
[0m19:13:21.180603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C584F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B23B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BC05BE0>]}
[0m19:13:21.180603 [debug] [MainThread]: Flushing usage events
[0m19:13:29.148058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294196F6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941BC3A670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941BC3AFD0>]}


============================== 19:13:29.148058 | 8bf56578-c59b-4348-9272-5aa19ed0ea53 ==============================
[0m19:13:29.148058 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:13:29.148058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model users_model', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:13:29.454339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941BBDAB50>]}
[0m19:13:29.599998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C010190>]}
[0m19:13:29.599998 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:13:29.599998 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:13:29.694807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:29.694807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:29.694807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C5B77F0>]}
[0m19:13:29.711742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C4F7580>]}
[0m19:13:29.711742 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:13:29.711742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C4F7760>]}
[0m19:13:29.711742 [info ] [MainThread]: 
[0m19:13:29.711742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:29.727782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:13:29.732871 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:13:29.732871 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:13:29.732871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:29.766201 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:13:29.766201 [debug] [ThreadPool]: On list_userdb: Close
[0m19:13:29.766201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:13:29.766201 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:29.777722 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:13:29.778722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:29.797563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:29.810671 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:29.811679 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:13:29.815699 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:13:29.817690 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:13:29.819410 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:13:29.825390 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:29.826393 [debug] [MainThread]: On master: BEGIN
[0m19:13:29.826393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:29.844589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:29.844589 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:29.844589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:29.860224 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:13:29.860224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C4F71F0>]}
[0m19:13:29.860224 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:29.860224 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:29.860224 [debug] [MainThread]: On master: BEGIN
[0m19:13:29.860224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:29.860224 [debug] [MainThread]: On master: COMMIT
[0m19:13:29.860224 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:29.875861 [debug] [MainThread]: On master: COMMIT
[0m19:13:29.875861 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:29.875861 [debug] [MainThread]: On master: Close
[0m19:13:29.875861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:29.875861 [info ] [MainThread]: 
[0m19:13:29.875861 [debug] [Thread-1  ]: Began running node model.users_project.users_model
[0m19:13:29.875861 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.users_model .................................... [RUN]
[0m19:13:29.875861 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.users_model'
[0m19:13:29.887798 [debug] [Thread-1  ]: Began compiling node model.users_project.users_model
[0m19:13:29.896951 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.users_model"
[0m19:13:29.897944 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (compile): 19:13:29.887798 => 19:13:29.897944
[0m19:13:29.898949 [debug] [Thread-1  ]: Began executing node model.users_project.users_model
[0m19:13:29.930755 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.users_model"
[0m19:13:29.930755 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:13:29.930755 [debug] [Thread-1  ]: On model.users_project.users_model: BEGIN
[0m19:13:29.930755 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:13:29.959117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:13:29.960117 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:13:29.960117 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */

  create view "userdb"."dbt"."users_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select u.user_id, u.first_name, u.last_name, ph.mobile, cr.model, cr.price
    from users u
    inner join user_phones ph on u.user_id = ph.user_id
    inner join user_cars cr on u.user_id = cr.user_id

), trans_data as (

    select source_data.user_id, CONCAT(source_data.first_name, '  ', source_data.last_name) as username, 
            CONCAT('mobile ', ' ' , source_data.mobile) as userphone
    from source_data        
)

select * from trans_data


    

    

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:13:29.964117 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:29.972117 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:13:29.972117 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */
alter table "userdb"."dbt"."users_model__dbt_tmp" rename to "users_model"
[0m19:13:29.975117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:29.991117 [debug] [Thread-1  ]: On model.users_project.users_model: COMMIT
[0m19:13:29.992119 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:13:29.992119 [debug] [Thread-1  ]: On model.users_project.users_model: COMMIT
[0m19:13:29.996117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:13:30.001876 [debug] [Thread-1  ]: Applying DROP to: "userdb"."dbt"."users_model__dbt_backup"
[0m19:13:30.001876 [debug] [Thread-1  ]: Using postgres connection "model.users_project.users_model"
[0m19:13:30.001876 [debug] [Thread-1  ]: On model.users_project.users_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.users_model"} */
drop view if exists "userdb"."dbt"."users_model__dbt_backup" cascade
[0m19:13:30.001876 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:30.001876 [debug] [Thread-1  ]: Timing info for model.users_project.users_model (execute): 19:13:29.899948 => 19:13:30.001876
[0m19:13:30.001876 [debug] [Thread-1  ]: On model.users_project.users_model: Close
[0m19:13:30.001876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bf56578-c59b-4348-9272-5aa19ed0ea53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C605460>]}
[0m19:13:30.001876 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.users_model ............................... [[32mCREATE VIEW[0m in 0.13s]
[0m19:13:30.017506 [debug] [Thread-1  ]: Finished running node model.users_project.users_model
[0m19:13:30.017506 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:30.017506 [debug] [MainThread]: On master: BEGIN
[0m19:13:30.017506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:30.047093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:30.047093 [debug] [MainThread]: On master: COMMIT
[0m19:13:30.047093 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:30.047093 [debug] [MainThread]: On master: COMMIT
[0m19:13:30.047093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:30.047093 [debug] [MainThread]: On master: Close
[0m19:13:30.047093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:30.047093 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:13:30.047093 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:13:30.047093 [debug] [MainThread]: Connection 'model.users_project.users_model' was properly closed.
[0m19:13:30.047093 [info ] [MainThread]: 
[0m19:13:30.047093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:13:30.047093 [debug] [MainThread]: Command end result
[0m19:13:30.063346 [info ] [MainThread]: 
[0m19:13:30.063346 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:30.063346 [info ] [MainThread]: 
[0m19:13:30.063346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:13:30.063346 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:30.063346 after 0.99 seconds
[0m19:13:30.063346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294196F6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C1369A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002941C179700>]}
[0m19:13:30.063346 [debug] [MainThread]: Flushing usage events
[0m19:13:37.944109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022014F68AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220174CB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220174CBD90>]}


============================== 19:13:37.959418 | 8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d ==============================
[0m19:13:37.959418 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:13:37.959418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model user_purchases_model', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:38.257746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017466A30>]}
[0m19:13:38.398200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017C784C0>]}
[0m19:13:38.398200 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:13:38.413838 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:13:38.511669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:38.511669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:38.511669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017E37880>]}
[0m19:13:38.527318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017D77670>]}
[0m19:13:38.527318 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:13:38.527318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017D77820>]}
[0m19:13:38.527318 [info ] [MainThread]: 
[0m19:13:38.527318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:38.527318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:13:38.549159 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:13:38.549159 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:13:38.549159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:38.565519 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:13:38.565519 [debug] [ThreadPool]: On list_userdb: Close
[0m19:13:38.565519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:13:38.580997 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:38.580997 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:13:38.580997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:38.595984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:38.610200 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:13:38.611211 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:13:38.615207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:13:38.617206 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:13:38.619210 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:13:38.626211 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.626211 [debug] [MainThread]: On master: BEGIN
[0m19:13:38.627201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:38.644729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:38.644729 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.644729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:38.660365 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:13:38.660365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017E1F670>]}
[0m19:13:38.660365 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:38.660365 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.660365 [debug] [MainThread]: On master: BEGIN
[0m19:13:38.660365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:38.660365 [debug] [MainThread]: On master: COMMIT
[0m19:13:38.660365 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.660365 [debug] [MainThread]: On master: COMMIT
[0m19:13:38.676001 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:38.676001 [debug] [MainThread]: On master: Close
[0m19:13:38.676001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:38.676001 [info ] [MainThread]: 
[0m19:13:38.676001 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m19:13:38.676001 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.user_purchases_model ........................... [RUN]
[0m19:13:38.676001 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m19:13:38.688162 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m19:13:38.695629 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m19:13:38.695629 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 19:13:38.688162 => 19:13:38.695629
[0m19:13:38.695629 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m19:13:38.733591 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m19:13:38.733591 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:13:38.733591 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m19:13:38.733591 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:13:38.764075 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:13:38.777002 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:13:38.778009 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."dbt"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."dbt"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."dbt"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."dbt"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:13:38.780018 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt.purchases_model" does not exist
LINE 27:     inner join "userdb"."dbt"."purchases_model" up on s.user...
                        ^

[0m19:13:38.781026 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: ROLLBACK
[0m19:13:38.783010 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 19:13:38.695629 => 19:13:38.783010
[0m19:13:38.784008 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m19:13:38.788018 [debug] [Thread-1  ]: Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.purchases_model" does not exist
  LINE 27:     inner join "userdb"."dbt"."purchases_model" up on s.user...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:13:38.789008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee54e7f-44cf-46e0-9dd1-2de78dc1de8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017EBF0A0>]}
[0m19:13:38.790018 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.user_purchases_model .................. [[31mERROR[0m in 0.11s]
[0m19:13:38.792008 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m19:13:38.795010 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.796010 [debug] [MainThread]: On master: BEGIN
[0m19:13:38.797023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:38.815884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:38.815884 [debug] [MainThread]: On master: COMMIT
[0m19:13:38.815884 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:38.827049 [debug] [MainThread]: On master: COMMIT
[0m19:13:38.829052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:38.829768 [debug] [MainThread]: On master: Close
[0m19:13:38.829768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:38.829768 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:13:38.829768 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:13:38.829768 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m19:13:38.829768 [info ] [MainThread]: 
[0m19:13:38.829768 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:13:38.829768 [debug] [MainThread]: Command end result
[0m19:13:38.852105 [info ] [MainThread]: 
[0m19:13:38.852105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:38.852105 [info ] [MainThread]: 
[0m19:13:38.852105 [error] [MainThread]:   Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.purchases_model" does not exist
  LINE 27:     inner join "userdb"."dbt"."purchases_model" up on s.user...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:13:38.852105 [info ] [MainThread]: 
[0m19:13:38.852105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:13:38.852105 [debug] [MainThread]: Command `dbt run` failed at 19:13:38.852105 after 0.97 seconds
[0m19:13:38.852105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022014F68AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220179F4EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017E93DF0>]}
[0m19:13:38.860425 [debug] [MainThread]: Flushing usage events
[0m19:14:03.874272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2E2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD53882B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5388CA0>]}


============================== 19:14:03.874272 | 63c92282-d867-4a72-99b7-42529641073e ==============================
[0m19:14:03.874272 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:14:03.874272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model purchases_model', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:04.175854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD53BF2E0>]}
[0m19:14:04.332127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD57146A0>]}
[0m19:14:04.332127 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:14:04.351301 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:14:04.428837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:04.430213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:04.435922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5CF8820>]}
[0m19:14:04.450643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5C225B0>]}
[0m19:14:04.450643 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:14:04.450643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5C22790>]}
[0m19:14:04.450643 [info ] [MainThread]: 
[0m19:14:04.450643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:04.450643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:14:04.475273 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:14:04.476283 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:14:04.477273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:04.494241 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:14:04.494241 [debug] [ThreadPool]: On list_userdb: Close
[0m19:14:04.494241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:14:04.511567 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:04.511567 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:14:04.511567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:04.540576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:04.541569 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:04.541569 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:14:04.546570 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:14:04.548569 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:14:04.550578 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:14:04.557578 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.558715 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.558783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:04.600102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:04.600102 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.600102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:04.600102 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:14:04.600102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5885580>]}
[0m19:14:04.600102 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:04.600102 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.600102 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.615737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:04.615737 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.615737 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.615737 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.615737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:04.615737 [debug] [MainThread]: On master: Close
[0m19:14:04.615737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:04.615737 [info ] [MainThread]: 
[0m19:14:04.615737 [debug] [Thread-1  ]: Began running node model.users_project.purchases_model
[0m19:14:04.615737 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.purchases_model ............................... [RUN]
[0m19:14:04.615737 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.purchases_model'
[0m19:14:04.629614 [debug] [Thread-1  ]: Began compiling node model.users_project.purchases_model
[0m19:14:04.634206 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.purchases_model"
[0m19:14:04.634206 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (compile): 19:14:04.629614 => 19:14:04.634206
[0m19:14:04.634206 [debug] [Thread-1  ]: Began executing node model.users_project.purchases_model
[0m19:14:04.678345 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.purchases_model"
[0m19:14:04.678345 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m19:14:04.678345 [debug] [Thread-1  ]: On model.users_project.purchases_model: BEGIN
[0m19:14:04.678345 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:14:04.706925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:14:04.707928 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m19:14:04.707928 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */

  
    

  create  table "userdb"."dbt"."purchases_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models





with source_data as (
    select
        purchase_id,
        product_id,
        user_id,
        count,
        dt as purchase_date,
        st as purchase_state
    from user_purchases    
)


select * from source_data
  );
  
[0m19:14:04.713933 [debug] [Thread-1  ]: SQL status: SELECT 11 in 0.0 seconds
[0m19:14:04.720944 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m19:14:04.721946 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */
alter table "userdb"."dbt"."purchases_model__dbt_tmp" rename to "purchases_model"
[0m19:14:04.724929 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:04.742634 [debug] [Thread-1  ]: On model.users_project.purchases_model: COMMIT
[0m19:14:04.742634 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m19:14:04.742634 [debug] [Thread-1  ]: On model.users_project.purchases_model: COMMIT
[0m19:14:04.742634 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:14:04.742634 [debug] [Thread-1  ]: Applying DROP to: "userdb"."dbt"."purchases_model__dbt_backup"
[0m19:14:04.758261 [debug] [Thread-1  ]: Using postgres connection "model.users_project.purchases_model"
[0m19:14:04.758261 [debug] [Thread-1  ]: On model.users_project.purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.purchases_model"} */
drop table if exists "userdb"."dbt"."purchases_model__dbt_backup" cascade
[0m19:14:04.758261 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:14:04.758261 [debug] [Thread-1  ]: Timing info for model.users_project.purchases_model (execute): 19:14:04.641940 => 19:14:04.758261
[0m19:14:04.758261 [debug] [Thread-1  ]: On model.users_project.purchases_model: Close
[0m19:14:04.758261 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c92282-d867-4a72-99b7-42529641073e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD5D7CA60>]}
[0m19:14:04.758261 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt.purchases_model .......................... [[32mSELECT 11[0m in 0.14s]
[0m19:14:04.758261 [debug] [Thread-1  ]: Finished running node model.users_project.purchases_model
[0m19:14:04.758261 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.758261 [debug] [MainThread]: On master: BEGIN
[0m19:14:04.758261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:04.803435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:04.804436 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.804436 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:04.805434 [debug] [MainThread]: On master: COMMIT
[0m19:14:04.807437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:04.807437 [debug] [MainThread]: On master: Close
[0m19:14:04.808427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:04.809512 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:14:04.809512 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:14:04.809512 [debug] [MainThread]: Connection 'model.users_project.purchases_model' was properly closed.
[0m19:14:04.809512 [info ] [MainThread]: 
[0m19:14:04.809512 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m19:14:04.809512 [debug] [MainThread]: Command end result
[0m19:14:04.809512 [info ] [MainThread]: 
[0m19:14:04.826302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:04.826817 [info ] [MainThread]: 
[0m19:14:04.826817 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:04.826817 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:04.826817 after 1.03 seconds
[0m19:14:04.826817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD2E2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD58D0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD58A7D60>]}
[0m19:14:04.826817 [debug] [MainThread]: Flushing usage events
[0m19:14:11.026387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A545C69A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5482012B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548201CA0>]}


============================== 19:14:11.026387 | b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2 ==============================
[0m19:14:11.026387 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:14:11.026387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model user_purchases_model', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:11.318685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54823F2E0>]}
[0m19:14:11.459310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5483946A0>]}
[0m19:14:11.474935 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:14:11.474935 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:14:11.565602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:11.565602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:11.571602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548B77820>]}
[0m19:14:11.575623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548AB85B0>]}
[0m19:14:11.575623 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:14:11.575623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548AB8790>]}
[0m19:14:11.575623 [info ] [MainThread]: 
[0m19:14:11.575623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:11.575623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:14:11.602928 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:14:11.603990 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:14:11.603990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:11.630737 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:14:11.642646 [debug] [ThreadPool]: On list_userdb: Close
[0m19:14:11.645632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:14:11.646181 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:11.646181 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:14:11.646181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:11.660207 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:11.674847 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:11.675856 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:14:11.679875 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:14:11.681856 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:14:11.683860 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:14:11.689855 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.690874 [debug] [MainThread]: On master: BEGIN
[0m19:14:11.690874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:11.709185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:11.709185 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.709185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:11.728870 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:14:11.731390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548704580>]}
[0m19:14:11.731390 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:11.731390 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.731390 [debug] [MainThread]: On master: BEGIN
[0m19:14:11.731390 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:11.731390 [debug] [MainThread]: On master: COMMIT
[0m19:14:11.731390 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.731390 [debug] [MainThread]: On master: COMMIT
[0m19:14:11.731390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:11.731390 [debug] [MainThread]: On master: Close
[0m19:14:11.731390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:11.731390 [info ] [MainThread]: 
[0m19:14:11.747033 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m19:14:11.747033 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.user_purchases_model ........................... [RUN]
[0m19:14:11.747033 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m19:14:11.751483 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m19:14:11.761156 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m19:14:11.763134 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 19:14:11.751483 => 19:14:11.762156
[0m19:14:11.764091 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m19:14:11.795114 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m19:14:11.795114 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:11.795114 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m19:14:11.795114 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:14:11.810864 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:14:11.824869 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:11.824869 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."dbt"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."dbt"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."dbt"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."dbt"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:14:11.827867 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dbt.products_model" does not exist
LINE 28:     inner join "userdb"."dbt"."products_model" p on up.produ...
                        ^

[0m19:14:11.828876 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: ROLLBACK
[0m19:14:11.830868 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 19:14:11.764091 => 19:14:11.830868
[0m19:14:11.831878 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m19:14:11.835869 [debug] [Thread-1  ]: Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.products_model" does not exist
  LINE 28:     inner join "userdb"."dbt"."products_model" p on up.produ...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:14:11.836868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a80e23-69d5-4793-a9c5-9b7ace3bb8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548BFD220>]}
[0m19:14:11.837870 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.user_purchases_model .................. [[31mERROR[0m in 0.09s]
[0m19:14:11.839870 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m19:14:11.841877 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.841877 [debug] [MainThread]: On master: BEGIN
[0m19:14:11.842879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:11.858364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:11.858364 [debug] [MainThread]: On master: COMMIT
[0m19:14:11.874002 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:11.874002 [debug] [MainThread]: On master: COMMIT
[0m19:14:11.876011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:11.877012 [debug] [MainThread]: On master: Close
[0m19:14:11.878008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:11.879010 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:14:11.879010 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:14:11.879862 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m19:14:11.879862 [info ] [MainThread]: 
[0m19:14:11.879862 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:14:11.879862 [debug] [MainThread]: Command end result
[0m19:14:11.894307 [info ] [MainThread]: 
[0m19:14:11.894307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:14:11.894307 [info ] [MainThread]: 
[0m19:14:11.894307 [error] [MainThread]:   Database Error in model user_purchases_model (models\example\user_purchases_model.sql)
  relation "dbt.products_model" does not exist
  LINE 28:     inner join "userdb"."dbt"."products_model" p on up.produ...
                          ^
  compiled Code at target\run\users_project\models\example\user_purchases_model.sql
[0m19:14:11.894307 [info ] [MainThread]: 
[0m19:14:11.894307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:14:11.894307 [debug] [MainThread]: Command `dbt run` failed at 19:14:11.894307 after 0.95 seconds
[0m19:14:11.894307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A545C69A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548727D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A548AB84F0>]}
[0m19:14:11.894307 [debug] [MainThread]: Flushing usage events
[0m19:14:27.224070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C0E0FAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C33CCAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C33BAF70>]}


============================== 19:14:27.239852 | 619bd1bb-2c44-4447-8e98-164dbafaa28d ==============================
[0m19:14:27.239852 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:14:27.239852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --model products_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:27.524106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C04F9430>]}
[0m19:14:27.671504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3868190>]}
[0m19:14:27.671504 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:14:27.687156 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:14:27.771313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:27.771313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:27.777300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3D38790>]}
[0m19:14:27.789306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3C62520>]}
[0m19:14:27.790293 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:14:27.790751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3C62700>]}
[0m19:14:27.790751 [info ] [MainThread]: 
[0m19:14:27.790751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:27.790751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:14:27.807736 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:14:27.808743 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:14:27.809742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:27.829744 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:14:27.829744 [debug] [ThreadPool]: On list_userdb: Close
[0m19:14:27.829744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:14:27.843757 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:27.843757 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:14:27.843757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:27.860057 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:27.873894 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:27.873894 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:14:27.877893 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:14:27.879902 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:14:27.881892 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:14:27.888910 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:27.889913 [debug] [MainThread]: On master: BEGIN
[0m19:14:27.889913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:27.908972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:27.908972 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:27.908972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:27.924609 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:14:27.924609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3D1F2E0>]}
[0m19:14:27.924609 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:27.924609 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:27.924609 [debug] [MainThread]: On master: BEGIN
[0m19:14:27.924609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:27.924609 [debug] [MainThread]: On master: COMMIT
[0m19:14:27.924609 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:27.924609 [debug] [MainThread]: On master: COMMIT
[0m19:14:27.924609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:27.924609 [debug] [MainThread]: On master: Close
[0m19:14:27.940243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:27.940243 [info ] [MainThread]: 
[0m19:14:27.940243 [debug] [Thread-1  ]: Began running node model.users_project.products_model
[0m19:14:27.940243 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.products_model ................................ [RUN]
[0m19:14:27.940243 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.products_model'
[0m19:14:27.949543 [debug] [Thread-1  ]: Began compiling node model.users_project.products_model
[0m19:14:27.958204 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.products_model"
[0m19:14:27.960186 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (compile): 19:14:27.950549 => 19:14:27.959193
[0m19:14:27.960186 [debug] [Thread-1  ]: Began executing node model.users_project.products_model
[0m19:14:27.993647 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.products_model"
[0m19:14:27.993647 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m19:14:27.993647 [debug] [Thread-1  ]: On model.users_project.products_model: BEGIN
[0m19:14:27.993647 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:14:28.039063 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:14:28.040066 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m19:14:28.040066 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */

  
    

  create  table "userdb"."dbt"."products_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models





with source_data as (
    select
    
        product_id,
        item,
        price
    from products    
)


select * from source_data
  );
  
[0m19:14:28.054089 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.0 seconds
[0m19:14:28.057144 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m19:14:28.057144 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */
alter table "userdb"."dbt"."products_model__dbt_tmp" rename to "products_model"
[0m19:14:28.057144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:28.072783 [debug] [Thread-1  ]: On model.users_project.products_model: COMMIT
[0m19:14:28.072783 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m19:14:28.072783 [debug] [Thread-1  ]: On model.users_project.products_model: COMMIT
[0m19:14:28.088424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:14:28.088424 [debug] [Thread-1  ]: Applying DROP to: "userdb"."dbt"."products_model__dbt_backup"
[0m19:14:28.088424 [debug] [Thread-1  ]: Using postgres connection "model.users_project.products_model"
[0m19:14:28.088424 [debug] [Thread-1  ]: On model.users_project.products_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.products_model"} */
drop table if exists "userdb"."dbt"."products_model__dbt_backup" cascade
[0m19:14:28.104019 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:14:28.104019 [debug] [Thread-1  ]: Timing info for model.users_project.products_model (execute): 19:14:27.961194 => 19:14:28.104019
[0m19:14:28.104019 [debug] [Thread-1  ]: On model.users_project.products_model: Close
[0m19:14:28.104019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619bd1bb-2c44-4447-8e98-164dbafaa28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C3DA6FA0>]}
[0m19:14:28.104019 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt.products_model ........................... [[32mSELECT 4[0m in 0.16s]
[0m19:14:28.104019 [debug] [Thread-1  ]: Finished running node model.users_project.products_model
[0m19:14:28.104019 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:28.104019 [debug] [MainThread]: On master: BEGIN
[0m19:14:28.104019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:28.126358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:28.126358 [debug] [MainThread]: On master: COMMIT
[0m19:14:28.126358 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:28.126358 [debug] [MainThread]: On master: COMMIT
[0m19:14:28.126358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:28.126358 [debug] [MainThread]: On master: Close
[0m19:14:28.126358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:28.126358 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:14:28.126358 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:14:28.126358 [debug] [MainThread]: Connection 'model.users_project.products_model' was properly closed.
[0m19:14:28.140604 [info ] [MainThread]: 
[0m19:14:28.141641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m19:14:28.141641 [debug] [MainThread]: Command end result
[0m19:14:28.141641 [info ] [MainThread]: 
[0m19:14:28.141641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:28.157158 [info ] [MainThread]: 
[0m19:14:28.158063 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:28.158063 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:28.158063 after 1.00 seconds
[0m19:14:28.158063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C0E0FAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C378D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C38E8EB0>]}
[0m19:14:28.158063 [debug] [MainThread]: Flushing usage events
[0m19:14:35.350326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF92276A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94A082E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94A08D00>]}


============================== 19:14:35.350326 | 67e2f5b8-c127-49ce-965d-d6f08dcc1599 ==============================
[0m19:14:35.350326 [info ] [MainThread]: Running with dbt=1.7.2
[0m19:14:35.350326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --model user_purchases_model', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:35.644741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94A3F310>]}
[0m19:14:35.800995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94B946A0>]}
[0m19:14:35.800995 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m19:14:35.800995 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m19:14:35.890385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:35.890385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:35.890385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF95178820>]}
[0m19:14:35.906037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF950B85B0>]}
[0m19:14:35.906037 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:14:35.906037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF950B8790>]}
[0m19:14:35.906037 [info ] [MainThread]: 
[0m19:14:35.906037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:35.906037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb'
[0m19:14:35.931312 [debug] [ThreadPool]: Using postgres connection "list_userdb"
[0m19:14:35.932312 [debug] [ThreadPool]: On list_userdb: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb"} */

    select distinct nspname from pg_namespace
  
[0m19:14:35.932312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:35.973416 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:14:35.974532 [debug] [ThreadPool]: On list_userdb: Close
[0m19:14:35.974532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_userdb_dbt'
[0m19:14:35.974532 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:35.974532 [debug] [ThreadPool]: On list_userdb_dbt: BEGIN
[0m19:14:35.974532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:35.991824 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:35.991824 [debug] [ThreadPool]: Using postgres connection "list_userdb_dbt"
[0m19:14:35.991824 [debug] [ThreadPool]: On list_userdb_dbt: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "list_userdb_dbt"} */
select
      'userdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'userdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:14:36.008286 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:14:36.008286 [debug] [ThreadPool]: On list_userdb_dbt: ROLLBACK
[0m19:14:36.008286 [debug] [ThreadPool]: On list_userdb_dbt: Close
[0m19:14:36.008286 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.008286 [debug] [MainThread]: On master: BEGIN
[0m19:14:36.008286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:36.024777 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:36.024777 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.040056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:36.048083 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:14:36.049083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94D04580>]}
[0m19:14:36.050064 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:36.052082 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.053075 [debug] [MainThread]: On master: BEGIN
[0m19:14:36.057058 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:36.058055 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.058055 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.059056 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.061073 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:36.061073 [debug] [MainThread]: On master: Close
[0m19:14:36.062107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:36.064105 [info ] [MainThread]: 
[0m19:14:36.068404 [debug] [Thread-1  ]: Began running node model.users_project.user_purchases_model
[0m19:14:36.069427 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.user_purchases_model ........................... [RUN]
[0m19:14:36.071429 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.users_project.user_purchases_model'
[0m19:14:36.071429 [debug] [Thread-1  ]: Began compiling node model.users_project.user_purchases_model
[0m19:14:36.078956 [debug] [Thread-1  ]: Writing injected SQL for node "model.users_project.user_purchases_model"
[0m19:14:36.078956 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (compile): 19:14:36.072427 => 19:14:36.078956
[0m19:14:36.078956 [debug] [Thread-1  ]: Began executing node model.users_project.user_purchases_model
[0m19:14:36.109867 [debug] [Thread-1  ]: Writing runtime sql for node "model.users_project.user_purchases_model"
[0m19:14:36.123858 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:36.124856 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: BEGIN
[0m19:14:36.125856 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:14:36.154457 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:14:36.155449 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:36.155449 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */

  create view "userdb"."dbt"."user_purchases_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with user_data as (

    select username, user_id, userphone from "userdb"."dbt"."users_model"

), ranked_data as (

    select s.username, s.user_id, s.userphone, up.count * p.price as userspent, 
    RANK() OVER (PARTITION BY up.purchase_state ORDER BY up.count * p.price DESC) 

    from user_data s
    inner join "userdb"."dbt"."purchases_model" up on s.user_id = up.user_id
    inner join "userdb"."dbt"."products_model" p on up.product_id = p.product_id

)

select * from ranked_data



/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:14:36.159457 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:36.167449 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:36.167449 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */
alter table "userdb"."dbt"."user_purchases_model__dbt_tmp" rename to "user_purchases_model"
[0m19:14:36.170456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:36.174532 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: COMMIT
[0m19:14:36.174532 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:36.174532 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: COMMIT
[0m19:14:36.190346 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:14:36.190346 [debug] [Thread-1  ]: Applying DROP to: "userdb"."dbt"."user_purchases_model__dbt_backup"
[0m19:14:36.190346 [debug] [Thread-1  ]: Using postgres connection "model.users_project.user_purchases_model"
[0m19:14:36.190346 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "node_id": "model.users_project.user_purchases_model"} */
drop view if exists "userdb"."dbt"."user_purchases_model__dbt_backup" cascade
[0m19:14:36.205794 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:36.205794 [debug] [Thread-1  ]: Timing info for model.users_project.user_purchases_model (execute): 19:14:36.078956 => 19:14:36.205794
[0m19:14:36.205794 [debug] [Thread-1  ]: On model.users_project.user_purchases_model: Close
[0m19:14:36.205794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e2f5b8-c127-49ce-965d-d6f08dcc1599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF95206520>]}
[0m19:14:36.205794 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.user_purchases_model ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:14:36.205794 [debug] [Thread-1  ]: Finished running node model.users_project.user_purchases_model
[0m19:14:36.205794 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.205794 [debug] [MainThread]: On master: BEGIN
[0m19:14:36.205794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:36.235784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:36.236784 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.236784 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.237783 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.239792 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:36.239792 [debug] [MainThread]: On master: Close
[0m19:14:36.240844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:36.240844 [debug] [MainThread]: Connection 'list_userdb' was properly closed.
[0m19:14:36.240844 [debug] [MainThread]: Connection 'list_userdb_dbt' was properly closed.
[0m19:14:36.240844 [debug] [MainThread]: Connection 'model.users_project.user_purchases_model' was properly closed.
[0m19:14:36.240844 [info ] [MainThread]: 
[0m19:14:36.240844 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:14:36.240844 [debug] [MainThread]: Command end result
[0m19:14:36.257802 [info ] [MainThread]: 
[0m19:14:36.257802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:36.257802 [info ] [MainThread]: 
[0m19:14:36.257802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:36.257802 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:36.257802 after 0.98 seconds
[0m19:14:36.257802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF92276A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF94B946A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9515FD60>]}
[0m19:14:36.257802 [debug] [MainThread]: Flushing usage events
[0m07:59:32.215297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C117536A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C119AAE4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C119AAEC40>]}


============================== 07:59:32.220295 | 8070f58b-4f0a-4027-a993-f4191ba75be3 ==============================
[0m07:59:32.220295 [info ] [MainThread]: Running with dbt=1.7.2
[0m07:59:32.221297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:59:32.900506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8070f58b-4f0a-4027-a993-f4191ba75be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C119A66F10>]}
[0m07:59:33.050508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8070f58b-4f0a-4027-a993-f4191ba75be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A0A1C40>]}
[0m07:59:33.057509 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m07:59:33.075517 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m07:59:33.956603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:33.957603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:33.963603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8070f58b-4f0a-4027-a993-f4191ba75be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A4355E0>]}
[0m07:59:33.993686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8070f58b-4f0a-4027-a993-f4191ba75be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A146430>]}
[0m07:59:33.994702 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:59:33.995478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8070f58b-4f0a-4027-a993-f4191ba75be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A146550>]}
[0m07:59:33.998500 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m07:59:33.999519 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m07:59:34.000500 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m07:59:34.000500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:34.051392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:34.051392 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m07:59:34.052403 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m07:59:34.052403 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m07:59:34.054413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:34.055404 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m07:59:34.056404 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package
[0m07:59:34.086420 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\task\run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
  File "C:\Users\raikh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\dbt\adapters\base\impl.py", line 1091, in execute_macro
    raise DbtRuntimeError(
dbt.exceptions.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "generate_model_yaml" in any package

[0m07:59:34.087428 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'generate_model_yaml' in any package
[0m07:59:34.090426 [debug] [MainThread]: Command `dbt run-operation` failed at 07:59:34.090426 after 1.97 seconds
[0m07:59:34.091442 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m07:59:34.091442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C117536A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A41EB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C11A41ECD0>]}
[0m07:59:34.092438 [debug] [MainThread]: Flushing usage events
[0m08:08:05.245912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B4F991A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B52107880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B520FFD00>]}


============================== 08:08:05.252004 | f6d98297-ac56-4421-897f-2be2e5caf8b8 ==============================
[0m08:08:05.252004 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:08:05.252923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:08:05.478923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d98297-ac56-4421-897f-2be2e5caf8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B520FF2E0>]}
[0m08:08:05.479927 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:08:05.483905 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:08:05.485905 [debug] [MainThread]: Command `dbt deps` succeeded at 08:08:05.484905 after 0.32 seconds
[0m08:08:05.485905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B4F991A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B5218BBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B52114DC0>]}
[0m08:08:05.486903 [debug] [MainThread]: Flushing usage events
[0m08:09:09.979376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB227F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24F7E430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24F7EA30>]}


============================== 08:09:09.983395 | 47b2175b-5c6d-4628-9946-cbfd69ad2206 ==============================
[0m08:09:09.983395 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:09:09.985395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:09:10.165389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b2175b-5c6d-4628-9946-cbfd69ad2206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24F7ECA0>]}
[0m08:09:10.166394 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:09:10.169376 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:09:10.171378 [debug] [MainThread]: Command `dbt deps` succeeded at 08:09:10.171378 after 0.27 seconds
[0m08:09:10.172376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB227F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB25211CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24FB1130>]}
[0m08:09:10.172376 [debug] [MainThread]: Flushing usage events
[0m08:10:53.725619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B80386A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B82B0C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B82AF9D00>]}


============================== 08:10:53.729628 | b2d00b05-ccd0-45a2-abe8-f00adc4dee2c ==============================
[0m08:10:53.729628 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:10:53.731616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:10:53.912616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d00b05-ccd0-45a2-abe8-f00adc4dee2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B82AF92E0>]}
[0m08:10:53.914634 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:10:53.916610 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:10:53.918616 [debug] [MainThread]: Command `dbt deps` succeeded at 08:10:53.917616 after 0.27 seconds
[0m08:10:53.918616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B80386A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B82ABB640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B82B8EBE0>]}
[0m08:10:53.919615 [debug] [MainThread]: Flushing usage events
[0m08:11:31.662523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FF2F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A18187CD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A18187CDF0>]}


============================== 08:11:31.666534 | b0ca1f3b-50a1-4c44-a539-1e1af27498e8 ==============================
[0m08:11:31.666534 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:11:31.668532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:11:31.854533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0ca1f3b-50a1-4c44-a539-1e1af27498e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A18187CA60>]}
[0m08:11:31.857518 [debug] [MainThread]: Set downloads directory='C:\Users\raikh\AppData\Local\Temp\dbt-downloads-el9ac6pp'
[0m08:11:31.858523 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:11:32.620244 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:11:32.623222 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m08:11:33.256247 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m08:11:33.260268 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/codegen
  Requested range: =1.7.2, =1.7.2
  Compatible versions: ['0.0.1', '0.0.2', '0.0.3', '0.0.4', '0.1.0', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.4.0', '0.5.0', '0.6.0', '0.7.0', '0.8.0', '0.8.1', '0.9.0', '0.10.0', '0.11.0', '0.12.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m08:11:33.263243 [debug] [MainThread]: Command `dbt deps` failed at 08:11:33.263243 after 1.68 seconds
[0m08:11:33.263243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1FF2F6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1819C8B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1819C82E0>]}
[0m08:11:33.264245 [debug] [MainThread]: Flushing usage events
[0m08:12:20.567210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BC86CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEDC81F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEDA7D00>]}


============================== 08:12:20.571210 | cd4f3256-7692-401b-81f7-84c6d369f2e9 ==============================
[0m08:12:20.571210 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:12:20.573208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:12:20.757217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4f3256-7692-401b-81f7-84c6d369f2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BEDA78E0>]}
[0m08:12:20.760218 [debug] [MainThread]: Set downloads directory='C:\Users\raikh\AppData\Local\Temp\dbt-downloads-b_i_ac7t'
[0m08:12:20.761210 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:12:21.406260 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:12:21.408249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m08:12:22.052984 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m08:12:22.056998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:12:22.699862 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:12:22.713864 [info ] [MainThread]: Updating lock file in file path: C:\Users\raikh\VscodeProjects\dbt_app\users_project/package-lock.yml
[0m08:12:22.729599 [debug] [MainThread]: Set downloads directory='C:\Users\raikh\AppData\Local\Temp\dbt-downloads-r83504t5'
[0m08:12:22.734574 [info ] [MainThread]: Installing dbt-labs/codegen
[0m08:12:23.467519 [info ] [MainThread]: Installed from version 0.11.0
[0m08:12:23.468518 [info ] [MainThread]: Updated version available: 0.12.0
[0m08:12:23.469518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd4f3256-7692-401b-81f7-84c6d369f2e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF112970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF1126A0>]}
[0m08:12:23.470519 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:12:24.412034 [info ] [MainThread]: Installed from version 1.1.1
[0m08:12:24.413038 [info ] [MainThread]: Up to date!
[0m08:12:24.414034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd4f3256-7692-401b-81f7-84c6d369f2e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF112970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF140280>]}
[0m08:12:24.414034 [info ] [MainThread]: 
[0m08:12:24.415035 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m08:12:24.419039 [debug] [MainThread]: Command `dbt deps` succeeded at 08:12:24.418037 after 3.95 seconds
[0m08:12:24.419039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BC86CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF050A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BF068D00>]}
[0m08:12:24.420042 [debug] [MainThread]: Flushing usage events
[0m08:12:55.794487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ECD36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EF28F1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EF267D00>]}


============================== 08:12:55.798479 | 32ecbe44-939a-41d5-bde9-0d90bd51f5d1 ==============================
[0m08:12:55.798479 [info ] [MainThread]: Running with dbt=1.7.2
[0m08:12:55.800487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:12:56.114486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EF226F10>]}
[0m08:12:56.265143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EF6E0190>]}
[0m08:12:56.266143 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m08:12:56.323699 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m08:12:56.339375 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:12:56.340390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EFA23A30>]}
[0m08:12:58.596694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F04E1EE0>]}
[0m08:12:58.615694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F00FD340>]}
[0m08:12:58.616696 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m08:12:58.617984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ecbe44-939a-41d5-bde9-0d90bd51f5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F01A8910>]}
[0m08:12:58.621116 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m08:12:58.622024 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m08:12:58.623004 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m08:12:58.623004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:58.666005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:12:58.667004 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m08:12:58.667004 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m08:12:58.668004 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m08:12:58.670023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:12:58.690994 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m08:12:58.692000 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m08:12:58.694005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:12:58.694996 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m08:12:58.694996 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m08:12:58.704059 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m08:12:58.720058 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m08:12:58.724510 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m08:12:58.726501 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m08:12:58.730524 [debug] [MainThread]: Command `dbt run-operation` succeeded at 08:12:58.730524 after 3.01 seconds
[0m08:12:58.730524 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m08:12:58.731513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7ECD36A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7EF6E0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F04A1580>]}
[0m08:12:58.732525 [debug] [MainThread]: Flushing usage events
[0m06:44:46.429124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C74B29A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C7708C1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C7707FD00>]}


============================== 06:44:46.460414 | b4ae560e-3ae1-4c6b-92b0-b8d28e81d822 ==============================
[0m06:44:46.460414 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:44:46.460414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:47.122835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4ae560e-3ae1-4c6b-92b0-b8d28e81d822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C77026F10>]}
[0m06:44:47.286123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4ae560e-3ae1-4c6b-92b0-b8d28e81d822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C774E7190>]}
[0m06:44:47.292634 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:44:47.339525 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:44:48.628643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:48.628643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:48.644260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4ae560e-3ae1-4c6b-92b0-b8d28e81d822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C77A71D30>]}
[0m06:44:48.676912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4ae560e-3ae1-4c6b-92b0-b8d28e81d822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C779A3970>]}
[0m06:44:48.676912 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:44:48.676912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4ae560e-3ae1-4c6b-92b0-b8d28e81d822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C779A3BB0>]}
[0m06:44:48.676912 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:44:48.676912 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:44:48.676912 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:44:48.676912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:44:48.722843 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:44:48.722843 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:44:48.722843 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:44:48.722843 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:44:48.722843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:44:48.738494 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:44:48.754110 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:44:48.754110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:44:48.754110 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:44:48.754110 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:44:48.754110 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:44:48.769728 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:44:48.769728 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:44:48.769728 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:44:48.785336 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:44:48.785336 after 2.45 seconds
[0m06:44:48.785336 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:44:48.785336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C74B29A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C77AA4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C779A3BB0>]}
[0m06:44:48.785336 [debug] [MainThread]: Flushing usage events
[0m06:48:22.287509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E2A36A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E51B9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E51B9C40>]}


============================== 06:48:22.287509 | 4448d095-016d-4f1f-8f93-60878bc72ead ==============================
[0m06:48:22.287509 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:48:22.287509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --quiet --args {"model_names": ["users_model"]}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:48:22.677356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4448d095-016d-4f1f-8f93-60878bc72ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E5200160>]}
[0m06:48:22.827377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4448d095-016d-4f1f-8f93-60878bc72ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E55A2CD0>]}
[0m06:48:22.829360 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:48:22.856357 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:48:23.066360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:48:23.066360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:48:23.073361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4448d095-016d-4f1f-8f93-60878bc72ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E59B1D60>]}
[0m06:48:23.090359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4448d095-016d-4f1f-8f93-60878bc72ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E58E3A00>]}
[0m06:48:23.091358 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:48:23.092358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4448d095-016d-4f1f-8f93-60878bc72ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E58E3C40>]}
[0m06:48:23.094357 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:48:23.094357 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:48:23.095361 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:48:23.095361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:48:23.126357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:48:23.126357 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:48:23.127358 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:48:23.127358 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:48:23.129357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:48:23.148357 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:48:23.149359 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:48:23.151357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:48:23.152358 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:48:23.152358 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:48:23.161356 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:48:23.176358 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:48:23.177359 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:48:23.179358 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:48:23.183364 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:48:23.182359 after 0.96 seconds
[0m06:48:23.184358 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:48:23.184358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E2A36A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E59E3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235E58E3C40>]}
[0m06:48:23.185359 [debug] [MainThread]: Flushing usage events
[0m06:49:17.281053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013014AB6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001301704F1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017027D00>]}


============================== 06:49:17.286053 | 24eec36d-9f1b-4d5b-b341-e153381d35f1 ==============================
[0m06:49:17.286053 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:49:17.286053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --quiet run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'send_anonymous_usage_stats': 'True'}
[0m06:49:17.582985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24eec36d-9f1b-4d5b-b341-e153381d35f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130170812E0>]}
[0m06:49:17.730985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24eec36d-9f1b-4d5b-b341-e153381d35f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130174A1190>]}
[0m06:49:17.732989 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:49:17.752983 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:49:17.868600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:49:17.869602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:49:17.875600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24eec36d-9f1b-4d5b-b341-e153381d35f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017A31D30>]}
[0m06:49:17.890592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24eec36d-9f1b-4d5b-b341-e153381d35f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017964970>]}
[0m06:49:17.891584 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:49:17.891584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24eec36d-9f1b-4d5b-b341-e153381d35f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017964BB0>]}
[0m06:49:17.892590 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:49:17.893589 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:17.893589 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:49:17.894589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:17.917601 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:49:17.918582 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:49:17.919583 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:17.919583 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:49:17.921590 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:49:17.941581 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:17.942584 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:49:17.944591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:49:17.945582 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:17.945582 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:49:17.954588 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:49:17.969585 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:49:17.969585 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:49:17.972582 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:49:17.975589 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:49:17.975589 after 0.77 seconds
[0m06:49:17.976592 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:49:17.976592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013014AB6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017A63310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013017964BB0>]}
[0m06:49:17.977592 [debug] [MainThread]: Flushing usage events
[0m06:49:36.877241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2A2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E4FAEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E4FAE5E0>]}


============================== 06:49:36.884243 | 742c145e-7c76-4a71-8697-7813ed0be36c ==============================
[0m06:49:36.884243 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:49:36.884243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --quiet run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:49:37.217477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '742c145e-7c76-4a71-8697-7813ed0be36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E5000FA0>]}
[0m06:49:37.373477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '742c145e-7c76-4a71-8697-7813ed0be36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E559C9A0>]}
[0m06:49:37.374477 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:49:37.396177 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:49:37.545197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:49:37.546205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:49:37.552198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '742c145e-7c76-4a71-8697-7813ed0be36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E59B1DC0>]}
[0m06:49:37.567201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '742c145e-7c76-4a71-8697-7813ed0be36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E58E7A00>]}
[0m06:49:37.568192 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:49:37.568192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '742c145e-7c76-4a71-8697-7813ed0be36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E58E7C40>]}
[0m06:49:37.570197 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:49:37.571198 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:37.571198 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:49:37.572197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:37.603179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:49:37.604177 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:49:37.604177 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:37.605177 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:49:37.606181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:49:37.627198 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:37.628201 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:49:37.630197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:49:37.631187 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:49:37.631187 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:49:37.639205 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:49:37.654199 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:49:37.655198 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:49:37.657190 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:49:37.661182 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:49:37.660184 after 0.87 seconds
[0m06:49:37.662187 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:49:37.662187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2A2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E59EDC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E58D3FA0>]}
[0m06:49:37.663186 [debug] [MainThread]: Flushing usage events
[0m06:50:02.189726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166FF1ADAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166818EEE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166818EEC70>]}


============================== 06:50:02.205379 | 147bd4c2-e46b-457d-8311-e5c2f88ba47a ==============================
[0m06:50:02.205379 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:50:02.205379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:50:02.568506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '147bd4c2-e46b-457d-8311-e5c2f88ba47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681940F70>]}
[0m06:50:02.715714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '147bd4c2-e46b-457d-8311-e5c2f88ba47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016681F1D970>]}
[0m06:50:02.715714 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:50:02.737914 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:50:02.905007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:02.905007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:02.905007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '147bd4c2-e46b-457d-8311-e5c2f88ba47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016682331D90>]}
[0m06:50:02.922666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '147bd4c2-e46b-457d-8311-e5c2f88ba47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016682263A30>]}
[0m06:50:02.922666 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:50:02.922666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147bd4c2-e46b-457d-8311-e5c2f88ba47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016682263C70>]}
[0m06:50:02.938316 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:50:02.938316 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:50:02.938316 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:50:02.938316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:50:02.973586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:50:02.973586 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:50:02.973586 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:50:02.973586 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:50:02.973586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:50:02.990984 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:50:02.990984 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:50:02.990984 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:50:02.990984 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:50:02.990984 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:50:03.010822 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:50:03.025824 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:50:03.029820 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:50:03.031830 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:50:03.040826 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:50:03.040826 after 0.92 seconds
[0m06:50:03.041830 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:50:03.042883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166FF1ADAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016682363370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016682263C70>]}
[0m06:50:03.042883 [debug] [MainThread]: Flushing usage events
[0m06:51:23.842633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B68F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B8E75D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B8E75DF0>]}


============================== 06:51:23.846631 | c72a632e-e61b-4e78-93ba-5c25fe205d22 ==============================
[0m06:51:23.846631 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:51:23.846631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:51:24.145652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c72a632e-e61b-4e78-93ba-5c25fe205d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B8E26F10>]}
[0m06:51:24.295581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c72a632e-e61b-4e78-93ba-5c25fe205d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B8FEFA00>]}
[0m06:51:24.296585 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:51:24.317581 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:51:24.438132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:24.439138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:24.445133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c72a632e-e61b-4e78-93ba-5c25fe205d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B9871D00>]}
[0m06:51:24.458118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c72a632e-e61b-4e78-93ba-5c25fe205d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B97A39A0>]}
[0m06:51:24.459124 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:51:24.460122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c72a632e-e61b-4e78-93ba-5c25fe205d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B97A3BE0>]}
[0m06:51:24.461126 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:51:24.461126 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:51:24.462134 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:51:24.462134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:51:24.484113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:51:24.485122 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:51:24.485122 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:51:24.486122 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:51:24.488132 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:51:24.508135 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:51:24.508135 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:51:24.511121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:51:24.511121 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:51:24.512123 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:51:24.520140 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:51:24.535131 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:51:24.535131 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:51:24.538112 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:51:24.542121 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:51:24.542121 after 0.78 seconds
[0m06:51:24.543120 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:51:24.543120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B68F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B98A42E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177B97A3BE0>]}
[0m06:51:24.544120 [debug] [MainThread]: Flushing usage events
[0m06:53:34.861564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283AE4B6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B0C031F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B0BEED00>]}


============================== 06:53:34.861564 | 34f62e91-9ea2-4991-a81a-3daaf377f8dc ==============================
[0m06:53:34.861564 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:53:34.861564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:53:35.182085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f62e91-9ea2-4991-a81a-3daaf377f8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B0BA6F10>]}
[0m06:53:35.329295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f62e91-9ea2-4991-a81a-3daaf377f8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B0E67190>]}
[0m06:53:35.329295 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:53:35.363277 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:53:35.519160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:35.519160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:35.519160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f62e91-9ea2-4991-a81a-3daaf377f8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B13F1D30>]}
[0m06:53:35.534784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f62e91-9ea2-4991-a81a-3daaf377f8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B1323970>]}
[0m06:53:35.534784 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:53:35.534784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f62e91-9ea2-4991-a81a-3daaf377f8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B1323BB0>]}
[0m06:53:35.534784 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:53:35.534784 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:53:35.534784 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:53:35.534784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:53:35.578066 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:53:35.578066 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:53:35.578066 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:53:35.578066 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:53:35.578066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:53:35.594320 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:53:35.594320 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:53:35.594320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:53:35.594320 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:53:35.608785 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:53:35.615798 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:53:35.631812 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:53:35.631812 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:53:35.634785 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:53:35.638795 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:53:35.638795 after 0.85 seconds
[0m06:53:35.639783 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:53:35.639783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283AE4B6A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B1424310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B1323BB0>]}
[0m06:53:35.640793 [debug] [MainThread]: Flushing usage events
[0m06:54:03.108586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8532B6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8557E7DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8557E7C40>]}


============================== 06:54:03.108586 | c2981a40-cb5d-473e-8cd1-c604ab14f3c8 ==============================
[0m06:54:03.108586 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:54:03.108586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\raikh\\VscodeProjects\\dbt_app\\users_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\raikh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["users_model"]}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:54:03.409456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2981a40-cb5d-473e-8cd1-c604ab14f3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8557A6F10>]}
[0m06:54:03.558575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2981a40-cb5d-473e-8cd1-c604ab14f3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85601DCD0>]}
[0m06:54:03.558575 [info ] [MainThread]: Registered adapter: postgres=1.7.2
[0m06:54:03.579051 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:54:03.705865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:03.705865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:03.707443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2981a40-cb5d-473e-8cd1-c604ab14f3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E856231D60>]}
[0m06:54:03.723075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2981a40-cb5d-473e-8cd1-c604ab14f3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E856164A00>]}
[0m06:54:03.723075 [info ] [MainThread]: Found 4 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 531 macros, 0 groups, 0 semantic models
[0m06:54:03.723075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2981a40-cb5d-473e-8cd1-c604ab14f3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E856164C40>]}
[0m06:54:03.723075 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_model_yaml'
[0m06:54:03.723075 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:54:03.723075 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:54:03.723075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:54:03.754808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:54:03.755807 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:54:03.755807 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:54:03.756806 [debug] [MainThread]: On macro_generate_model_yaml: COMMIT
[0m06:54:03.757855 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:54:03.775559 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:54:03.775559 [debug] [MainThread]: On macro_generate_model_yaml: BEGIN
[0m06:54:03.775559 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:54:03.775559 [debug] [MainThread]: Using postgres connection "macro_generate_model_yaml"
[0m06:54:03.775559 [debug] [MainThread]: On macro_generate_model_yaml: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "users_project", "target_name": "dev", "connection_name": "macro_generate_model_yaml"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "userdb".INFORMATION_SCHEMA.columns
      where table_name = 'users_model'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m06:54:03.792100 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m06:54:03.807606 [info ] [MainThread]: version: 2

models:
  - name: users_model
    description: ""
    columns:
      - name: user_id
        data_type: text
        description: ""

      - name: username
        data_type: text
        description: ""

      - name: userphone
        data_type: text
        description: ""

[0m06:54:03.808611 [debug] [MainThread]: On macro_generate_model_yaml: ROLLBACK
[0m06:54:03.810601 [debug] [MainThread]: On macro_generate_model_yaml: Close
[0m06:54:03.814602 [debug] [MainThread]: Command `dbt run-operation` succeeded at 06:54:03.814602 after 0.78 seconds
[0m06:54:03.815598 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m06:54:03.815598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8532B6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E856264340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E856164C40>]}
[0m06:54:03.816597 [debug] [MainThread]: Flushing usage events
